<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.30.2" />
  <meta name="author" content="Guangchuang YU">
  <meta name="description" content="Postdoc researcher">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://guangchuangyu.github.io/index.xml" type="application/rss+xml" title="Guangchuang YU">
  <link rel="feed" href="https://guangchuangyu.github.io/index.xml" type="application/rss+xml" title="Guangchuang YU">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://guangchuangyu.github.io/2014/04/chipseeker-for-chip-peak-annotation/">

  

  <title>ChIPseeker for ChIP peak annotation | Guangchuang YU</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Guangchuang YU</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/resume">
            
            <span>Resume</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/cn">
            
            <span>中文入口</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  

  <div class="article-container">
    <h1 itemprop="name">ChIPseeker for ChIP peak annotation</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2014-04-13 13:02:15 &#43;0800 CST" itemprop="datePublished">
      Sun, Apr 13, 2014
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r">R</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/chipseeker">ChIPseeker</a
    >, 
    
    <a href="/tags/chipseq">ChIPseq</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fguangchuangyu.github.io%2f2014%2f04%2fchipseeker-for-chip-peak-annotation%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=ChIPseeker%20for%20ChIP%20peak%20annotation&amp;url=https%3a%2f%2fguangchuangyu.github.io%2f2014%2f04%2fchipseeker-for-chip-peak-annotation%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fguangchuangyu.github.io%2f2014%2f04%2fchipseeker-for-chip-peak-annotation%2f&amp;title=ChIPseeker%20for%20ChIP%20peak%20annotation"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fguangchuangyu.github.io%2f2014%2f04%2fchipseeker-for-chip-peak-annotation%2f&amp;title=ChIPseeker%20for%20ChIP%20peak%20annotation"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=ChIPseeker%20for%20ChIP%20peak%20annotation&amp;body=https%3a%2f%2fguangchuangyu.github.io%2f2014%2f04%2fchipseeker-for-chip-peak-annotation%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p><a href="http://www.bioconductor.org/packages/2.14/bioc/html/ChIPpeakAnno.html" target="_blank">ChIPpeakAnno</a>
WAS the only R package for ChIP peak annotation. I used it for
annotating peak in my recent study.</p>

<p>I found it does not consider the strand information of genes. I
<a href="http://guangchuangyu.github.io/2014/01/bug-of-r-package-chippeakanno/" target="_blank">reported the bug</a> to the
authors, but they are reluctant to change.</p>

<p>So I decided to develop my own package,
<a href="http://www.bioconductor.org/packages/2.14/bioc/html/ChIPseeker.html" target="_blank">ChIPseeker</a>,
and it&rsquo;s now available in Bioconductor.</p>

<p></p>

<pre><code>&gt; require(TxDb.Hsapiens.UCSC.hg19.knownGene)
&gt; txdb &lt;- TxDb.Hsapiens.UCSC.hg19.knownGene
&gt; require(ChIPseeker)
&gt; peakfile = getSampleFiles()[[4]]
&gt; peakfile
[1] &quot;/usr/local/Cellar/r/3.1.0/R.framework/Versions/3.1/Resources/library/ChIPseeker/extdata//GEO_sample_data/GSM1295076_CBX6_BF_ChipSeq_mergedReps_peaks.bed.gz&quot;
&gt; peakAnno &lt;- annotatePeak(peakfile, tssRegion=c(-3000, 1000), TxDb=txdb, annoDb=&quot;org.Hs.eg.db&quot;)
&gt;&gt; loading peak file...              2014-04-13 12:03:45 PM 
&gt;&gt; preparing features information...         2014-04-13 12:03:45 PM 
&gt;&gt; identifying nearest features...       2014-04-13 12:03:45 PM 
&gt;&gt; calculating distance from peak to TSS...  2014-04-13 12:03:46 PM 
&gt;&gt; assigning genomic annotation...       2014-04-13 12:03:46 PM 
&gt;&gt; adding gene annotation...             2014-04-13 12:03:50 PM 
&gt;&gt; assigning chromosome lengths          2014-04-13 12:03:50 PM 
&gt;&gt; done...                   2014-04-13 12:03:50 PM 
&gt; head(as.GRanges(peakAnno))
GRanges object with 6 ranges and 14 metadata columns:
      seqnames             ranges strand |          V4        V5
                      |     
  [1]     chr1 [ 815092,  817883]      * | MACS_peak_1    295.76
  [2]     chr1 [1243287, 1244338]      * | MACS_peak_2     63.19
  [3]     chr1 [2979976, 2981228]      * | MACS_peak_3    100.16
  [4]     chr1 [3566181, 3567876]      * | MACS_peak_4    558.89
  [5]     chr1 [3816545, 3818111]      * | MACS_peak_5     57.57
  [6]     chr1 [6304864, 6305704]      * | MACS_peak_6     54.57
             annotation  geneChr geneStart   geneEnd geneLength geneStrand
                    
  [1] Distal Intergenic     chr1    803451    812182       8732          -
  [2]  Promoter (&lt;=1kb)     chr1   1243994   1247057       3064          +
  [3]  Promoter (&lt;=1kb)     chr1   2976181   2980350       4170          -
  [4]  Promoter (&lt;=1kb)     chr1   3547331   3566671      19341          -
  [5]  Promoter (&lt;=1kb)     chr1   3816968   3832011      15044          +
  [6]            3  UTR     chr1   6304252   6305638       1387          +
           geneId transcriptId distanceToTSS         ENSEMBL      SYMBOL
                   
  [1]      284593   uc001abt.4         -5701 ENSG00000230368      FAM41C
  [2]      126789   uc001aed.3             0 ENSG00000169972       PUSL1
  [3]      440556   uc001aka.3             0 ENSG00000177133   LINC00982
  [4]       49856   uc001ako.3             0 ENSG00000116213      WRAP73
  [5]   100133612   uc001alg.3             0 ENSG00000236423   LINC01134
  [6]      390992   uc009vly.2          1452 ENSG00000173673        HES3
                                          GENENAME
                                       
  [1] family with sequence similarity 41, member C
  [2]              pseudouridylate synthase-like 1
  [3]   long intergenic non-protein coding RNA 982
  [4]      WD repeat containing, antisense to TP73
  [5]  long intergenic non-protein coding RNA 1134
  [6]       hes family bHLH transcription factor 3
  ---
  seqlengths:
        chr1     chr10     chr11     chr12 ...      chr8      chr9      chrX
   249250621 135534747 135006516 133851895 ... 146364022 141213431 155270560
</code></pre>

<p><em>annotatePeak</em> function can accept peak file or GRanges object that
contained peak information. The sample peakfile shown above is a sample
output from MACS. All the information contained in peakfile will be kept
in the output of annotatePeak.</p>

<p>The <em>annotation</em> column annotates genomic features of the peak, that is
whether peak is located in Promoter, Exon, UTR, Intron or Intergenic. If
the peak is annotated by Exon or Intron, more detail information will be
provided. For instance, Exon (38885 exon 3 of 11) indicates that the
peak is located at the 3th exon of gene 38885 (entrezgene ID) which
contain 11 exons in total.</p>

<p>All the names of column that contains information of nearest gene
annotated will start with gene in camelCaps style.</p>

<p>If parameter annoDb=&ldquo;org.Hs.eg.db&rdquo; is provided, extra columns of
ENSEMBL, SYMBOL and GENENAME will be provided in the final output.</p>

<p>For more detail, please refer to the package
<a href="http://www.bioconductor.org/packages/release/bioc/vignettes/ChIPseeker/inst/doc/ChIPseeker.pdf" target="_blank">vignette</a>.
Comments or suggestions are welcome.</p>

<p>&mdash;&mdash;- below was added at April 30, 2014 &mdash;&mdash;&mdash;&ndash;</p>

<p>After two weeks of ChIPseeker release in Bioconductor, I am very glad to
receive an email from <a href="http://www.flychip.org.uk/" target="_blank">Cambridge Systems Biology Centre</a> that they are using ChIPseeker in
annotating Drosophila ChIP data.</p>

<p>Although I only illustrate examples in human, ChIPseeker do supports all
species only if genomic information was available. :mrgreen: :mrgreen:</p>

<pre><code>&gt; require(TxDb.Dmelanogaster.UCSC.dm3.ensGene)
&gt; require(ChIPseeker)
&gt; txdb &lt;- TxDb.Dmelanogaster.UCSC.dm3.ensGene
&gt;
&gt; chr &lt;- c(&quot;chrX&quot;, &quot;chrX&quot;, &quot;chrX&quot;)
&gt; start &lt;- c(71349, 77124, 86364)
&gt; end &lt;- c(72835, 77836, 88378)
&gt; peak &lt;- GRanges(seqnames = chr, ranges = IRanges(start, end))
&gt; peakAnno &lt;- annotatePeak(peak,
+                          tssRegion=c(-3000,100),
+                          TxDb = txdb,
+                          annoDb=&quot;org.Dm.eg.db&quot;)
&gt;&gt; preparing features information...         2014-04-30 21:28:27
&gt;&gt; identifying nearest features...       2014-04-30 21:28:30
&gt;&gt; calculating distance from peak to TSS...  2014-04-30 21:28:31
&gt;&gt; assigning genomic annotation...       2014-04-30 21:28:31
&gt;&gt; adding gene annotation...             2014-04-30 21:28:42
Loading required package: org.Dm.eg.db
Loading required package: DBI

&gt;&gt; assigning chromosome lengths           2014-04-30 21:28:43
&gt;&gt; done...                   2014-04-30 21:28:43
&gt; as.GRanges(peakAnno)
GRanges object with 3 ranges and 12 metadata columns:
      seqnames         ranges strand |
                  |
  [1]     chrX [71349, 72835]      * |
  [2]     chrX [77124, 77836]      * |
  [3]     chrX [86364, 88378]      * |
                                           annotation  geneChr geneStart
                                            
  [1]                                Promoter (&lt;=1kb)     chrX     72458
  [2] Intron (FBtr0100135/FBgn0029128, intron 1 of 7)     chrX     72458
  [3] Intron (FBtr0100135/FBgn0029128, intron 2 of 7)     chrX     72458
        geneEnd geneLength geneStrand      geneId transcriptId distanceToTSS
                   
  [1]     96056      23599          + FBgn0029128  FBtr0100135             0
  [2]     96056      23599          + FBgn0029128  FBtr0100135          5378
  [3]     96056      23599          + FBgn0029128  FBtr0100135         15920
         ENTREZID      SYMBOL    GENENAME
        
  [1]     3354987         tyn     trynity
  [2]     3354987         tyn     trynity
  [3]     3354987         tyn     trynity
  ---
  seqlengths:
       chrX
   22422827
&gt;
</code></pre>

<h2 id="citation">Citation</h2>

<p><strong><em>Yu G</em></strong>, Wang LG and He QY<sup>*</sup>. <a href="http://bioinformatics.oxfordjournals.org/content/31/14/2382" target="_blank">ChIPseeker: an R/Bioconductor package for ChIP peak annotation, comparison and visualization</a>. <strong><em>Bioinformatics</em></strong> 2015, 31(14):2382-2383.</p>

<p><script type="text/javascript" src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script><div class="altmetric-embed" data-badge-type="donut" data-badge-popover="right" data-altmetric-id="3781087"></div></p>
    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://guangchuangyu.github.io/2014/01/bug-of-r-package-chippeakanno/"><span
      aria-hidden="true">&larr;</span> Bug of R package ChIPpeakAnno</a></li>
    

    
    <li class="next"><a href="https://guangchuangyu.github.io/2014/04/visualization-methods-in-chipseeker/">visualization methods in ChIPseeker <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "gcyu" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div style="width:350px;margin:auto;">
<script type="text/javascript" src="//rf.revolvermaps.com/0/0/7.js?i=5qpvv5zz7fp&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;sx=0" async="async"></script>
</div>
  <div class="container">
    <p class="powered-by">

      &copy; 2016 Guangchuang YU &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-77901140-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

