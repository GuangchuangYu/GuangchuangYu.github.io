<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Guangchuang YU</title>
    <link>https://guangchuangyu.github.io/</link>
    <description>Recent content on Guangchuang YU</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016 Guangchuang YU</copyright>
    <lastBuildDate>Thu, 01 Sep 2016 03:17:48 +0800</lastBuildDate>
    <atom:link href="https://guangchuangyu.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>ggtree for microbiome data</title>
      <link>https://guangchuangyu.github.io/2016/09/ggtree-for-microbiome-data</link>
      <pubDate>Thu, 01 Sep 2016 03:17:48 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/09/ggtree-for-microbiome-data</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12628/abstract&#34;&gt;ggtree&lt;/a&gt; can parse many software outputs and the evolution evidences inferred by these software can be used directly for tree annotation. &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12628/abstract&#34;&gt;ggtree&lt;/a&gt; not only works as an infrastructure that enables evolutionary data that inferred by commonly used software packages to be used in R, but also serves as a general tree visualization and annotation tool for the R community as it supports many S3/S4 objects defined by other R packages.&lt;/p&gt;

&lt;h2 id=&#34;phyloseq-for-microbiome-data:0985290eee60ca4c9cf6b9ed3f5a6bdf&#34;&gt;phyloseq for microbiome data&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;phyloseq&lt;/code&gt; class defined in the &lt;a href=&#34;https://www.bioconductor.org/package/phyloseq&#34;&gt;phyloseq&lt;/a&gt; package was designed for microbiome data. &lt;code&gt;phyloseq&lt;/code&gt; package implemented &lt;code&gt;plot_tree&lt;/code&gt; function using &lt;code&gt;ggplot2&lt;/code&gt;. Although the function was implemented by &lt;code&gt;ggplot2&lt;/code&gt; and we can use &lt;code&gt;theme&lt;/code&gt;, &lt;code&gt;scale_color_manual&lt;/code&gt; etc for customization, the most valuable part of &lt;code&gt;ggplot2&lt;/code&gt;, adding layer, is missing. &lt;code&gt;plot_tree&lt;/code&gt; only provides limited parameters to control the output graph and it is hard to adding layer unless user has expertise in both &lt;code&gt;phyloseq&lt;/code&gt; and &lt;code&gt;ggplot2&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(phyloseq)

data(GlobalPatterns)
GP &amp;lt;- prune_taxa(taxa_sums(GlobalPatterns) &amp;gt; 0, GlobalPatterns)
GP.chl &amp;lt;- subset_taxa(GP, Phylum==&amp;quot;Chlamydiae&amp;quot;)

plot_tree(GP.chl, color=&amp;quot;SampleType&amp;quot;, shape=&amp;quot;Family&amp;quot;, label.tips=&amp;quot;Genus&amp;quot;, size=&amp;quot;Abundance&amp;quot;) + ggtitle(&amp;quot;tree annotation using phyloseq&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/tree_phyloseq.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;PS: If we look at the plot careful, we will find that legend produce by &lt;code&gt;plot_tree&lt;/code&gt; is not correct (&lt;code&gt;plot_tree&lt;/code&gt; map &lt;code&gt;SampleType&lt;/code&gt; to color text which was shown in legend, but we can&amp;rsquo;t find the mapping in the plot).&lt;/p&gt;

&lt;h2 id=&#34;ggtree-supports-phyloseq-object:0985290eee60ca4c9cf6b9ed3f5a6bdf&#34;&gt;ggtree supports phyloseq object&lt;/h2&gt;

&lt;p&gt;One of the advantage of R is the community. R users develop packages that can work together and complete each other. &lt;a href=&#34;http://onlinelibrary.wiley.com/doi/10.1111/2041-210X.12628/abstract&#34;&gt;ggtree&lt;/a&gt; fits the R ecosystem in phylogenetic analysis. It supports several classes defined in other R packages that designed for storing phylogenetic tree with associated data, including &lt;code&gt;phyloseq&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(scales)
library(ggtree)
p &amp;lt;- ggtree(GP.chl, ladderize = FALSE) + geom_text2(aes(subset=!isTip, label=label), hjust=-.2, size=4) +
    geom_tiplab(aes(label=Genus), hjust=-.3) +
    geom_point(aes(x=x+hjust, color=SampleType, shape=Family, size=Abundance),na.rm=TRUE) +
    scale_size_continuous(trans=log_trans(5)) +
    theme(legend.position=&amp;quot;right&amp;quot;) + ggtitle(&amp;quot;reproduce phyloseq by ggtree&amp;quot;)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/tree_ggtree.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;With &lt;a href=&#34;https://guangchuangyu.github.io/ggtree&#34;&gt;ggtree&lt;/a&gt;, it would be more flexible to combine different layers using grammar of graphics syntax and more powerful since layers can be added without limitation (i.e. those predefined in &lt;code&gt;plot_tree&lt;/code&gt; function). As an example, I extract the barcode sequence from the tree object and use &lt;code&gt;msaplot&lt;/code&gt; to visualize the barcode sequence with the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;df &amp;lt;- fortify(GP.chl)
barcode &amp;lt;- as.character(df$Barcode_full_length)
names(barcode) &amp;lt;- df$label
barcode &amp;lt;- barcode[!is.na(barcode)]
msaplot(p, Biostrings::BStringSet(barcode), width=.3, offset=.05)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/tree_ggtree_msaplot.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;citation:0985290eee60ca4c9cf6b9ed3f5a6bdf&#34;&gt;Citation&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;G Yu&lt;/strong&gt;, DK Smith, H Zhu, Y Guan, TTY Lam&lt;sup&gt;*&lt;/sup&gt;. ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution. &lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12628&#34;&gt;doi:10.&lt;sup&gt;1111&lt;/sup&gt;&amp;frasl;&lt;sub&gt;2041&lt;/sub&gt;-210X.12628&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;script type=&#34;text/javascript&#34; src=&#34;https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js&#34;&gt;&lt;/script&gt;
&lt;div data-badge-popover=&#34;right&#34; data-badge-type=&#34;donut&#34; data-doi=&#34;10.1111/2041-210X.12628&#34; class=&#34;altmetric-embed&#34;&gt;&lt;/div&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree paper published</title>
      <link>https://guangchuangyu.github.io/2016/08/ggtree-paper-published</link>
      <pubDate>Tue, 16 Aug 2016 22:10:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/08/ggtree-paper-published</guid>
      <description>&lt;p&gt;Today &lt;a href=&#34;https://guangchuangyu.github.io/ggtree&#34;&gt;&lt;code&gt;ggtree&lt;/code&gt;&lt;/a&gt; received &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/stargazers&#34;&gt;100 stars&lt;/a&gt; on &lt;i class=&#34;fa fa-github&#34;&gt;&lt;/i&gt; and I found the paper was &lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12628&#34;&gt;online&lt;/a&gt; at the same day by the tweet:&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;ggtree, Methods in Ecology and Evolutionに掲載されたのか。オープンアクセスっぽいな。&lt;a href=&#34;https://t.co/JlET18BSZv&#34;&gt;https://t.co/JlET18BSZv&lt;/a&gt;&lt;/p&gt;&amp;mdash; ホクソピペット (@siero5335) &lt;a href=&#34;https://twitter.com/siero5335/status/765521239146233856&#34;&gt;August 16, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;I am quite exciting about it. Now ggtree is citable by doi:&lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12628&#34;&gt;&lt;code&gt;10.1111/2041-210X.12628&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;In the review period, &lt;code&gt;ggtree&lt;/code&gt; had already been cited by several papers:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;1&lt;/code&gt;. &lt;a href=&#34;https://doi.org/10.7717/peerj.976&#34;&gt;https://doi.org/10.7717/peerj.976&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Annotating phylogenetic tree with image files (i.e. secondary structure).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/ggtree/featured_img/2015_peerJ_fig-9-2x.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;2&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1016/j.meegid.2015.12.006&#34;&gt;http://dx.doi.org/10.1016/j.meegid.2015.12.006&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Highlight clades and annotate phylogenetic tree with genotype table.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/ggtree/featured_img/2015_peiyu_1-s2.0-S1567134815300721-gr1.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;3&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.3389%2Ffcimb.2016.00036&#34;&gt;http://dx.doi.org/10.3389%2Ffcimb.2016.00036&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Annotate phylogenetic tree with binary matrix.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/ggtree/featured_img/2016_fcimb-06-00036-g003.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;4&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1104/pp.16.00359&#34;&gt;http://dx.doi.org/10.1104/pp.16.00359&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Annotate phylogenetic tree with sequence features.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/ggtree/featured_img/2016_PlantPhysiology.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;5&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1101/067207&#34;&gt;http://dx.doi.org/10.1101/067207&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Annotate with bootstrap values.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://cloud.githubusercontent.com/assets/626539/17700401/273895c6-63f8-11e6-91da-7431b78b22af.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;6&lt;/code&gt;. &lt;a href=&#34;http://www.nature.com/articles/srep30158&#34;&gt;http://www.nature.com/articles/srep30158&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Visualize bootstrap value infer by RAxML and phyml on the same tree.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://cloud.githubusercontent.com/assets/626539/17127143/de15b7c0-5335-11e6-8621-edce0e581308.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;7&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1101/053371&#34;&gt;http://dx.doi.org/10.1101/053371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;8&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1105/tpc.16.00053&#34;&gt;http://dx.doi.org/10.1105/tpc.16.00053&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;9&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1111/mec.13474&#34;&gt;http://dx.doi.org/10.1111/mec.13474&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;10&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1371/journal.pone.0160958&#34;&gt;http://dx.doi.org/10.1371/journal.pone.0160958&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;11&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12593&#34;&gt;http://dx.doi.org/10.1111/2041-210X.12593&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;12&lt;/code&gt;. &lt;a href=&#34;http://dx.doi.org/10.1101/053371&#34;&gt;http://dx.doi.org/10.1101/053371&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The &lt;a href=&#34;http://dx.doi.org/10.1111/2041-210X.12628&#34;&gt;ggtree paper&lt;/a&gt; provides several comprehensive and reproducible examples. It can be a good reference for complex tree annotation. &lt;a href=&#34;https://guangchuangyu.github.io/presentation/2016-ggtree-chinar/&#34;&gt;My slides&lt;/a&gt; in 9&lt;sup&gt;th&lt;/sup&gt; China R conference summarized the functionalities that &lt;code&gt;ggtree&lt;/code&gt; provided.&lt;/p&gt;

&lt;p&gt;More information can be found in &lt;a href=&#34;https://guangchuangyu.github.io/ggtree&#34;&gt;ggtree homepage&lt;/a&gt;. Hope you have fun with &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data</title>
      <link>https://guangchuangyu.github.io/publication/2016_ggtree/</link>
      <pubDate>Tue, 16 Aug 2016 00:00:00 +0000</pubDate>
      
      <guid>https://guangchuangyu.github.io/publication/2016_ggtree/</guid>
      <description></description>
    </item>
    
    <item>
      <title>using meshes for MeSH Enrichment Analysis</title>
      <link>https://guangchuangyu.github.io/2016/08/using-meshes-for-mesh-enrichment-analysis</link>
      <pubDate>Wed, 03 Aug 2016 00:19:15 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/08/using-meshes-for-mesh-enrichment-analysis</guid>
      <description>&lt;p&gt;MeSH (Medical Subject Headings) is the NLM (U.S. National Library of
Medicine) controlled vocabulary used to manually index articles for
MEDLINE/PubMed. MeSH is comprehensive life science vocabulary. MeSH has
19 categories and &lt;code&gt;MeSH.db&lt;/code&gt; contains 16 of them. That is:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Abbreviation&lt;/th&gt;
&lt;th&gt;Category&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;Anatomy&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;B&lt;/td&gt;
&lt;td&gt;Organisms&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;C&lt;/td&gt;
&lt;td&gt;Diseases&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;D&lt;/td&gt;
&lt;td&gt;Chemicals and Drugs&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;E&lt;/td&gt;
&lt;td&gt;Analytical, Diagnostic and Therapeutic Techniques and Equipment&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;F&lt;/td&gt;
&lt;td&gt;Psychiatry and Psychology&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;G&lt;/td&gt;
&lt;td&gt;Phenomena and Processes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;H&lt;/td&gt;
&lt;td&gt;Disciplines and Occupations&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;I&lt;/td&gt;
&lt;td&gt;Anthropology, Education, Sociology and Social Phenomena&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;J&lt;/td&gt;
&lt;td&gt;Technology and Food and Beverages&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;K&lt;/td&gt;
&lt;td&gt;Humanities&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;L&lt;/td&gt;
&lt;td&gt;Information Science&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;M&lt;/td&gt;
&lt;td&gt;Persons&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;N&lt;/td&gt;
&lt;td&gt;Health Care&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;V&lt;/td&gt;
&lt;td&gt;Publication Type&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Z&lt;/td&gt;
&lt;td&gt;Geographical Locations&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;MeSH terms were associated with Entrez Gene ID by three methods,
&lt;code&gt;gendoo&lt;/code&gt;, &lt;code&gt;gene2pubmed&lt;/code&gt; and &lt;code&gt;RBBH&lt;/code&gt; (Reciprocal Blast Best Hit).&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Method&lt;/th&gt;
&lt;th&gt;Way of corresponding Entrez Gene IDs and MeSH IDs&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Gendoo&lt;/td&gt;
&lt;td&gt;Text-mining&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;gene2pubmed&lt;/td&gt;
&lt;td&gt;Manual curation by NCBI teams&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;RBBH&lt;/td&gt;
&lt;td&gt;sequence homology with BLASTP search (E-value&lt;10&lt;sup&gt;-50&lt;/sup&gt;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/GuangchuangYu/meshes&#34;&gt;meshes&lt;/a&gt;
supports enrichment analysis (over-representation analysis and gene set
enrichment analysis) of gene list or whole expression profile using MeSH
annotation. Data source from &lt;code&gt;gendoo&lt;/code&gt;, &lt;code&gt;gene2pubmed&lt;/code&gt; and &lt;code&gt;RBBH&lt;/code&gt; are all
supported. User can selecte interesting category to test. All 16
categories are supported. The analysis supports &amp;gt;70 species listed in &lt;a href=&#34;https://bioconductor.org/packages/release/BiocViews.html#___MeSHDb&#34;&gt;MeSHDb BiocView&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(meshes)

data(geneList)
de = names(geneList)[1:100]
x &amp;lt;- enrichMeSH(de, MeSHDb = &amp;quot;MeSH.Hsa.eg.db&amp;quot;, database=&#39;gendoo&#39;, category = &#39;C&#39;)
head(x)

##              ID              Description GeneRatio   BgRatio       pvalue
## D043171 D043171  Chromosomal Instability     16/96 198/16528 2.794765e-14
## D000782 D000782               Aneuploidy     17/96 320/16528 3.866830e-12
## D042822 D042822      Genomic Instability     16/96 312/16528 3.007419e-11
## D012595 D012595    Scleroderma, Systemic     11/96 279/16528 6.449334e-07
## D009303 D009303 Nasopharyngeal Neoplasms     11/96 314/16528 2.049315e-06
## D019698 D019698     Hepatitis C, Chronic     11/96 317/16528 2.246856e-06
##             p.adjust       qvalue
## D043171 2.434241e-11 1.794534e-11
## D000782 1.684004e-09 1.241456e-09
## D042822 8.731539e-09 6.436931e-09
## D012595 1.404343e-04 1.035288e-04
## D009303 3.261686e-04 2.404530e-04
## D019698 3.261686e-04 2.404530e-04
##                                                                                      geneID
## D043171    4312/991/2305/1062/4605/10403/7153/55355/4751/4085/81620/332/7272/9212/1111/6790
## D000782 4312/55143/991/1062/7153/4751/79019/55839/890/983/4085/332/7272/9212/8208/1111/6790
## D042822     55143/991/1062/4605/7153/1381/9787/4751/10635/890/4085/81620/332/9212/1111/6790
## D012595                              4312/6280/1062/4605/7153/3627/4283/6362/7850/3002/4321
## D009303                                4312/7153/3627/6241/983/4085/5918/332/3002/4321/6790
## D019698                               4312/3627/10563/6373/4283/983/6362/7850/332/3002/3620
##         Count
## D043171    16
## D000782    17
## D042822    16
## D012595    11
## D009303    11
## D019698    11
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In the over-representation analysis, we use data source from &lt;code&gt;gendoo&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt; (Diseases) category.&lt;/p&gt;

&lt;p&gt;In the following example, we use data source from &lt;code&gt;gene2pubmed&lt;/code&gt; and test category &lt;code&gt;G&lt;/code&gt; (Phenomena and Processes) using GSEA.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;y &amp;lt;- gseMeSH(geneList, MeSHDb = &amp;quot;MeSH.Hsa.eg.db&amp;quot;, database = &#39;gene2pubmed&#39;, category = &amp;quot;G&amp;quot;)

## [1] &amp;quot;preparing geneSet collections...&amp;quot;
## [1] &amp;quot;GSEA analysis...&amp;quot;
## [1] &amp;quot;leading edge analysis...&amp;quot;
## [1] &amp;quot;done...&amp;quot;

head(y)

##              ID                  Description setSize enrichmentScore
## D009929 D009929                   Organ Size     449      -0.3458797
## D059647 D059647 Gene-Environment Interaction     455      -0.3551242
## D009043 D009043               Motor Activity     398      -0.3391521
## D050156 D050156                 Adipogenesis     368      -0.3618413
## D004041 D004041                 Dietary Fats     314      -0.3427588
## D006339 D006339                   Heart Rate     312      -0.3695689
##               NES      pvalue   p.adjust    qvalues rank
## D009929 -1.524164 0.001248439 0.03715088 0.02756207 2309
## D059647 -1.564984 0.001251564 0.03715088 0.02756207 2237
## D009043 -1.483672 0.001256281 0.03715088 0.02756207 1757
## D050156 -1.577000 0.001256281 0.03715088 0.02756207 2207
## D004041 -1.473730 0.001269036 0.03715088 0.02756207 1684
## D006339 -1.588315 0.001270648 0.03715088 0.02756207 2405
##                           leading_edge
## D009929 tags=27%, list=18%, signal=22%
## D059647 tags=26%, list=18%, signal=22%
## D009043 tags=21%, list=14%, signal=18%
## D050156 tags=26%, list=18%, signal=22%
## D004041 tags=21%, list=13%, signal=19%
## D006339 tags=29%, list=19%, signal=24%
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          core_enrichment
## D009929                     154/9846/3315/6716/9732/5139/7337/5530/4086/6532/1499/7157/627/2252/22891/2908/8654/4088/22846/4057/860/268/2735/2104/23522/5480/51131/3082/10253/831/604/1028/182/7173/5624/8743/23047/596/9905/1548/2272/22829/948/27303/4314/196/6019/595/5021/7248/4212/2488/54820/5334/6403/2246/4803/866/5919/79789/1907/7048/1831/4060/2247/5468/8076/5793/3485/1733/3952/126/3778/79068/79633/6653/5244/4313/3625/10468/9201/1501/6720/2273/2099/3480/5764/6387/1471/1462/4016/2690/8817/8821/5125/1191/5350/2162/5744/23541/185/367/4982/25802/4128/150/3479/10451/9370/125/4857/1308/2167/652/57502/4137/8614/5241
## D059647 9497/118/8859/6532/23405/7424/2295/7157/8631/627/2774/22891/2908/4088/51151/11132/1387/860/268/7366/2104/4153/29119/3791/1543/3643/22841/1129/5624/3240/3174/3350/5590/55304/55213/1548/2169/196/8204/8863/5021/23284/9162/11005/4256/3426/84159/5334/629/1793/4208/4322/7048/6817/553/56172/3953/22795/2638/210/5243/5468/1393/1012/27136/51314/4023/5172/4319/4214/3952/5577/126/7832/79068/4313/2944/9369/3075/6720/7494/2099/857/57161/9223/4306/79750/4035/4915/10443/5744/5654/100126791/3551/2487/1746/185/2952/6935/4128/4059/4582/27324/9358/64084/7166/6505/9370/3708/3117/80129/125/5105/2018/2167/652/4137/1524/5241
## D009043                                                                                                                                                                                                       23621/3082/1291/2915/1543/7466/3240/3350/55304/181/2169/27306/80169/9627/196/8678/8863/23284/81627/4692/5799/2259/3087/1278/1277/3953/4747/2247/6414/210/4744/5468/89795/4023/8522/3485/3952/79068/8864/4313/2944/2273/2099/3480/8528/4908/56892/3339/57161/4741/4306/6571/79750/4915/5744/2487/58503/347/6863/2952/5327/367/4982/4128/4059/3572/150/7060/9358/7166/3479/9254/5348/4129/9370/3708/1311/5105/4137/1408/5241
## D050156                                                                                                            5595/8609/9563/27332/1499/79738/4837/7157/79960/5729/408/2908/4088/6500/8038/4057/6649/5564/860/8648/10365/10253/54884/4602/7474/6776/79875/596/25956/8644/80781/79923/1490/50486/7840/84162/6041/4692/2246/4208/11075/63924/5919/284119/2308/9411/54795/5950/79365/2247/5468/50507/6469/8553/4023/594/7350/81029/3952/79068/5733/4313/10468/10628/6720/11213/55893/290/6678/63895/4035/633/23414/8639/2162/165/3551/10788/185/3357/367/4982/3667/1634/4128/23024/3479/6424/9370/2167/652/8839/54829/2625/79689/10974
## D004041                                                                                                                                                                                                                                                                                      3554/4925/22841/7466/2181/3350/201134/181/2169/948/55911/324/4018/3426/3087/6785/2308/1581/56172/3953/1384/5950/2166/60481/5468/5166/50507/1012/27136/4023/7056/4214/9365/7350/3952/3778/79068/8864/2944/6720/5159/3991/2203/2819/9223/4035/32/213/165/347/2152/185/3487/5327/3667/54898/150/64084/3479/9370/5105/5174/2018/5346/7021/79689
## D006339                                                                                                                                                                            4985/7139/8929/3784/3375/154/1760/9781/5139/118/2702/6532/6416/2869/270/7157/627/2908/7138/5563/3643/1129/7779/947/2034/4179/64388/1621/4881/8863/5021/844/4212/11030/5797/6403/4803/84059/79789/5176/3953/5243/5468/1012/2868/5793/4023/7056/3952/5577/126/2946/3778/477/5733/4313/2944/9201/3075/9499/2273/2099/1471/857/775/4306/4487/213/5350/5744/23245/2152/2697/2791/185/6863/2952/5327/80206/9607/3572/150/3479/2006/55259/9370/125/652/55351
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Users can use visualization methods implemented in &lt;a href=&#34;https://guangchuangyu.github.io/DOSE&#34;&gt;DOSE&lt;/a&gt; (i.e. &lt;code&gt;barplot&lt;/code&gt;, &lt;code&gt;dotplot&lt;/code&gt;, &lt;code&gt;cnetplot&lt;/code&gt;, &lt;code&gt;enrichMap&lt;/code&gt;, &lt;code&gt;upsetplot&lt;/code&gt;, &lt;code&gt;gseaplot&lt;/code&gt;) to help interpreting enriched results.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gseaplot(y, y[1,1], title=y[1,2])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/mesh_gsea.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>leading edge analysis</title>
      <link>https://guangchuangyu.github.io/2016/07/leading-edge-analysis</link>
      <pubDate>Wed, 20 Jul 2016 18:58:10 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/07/leading-edge-analysis</guid>
      <description>

&lt;h2 id=&#34;leading-edge-and-core-enrichment:644be873eb98ddda41ab685173c26627&#34;&gt;leading edge and core enrichment&lt;/h2&gt;

&lt;p&gt;Leading edge analysis reports &lt;code&gt;Tags&lt;/code&gt; to indicate the percentage of genes contributing to the enrichment score, &lt;code&gt;List&lt;/code&gt; to indicate where in the list the enrichment score is attained and &lt;code&gt;Signal&lt;/code&gt; for enrichment signal strength.&lt;/p&gt;

&lt;p&gt;It would also be very interesting to get the core enriched genes that contribute to the enrichment.&lt;/p&gt;

&lt;p&gt;Now &lt;a href=&#34;https://guangchuangyu.github.io/DOSE&#34;&gt;DOSE&lt;/a&gt;, &lt;a href=&#34;https://guangchuangyu.github.io/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt; and &lt;a href=&#34;https://guangchuangyu.github.io/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt; all support leading edge analysis and report core enriched genes.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(DOSE)
data(geneList)
x &amp;lt;- gseDO(geneList)

## [1] &amp;quot;preparing geneSet collections...&amp;quot;
## [1] &amp;quot;GSEA analysis...&amp;quot;
## [1] &amp;quot;leading edge analysis...&amp;quot;
## [1] &amp;quot;done...&amp;quot;

head(x)

##                        ID                             Description setSize
## DOID:1492       DOID:1492                  eye and adnexa disease     459
## DOID:5614       DOID:5614                             eye disease     450
## DOID:0060037 DOID:0060037 developmental disorder of mental health     315
## DOID:374         DOID:374                       nutrition disease     313
## DOID:5679       DOID:5679                         retinal disease     299
## DOID:654         DOID:654                           overnutrition     298
##              enrichmentScore       NES      pvalue   p.adjust    qvalues
## DOID:1492         -0.3105160 -1.379586 0.001231527 0.03329506 0.02257366
## DOID:5614         -0.3125247 -1.386602 0.001243781 0.03329506 0.02257366
## DOID:0060037      -0.3407349 -1.473028 0.001307190 0.03329506 0.02257366
## DOID:374          -0.3421127 -1.477222 0.001310616 0.03329506 0.02257366
## DOID:5679         -0.3676313 -1.582707 0.001333333 0.03329506 0.02257366
## DOID:654          -0.3490198 -1.500301 0.001340483 0.03329506 0.02257366
##              rank                   leading_edge
## DOID:1492    1793 tags=22%, list=14%, signal=19%
## DOID:5614    1768 tags=22%, list=14%, signal=19%
## DOID:0060037 2313 tags=24%, list=19%, signal=20%
## DOID:374     1464 tags=22%, list=12%, signal=20%
## DOID:5679    1768 tags=24%, list=14%, signal=21%
## DOID:654     1464 tags=21%, list=12%, signal=19%
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         core_enrichment
## DOID:1492    3371/3082/5914/2878/4153/3791/23247/1543/80184/6750/1958/2098/7450/596/9187/2034/482/948/1490/1280/3931/5737/4314/4881/2261/3426/187/629/6403/7042/6785/7507/2934/5176/4060/1277/7078/5950/2057/727/10516/4311/2247/1295/358/10203/2192/582/10218/57125/3485/585/1675/6310/2202/4313/2944/4254/3075/1501/2099/3480/4653/1195/6387/3305/1471/857/4016/1909/4053/6678/1296/7033/4915/55812/1191/5654/10631/2152/2697/7043/2952/6935/2200/3572/7177/7031/3479/2006/10451/9370/771/3117/125/652/4693/5346/1524
## DOID:5614              3082/5914/2878/4153/3791/23247/1543/80184/6750/1958/2098/7450/596/9187/2034/482/948/1490/1280/3931/5737/4314/4881/2261/3426/187/629/6403/7042/6785/7507/2934/5176/4060/1277/7078/5950/2057/727/10516/4311/2247/1295/358/10203/2192/582/10218/57125/3485/585/1675/6310/2202/4313/2944/4254/3075/1501/2099/3480/4653/6387/3305/1471/857/4016/1909/4053/6678/1296/7033/4915/55812/1191/5654/10631/2152/2697/7043/2952/6935/2200/3572/7177/7031/3479/2006/10451/9370/771/3117/125/652/4693/5346/1524
## DOID:0060037                                                                                                         154/1760/9732/7337/5175/6532/4763/54806/9759/6326/1499/7157/221037/627/2908/3399/2571/3082/23503/3791/51265/27347/55650/596/3067/51185/7552/22829/23426/324/5021/4885/7248/8910/8604/3397/4208/3400/26470/553/3953/6812/64221/80208/5172/9037/3952/477/93664/3625/2944/6925/6594/7102/3908/2550/4915/4922/26960/1746/2697/6863/3913/2891/367/4128/150/7166/6505/5348/18/4129/9370/57502/4137/79083
## DOID:374                                                                                                                                                                    2169/1490/7840/4887/4314/595/4018/6403/590/3087/866/66036/5919/5176/3953/164656/5950/2638/2166/5243/5468/5108/10560/4023/3485/7350/3952/1149/585/1513/3489/79068/4671/477/4313/3625/9369/6720/7494/2099/3480/3991/23446/6678/4915/5167/8228/165/2152/185/367/4982/3667/4128/9607/3572/150/563/1489/3479/9370/9122/5105/2167/5346/79689/5241
## DOID:5679                                                                                                                                          2878/3791/23247/80184/6750/7450/596/9187/2034/482/948/1490/1280/5737/4314/4881/3426/187/629/6403/6785/2934/5176/7078/5950/727/10516/4311/2247/1295/358/10203/582/10218/57125/585/1675/6310/2202/4313/2944/4254/3075/2099/3480/4653/6387/1471/857/4016/1909/4053/6678/1296/4915/55812/1191/5654/10631/2697/2952/6935/2200/3479/2006/10451/9370/771/652/4693/5346/1524
## DOID:654                                                                                                                                                                                            2169/1490/7840/4887/4314/595/4018/6403/590/3087/866/66036/5919/5176/3953/5950/2638/2166/5243/5468/4023/3485/7350/3952/1149/585/1513/3489/79068/4671/477/4313/3625/9369/6720/7494/2099/3480/3991/6678/4915/5167/8228/165/2152/185/367/4982/3667/4128/9607/3572/150/563/1489/3479/9370/9122/5105/2167/5346/79689/5241
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;cnetplot-for-core-enriched-genes:644be873eb98ddda41ab685173c26627&#34;&gt;&lt;code&gt;cnetplot&lt;/code&gt; for core enriched genes&lt;/h2&gt;

&lt;p&gt;With core enriched genes reported, &lt;code&gt;cnetplot&lt;/code&gt; function for GSEA result is also implemented.&lt;/p&gt;

&lt;h3 id=&#34;setreadable:644be873eb98ddda41ab685173c26627&#34;&gt;&lt;code&gt;setReadable&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;To make the plot more readable, we can use &lt;code&gt;setReadable&lt;/code&gt; to convert &lt;code&gt;Entrez ID&lt;/code&gt; to &lt;code&gt;Gene Symbol&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;y &amp;lt;- setReadable(x, &#39;org.Hs.eg.db&#39;)

head(y, 2)

##                        ID                             Description setSize
## DOID:1492       DOID:1492                  eye and adnexa disease     459
## DOID:5614       DOID:5614                             eye disease     450
##              enrichmentScore       NES      pvalue   p.adjust    qvalues
## DOID:1492         -0.3105160 -1.379586 0.001231527 0.03329506 0.02257366
## DOID:5614         -0.3125247 -1.386602 0.001243781 0.03329506 0.02257366
##              rank                   leading_edge
## DOID:1492    1793 tags=22%, list=14%, signal=19%
## DOID:5614    1768 tags=22%, list=14%, signal=19%
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       core_enrichment
## DOID:1492    TNC/HGF/RARA/GPX3/MBL2/KDR/KIAA0556/CYP1A1/CEP290/SST/EGR1/ESD/VWF/BCL2/SLC24A1/EPAS1/ATP1B2/CD36/CTGF/COL2A1/LCAT/PTGFR/MMP3/NPR1/FGFR3/CFI/APLNR/CFB/SELP/TGFB2/ELOVL4/XPA/GSN/SERPINF1/LUM/COL1A1/TIMP3/RBP4/EPOR/C5/FBLN5/MME/FGF2/COL8A1/AQP1/CALCRL/FBLN1/BBS1/ANGPTL7/PLXDC1/IGFBP2/BBS4/CFD/ATXN1/EFEMP1/MMP2/GSTM1/KITLG/CFH/CTNND2/ESR1/IGF1R/MYOC/CLK1/CXCL12/HSPA1L/CST3/CAV1/LOXL1/EDNRA/LTBP2/SPARC/COL8A2/TFF3/NTRK2/SPATA7/CLU/HTRA1/POSTN/F3/GJA1/TGFB3/GSTT1/ZEB1/FBN1/IL6ST/TPSAB1/TFF1/IGF1/ELN/VAV3/ADIPOQ/CA12/HLA-DQA1/ADH1B/BMP4/NDP/PLIN1/CX3CR1
## DOID:5614             HGF/RARA/GPX3/MBL2/KDR/KIAA0556/CYP1A1/CEP290/SST/EGR1/ESD/VWF/BCL2/SLC24A1/EPAS1/ATP1B2/CD36/CTGF/COL2A1/LCAT/PTGFR/MMP3/NPR1/FGFR3/CFI/APLNR/CFB/SELP/TGFB2/ELOVL4/XPA/GSN/SERPINF1/LUM/COL1A1/TIMP3/RBP4/EPOR/C5/FBLN5/MME/FGF2/COL8A1/AQP1/CALCRL/FBLN1/BBS1/ANGPTL7/PLXDC1/IGFBP2/BBS4/CFD/ATXN1/EFEMP1/MMP2/GSTM1/KITLG/CFH/CTNND2/ESR1/IGF1R/MYOC/CXCL12/HSPA1L/CST3/CAV1/LOXL1/EDNRA/LTBP2/SPARC/COL8A2/TFF3/NTRK2/SPATA7/CLU/HTRA1/POSTN/F3/GJA1/TGFB3/GSTT1/ZEB1/FBN1/IL6ST/TPSAB1/TFF1/IGF1/ELN/VAV3/ADIPOQ/CA12/HLA-DQA1/ADH1B/BMP4/NDP/PLIN1/CX3CR1
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;cnetplot:644be873eb98ddda41ab685173c26627&#34;&gt;&lt;code&gt;cnetplot&lt;/code&gt;&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;cnetplot(y, foldChange=geneList)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/DOSE/cnetplot_down.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In the figure, we can find that most significant associated diseases are down-regulated.&lt;/p&gt;

&lt;p&gt;We can of course visualize significant up-regulated disease pathways.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;up &amp;lt;- y$Description[order(y$NES, decreasing=TRUE)][1:6]
up

## [1] &amp;quot;tuberculosis&amp;quot;                                  
## [2] &amp;quot;respiratory syncytial virus infectious disease&amp;quot;
## [3] &amp;quot;laryngeal carcinoma&amp;quot;                           
## [4] &amp;quot;Kawasaki disease&amp;quot;                              
## [5] &amp;quot;breast ductal carcinoma&amp;quot;                       
## [6] &amp;quot;pulmonary sarcoidosis&amp;quot;

cnetplot(y, foldChange=geneList, showCategory=up)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/DOSE/cnetplot_up.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;gseaplot:644be873eb98ddda41ab685173c26627&#34;&gt;&lt;code&gt;gseaplot&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;gseaplot&lt;/code&gt; now supports adding plot title.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gseaplot(y, y$ID[1], title=y$Description[1])
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/DOSE/gseaplot.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>How to bug author</title>
      <link>https://guangchuangyu.github.io/2016/07/how-to-bug-author</link>
      <pubDate>Tue, 05 Jul 2016 20:13:35 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/07/how-to-bug-author</guid>
      <description>

&lt;p&gt;As an author of several Bioconductor packages. I found many questions from users are quite annoying. Some of them never use google and they are reluctant to read vignettes.&lt;/p&gt;

&lt;h3 id=&#34;step-1-make-sure-you-are-using-the-latest-release:53bda2482f1e2f0789bac3a1e6986818&#34;&gt;Step 1: make sure you are using the latest release&lt;/h3&gt;

&lt;p&gt;I found many peoples are using out-of-date packages. When they got an issue of an out-dated package, they never check whether the issue still exists in latest release.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/Screenshot 2016-07-05 19.48.59.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; rvcheck::check_bioc(&amp;quot;clusterProfiler&amp;quot;)
package is up-to-date release version
$installed_version
[1] &amp;quot;3.0.4&amp;quot;

$latest_version
[1] &amp;quot;3.0.4&amp;quot;

$up_to_date
[1] TRUE
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;step-2-read-the-vignettes:53bda2482f1e2f0789bac3a1e6986818&#34;&gt;Step 2: read the vignettes&lt;/h3&gt;

&lt;p&gt;All Bioconductor packages contains a least one vignette and some of them are in very details. Most of the user questions can be solved if user go through the vignette carefully.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://imgs.xkcd.com/comics/rtfm.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;step-3-ask-google:53bda2482f1e2f0789bac3a1e6986818&#34;&gt;Step 3: ask google&lt;/h3&gt;

&lt;p&gt;I received several emails asking why my Bioconductor package is not available when they try to install it using &lt;code&gt;install.packages()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If they google search the package name, they can reach the landing page of the package. Then they will find installation guide of using &lt;code&gt;biocLite()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;User question may already have an answer posted in Bioconductor support site, Biostars or somewhere. Just google search it before bugging the author.&lt;/p&gt;

&lt;h3 id=&#34;step-4-make-a-reproducible-example:53bda2482f1e2f0789bac3a1e6986818&#34;&gt;Step 4: make a reproducible example&lt;/h3&gt;

&lt;p&gt;If there is indeed an issue exists in latest release and it is not documented in vignette and google can&amp;rsquo;t answer it, then you need to make a reproducible example for package author to reproduce your issue.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://gist.github.com/talonsensei/e1fad082657054207f249ec98f0920eb&#34;&gt;A question&lt;/a&gt; from &lt;code&gt;ggtree&lt;/code&gt; user is a good example. For more details, please follow the advice from &lt;a href=&#34;http://adv-r.had.co.nz/Reproducibility.html&#34;&gt;http://adv-r.had.co.nz/Reproducibility.html&lt;/a&gt; or &lt;a href=&#34;http://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example&#34;&gt;http://stackoverflow.com/questions/5963269/how-to-make-a-great-r-reproducible-example&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Then post the reproducible example on &lt;a href=&#34;https://support.bioconductor.org/&#34;&gt;Bioconductor support site&lt;/a&gt; or &lt;a href=&#34;https://www.biostars.org/&#34;&gt;Biostars&lt;/a&gt; tag with package name. Disucssion in public forum is useful since it may help other users.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>identify method for ggtree</title>
      <link>https://guangchuangyu.github.io/2016/06/identify-method-for-ggtree</link>
      <pubDate>Tue, 28 Jun 2016 14:30:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/06/identify-method-for-ggtree</guid>
      <description>&lt;p&gt;We are happy to announce that &lt;code&gt;ggtree&lt;/code&gt; supports interactive tree annotation/manipulation by implementing an &lt;code&gt;identify&lt;/code&gt; method. Users can click on a node to highlight a clade, to label or rotate it &lt;em&gt;etc&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Here is an example of highlighting clades using &lt;code&gt;geom_hilight&lt;/code&gt; with &lt;code&gt;identify&lt;/code&gt;:&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/KcF8Ec38mzI&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;
 &lt;/div&gt;


&lt;p&gt;&lt;br&gt;
Here is another example of using &lt;code&gt;emojifont&lt;/code&gt; to label clades.&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/SmcceRD_jxg&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;
 &lt;/div&gt;


&lt;p&gt;&lt;br&gt;&lt;/p&gt;

&lt;p&gt;Interactive tree manipulation, e.g. rotating clades, is also possible.&lt;/p&gt;

&lt;p&gt;
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/lKNn4QlPO0E&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;
 &lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;The videos are also available in youku (优酷), see &lt;a href=&#34;http://v.youku.com/v_show/id_XMTYyMzgyODYyOA&#34;&gt;http://v.youku.com/v_show/id_XMTYyMzgyODYyOA&lt;/a&gt;, &lt;a href=&#34;http://v.youku.com/v_show/id_XMTYyNDIzODA0NA&#34;&gt;http://v.youku.com/v_show/id_XMTYyNDIzODA0NA&lt;/a&gt; and &lt;a href=&#34;http://v.youku.com/v_show/id_XMTYyMzgyODg2OA&#34;&gt;http://v.youku.com/v_show/id_XMTYyMzgyODg2OA&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>NEWS of my BioC packages</title>
      <link>https://guangchuangyu.github.io/2016/05/news-of-my-bioc-packages</link>
      <pubDate>Thu, 05 May 2016 20:13:57 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/05/news-of-my-bioc-packages</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/MISC/ke.jpg&#34; width=600&gt;&lt;/p&gt;

&lt;p&gt;Today is my birthday and it happened to be the release day of Bioconductor 3.3. It&amp;rsquo;s again the time to reflect what I&amp;rsquo;ve done in the past year.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/DOSE&#34;&gt;DOSE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;chipseeker:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ChIPseeker&lt;/h2&gt;

&lt;p&gt;Although ChIPseeker was designed for ChIP-seq annotation, I am very glad to find that someone else use it to annotate other data including &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/32&#34;&gt;copy number variants&lt;/a&gt; and &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/17&#34;&gt;DNA breakpoints&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;annotatepeak:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;annotatePeak&lt;/h3&gt;

&lt;p&gt;Several parameters including &lt;code&gt;sameStrand&lt;/code&gt;,&lt;code&gt;ignoreOverlap&lt;/code&gt;, &lt;code&gt;ignoreUpstream&lt;/code&gt; and &lt;code&gt;ignoreDownstream&lt;/code&gt; were added in &lt;code&gt;annotatePeak&lt;/code&gt; requested by &lt;a href=&#34;https://github.com/crazyhottommy&#34;&gt;@crazyhottommy&lt;/a&gt; for using ChIPseeker to annotate breakpoints from whole genome sequencing data.&lt;/p&gt;

&lt;p&gt;Another parameter &lt;code&gt;overlap&lt;/code&gt; was also introduced. By default &lt;code&gt;overlap=&amp;quot;TSS&amp;quot;&lt;/code&gt; and only overlap with TSS will be reported as the nearest gene. If &lt;code&gt;overlap=&amp;quot;all&amp;quot;&lt;/code&gt;, then gene overlap with peak will be reported as nearest gene, no matter the overlap is at TSS region or not.&lt;/p&gt;

&lt;p&gt;Now &lt;code&gt;annotatePeak&lt;/code&gt; also support using user&amp;rsquo;s customize regions to annotate their data by passing &lt;code&gt;TxDb=user_defined_GRanges&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;getbioregion:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;getBioRegion&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;getPromoters()&lt;/code&gt; function prepare a &lt;code&gt;GRanges&lt;/code&gt; object of promoter regions by user specific upstream and downstream distance from Transcript Start Site (TSS). Then we can align the peaks that are mapping to these regions and visualize the profile or heatmap of ChIP binding to the TSS regions.&lt;/p&gt;

&lt;p&gt;Users (&lt;a href=&#34;https://support.bioconductor.org/p/73069/#73157&#34;&gt;1&lt;/a&gt; and &lt;a href=&#34;https://support.bioconductor.org/p/73377/&#34;&gt;2&lt;/a&gt;) are interesting in the intensity of peaks binding to the start of intron/exon, and ChIPseeker provides a new function &lt;code&gt;getBioRegion&lt;/code&gt; to output &lt;code&gt;GRanges&lt;/code&gt; object of Intron/Exon start regions.&lt;/p&gt;

&lt;h3 id=&#34;visualization:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;visualization&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize &lt;a href=&#34;http://guangchuangyu.github.io/2015/07/upsetplot-in-chipseeker/&#34;&gt;ChIP annotation overlap&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;covplot&lt;/code&gt; now support &lt;a href=&#34;http://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist/&#34;&gt;GRangesList&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;geo-data-mining:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GEO data mining&lt;/h3&gt;

&lt;p&gt;ChIPseeker incorporates GEO database and supports data mining to infer cooperative regulation. The data was updated and now ChIPseeker contains 19348 bed file information.&lt;/p&gt;

&lt;h2 id=&#34;clusterprofiler:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;clusterProfiler&lt;/h2&gt;

&lt;p&gt;We compare clusterProfiler with GSEA-P (which released by broad institute), the p-values calculated by these two software are &lt;a href=&#34;http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;almost identical&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For comparing biological themes, &lt;code&gt;clusterProfiler&lt;/code&gt; supports formula to express complex conditions and facet is supported to &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/32&#34;&gt;visualize complex result&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;read.gmt&lt;/code&gt; function for parsing GMT file format from &lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;, so that gene set collections in this database can be used in &lt;code&gt;clusterProfiler&lt;/code&gt; for both hypergeometric test and GSEA.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis/&#34;&gt;KEGG Module&lt;/a&gt; was supported just like the KEGG Pathway, &lt;code&gt;clusterProfiler&lt;/code&gt; will query the online annotation data which keep the annotation data alwasy updated.&lt;/p&gt;

&lt;p&gt;The KEGG database was updated quite frequently. The &lt;code&gt;KEGG.db&lt;/code&gt; which was not updated since 2012, it contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2014/08/why-clusterprofiler-fails/&#34;&gt;5894 human genes&lt;/a&gt;. In Feb. 2015, when &lt;code&gt;clusterProfiler&lt;/code&gt; first supports querying online KEGG data, KEGG contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;6861 human genes&lt;/a&gt; and today it has &lt;strong&gt;7018&lt;/strong&gt; human genes annotated. Most of the tools/webservers used out-dated data (e.g. DAVID not updated since 2010, 5085 human genes annotated by KEGG), the analyzed result may totally changed if we use a recently updated data. Indeed &lt;code&gt;clusterProfiler&lt;/code&gt; is more reliable as we always use the latest data.&lt;/p&gt;

&lt;p&gt;In addition to &lt;code&gt;bitr&lt;/code&gt; function that can translate biological ID using &lt;code&gt;OrgDb&lt;/code&gt; object, we provides &lt;a href=&#34;http://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler/&#34;&gt;bitr_kegg&lt;/a&gt; that uses KEGG API for translating biological ID. It supports more than 4000 species (can be search via the &lt;code&gt;search_kegg_species&lt;/code&gt; function) as in KEGG Pathway and Module analyses.&lt;/p&gt;

&lt;p&gt;The function called of &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler/&#34;&gt;enrichGO and gseGO&lt;/a&gt; was changed. Now not only species that have OrgDb available in Bioconductor can be analyzed but also all species that have an OrgDb can be analyzed which can be query online via &lt;code&gt;AnnotationHub&lt;/code&gt; or build with user&amp;rsquo;s own data. With this update, &lt;code&gt;enrichGO&lt;/code&gt; and &lt;code&gt;gseGO&lt;/code&gt; can input any gene ID type if only the ID type was supported in the &lt;code&gt;OrgDb&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;GO enrichment analysis alwasy output redundant terms, we implemented a &lt;code&gt;simplify&lt;/code&gt; function to remove redundant terms by calculating GO semantic similarity using &lt;code&gt;GOSemSim&lt;/code&gt;. Several useful utilities include &lt;code&gt;dropGO&lt;/code&gt;, &lt;code&gt;go2ont&lt;/code&gt;, &lt;code&gt;go2term&lt;/code&gt;, &lt;code&gt;gofilter&lt;/code&gt; and &lt;code&gt;gsfilter&lt;/code&gt; are also provided.&lt;/p&gt;

&lt;p&gt;I bump the version to 3.0.0 the following three reasons:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the changes of function calls&lt;/li&gt;
&lt;li&gt;can analyze any ontology/pathway annotation (supports user&amp;rsquo;s customize annotation data)&lt;/li&gt;
&lt;li&gt;can analyze all speices that have annotation available (e.g. more than 4000 species for KEGG)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Although the package is very simple when I published it, I keep update and add new features from my own idea or user&amp;rsquo;s request. Now this package is indeed in good shape. Here is the summary.&lt;/p&gt;

&lt;p&gt;This package implements methods to analyze and visualize functional profiles of genomic coordinates (supported by &lt;a href=&#34;http://www.bioconductor.org/packages/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;), gene and gene clusters.&lt;/p&gt;

&lt;p&gt;clusterProfiler supports both &lt;em&gt;hypergeometric test&lt;/em&gt; and &lt;em&gt;Gene Set Enrichment Analysis&lt;/em&gt; for many ontologies/pathways, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Disease Ontology (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ncg.kcl.ac.uk/&#34;&gt;Network of Cancer Gene&lt;/a&gt; (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Gene Ontology (supports many species with GO annotation query online via &lt;a href=&#34;https://bioconductor.org/packages/AnnotationHub/&#34;&gt;AnnotationHub&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;KEGG Pathway and Module with latest online data (supports more than 4000 species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Reactome Pathway (via &lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;DAVID (via &lt;a href=&#34;http://www.bioconductor.org/packages/RDAVIDWebService&#34;&gt;RDAVIDWebService&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;hallmark gene sets&lt;/li&gt;
&lt;li&gt;positional gene sets&lt;/li&gt;
&lt;li&gt;curated gene sets&lt;/li&gt;
&lt;li&gt;motif gene sets&lt;/li&gt;
&lt;li&gt;computational gene sets&lt;/li&gt;
&lt;li&gt;GO gene sets&lt;/li&gt;
&lt;li&gt;oncogenic signatures&lt;/li&gt;
&lt;li&gt;immunologic signatures&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Other Annotations

&lt;ul&gt;
&lt;li&gt;from other sources (e.g. &lt;a href=&#34;http://www.disgenet.org/web/DisGeNET/menu/home&#34;&gt;DisGeNET&lt;/a&gt; as &lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;an example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;user&amp;rsquo;s annotation&lt;/li&gt;
&lt;li&gt;customized ontology&lt;/li&gt;
&lt;li&gt;and many others&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;clusterProfiler&lt;/em&gt; also provides several visualization methods to help interpreting enriched results, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;barplot&lt;/li&gt;
&lt;li&gt;cnetplot&lt;/li&gt;
&lt;li&gt;dotplot&lt;/li&gt;
&lt;li&gt;enrichMap&lt;/li&gt;
&lt;li&gt;gseaplot&lt;/li&gt;
&lt;li&gt;plotGOgraph (via &lt;a href=&#34;http://www.bioconductor.org/packages/topGO&#34;&gt;topGO&lt;/a&gt; package)&lt;/li&gt;
&lt;li&gt;upsetplot (via &lt;a href=&#34;https://github.com/cran/UpSetR&#34;&gt;UpSetR&lt;/a&gt; package)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and several useful utilities:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;bitr (Biological Id TranslatoR)&lt;/li&gt;
&lt;li&gt;bitr_kegg (bitr using KEGG source)&lt;/li&gt;
&lt;li&gt;compareCluster (biological theme comparison)&lt;/li&gt;
&lt;li&gt;dropGO (screen out GO term of specific level or specific term)&lt;/li&gt;
&lt;li&gt;go2ont (convert GO ID to Ontology)&lt;/li&gt;
&lt;li&gt;go2term (convert GO ID to descriptive term)&lt;/li&gt;
&lt;li&gt;gofilter (restrict result at specific GO level)&lt;/li&gt;
&lt;li&gt;gsfilter (restrict result by gene set size)&lt;/li&gt;
&lt;li&gt;search_kegg_organism (search kegg supported organism)&lt;/li&gt;
&lt;li&gt;setReadable (convert IDs stored &lt;code&gt;enrichResult&lt;/code&gt; object to gene symbol)&lt;/li&gt;
&lt;li&gt;simplify (remove redundant GO terms, supported via &lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;dose:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;DOSE&lt;/h2&gt;

&lt;p&gt;DOSE now test bimodal separately in GSEA and the output pvalues are &lt;a href=&#34;(http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;more conserved&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;maxGSSize&lt;/code&gt; parameter was added, with default value of &lt;code&gt;500&lt;/code&gt;. Usually if the geneset &amp;gt; 500, its probability of being called significant by GSEA rises quite dramatically.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;gsfilter&lt;/code&gt; function for restricting enriched results with minimal and maximal gene set sizes.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize overlap of enriched gene sets.&lt;/p&gt;

&lt;p&gt;The dot sizes in &lt;code&gt;enrichMap&lt;/code&gt; now scaled by category sizes&lt;/p&gt;

&lt;p&gt;All these changes also affect &lt;code&gt;clusterProfiler&lt;/code&gt; and &lt;code&gt;ReactomePA&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&#34;ggtree:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ggtree&lt;/h2&gt;

&lt;p&gt;I put more efforts to extend &lt;code&gt;ggtree&lt;/code&gt; than the sum of all other packages. Here listed the major new features while small improvement and bug fixed can be found in the NEWS file.&lt;/p&gt;

&lt;h3 id=&#34;io:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;IO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;supports &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;NHX&lt;/a&gt; file format via &lt;code&gt;read.nhx&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;supports &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/&#34;&gt;phylip&lt;/a&gt; tree format via &lt;code&gt;read.phylip&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;raxml2nwk for converting raxml bootstrap tree to newick text&lt;/li&gt;
&lt;li&gt;all parser functions support passing &lt;code&gt;textConnection(text_string)&lt;/code&gt; as a file&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;ape&lt;/code&gt; bootstrap analysis&lt;/li&gt;
&lt;li&gt;supports annotating tree with ancestral sequences inferred by &lt;code&gt;phangorn&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;obkData&lt;/code&gt; object defined by &lt;code&gt;OutbreakTools&lt;/code&gt; package&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;phyloseq&lt;/code&gt; object defined by &lt;code&gt;phyloseq&lt;/code&gt; package&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;layers:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;layers&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;geom_point2,geom_text2, geom_segment2 and geom_label2 to &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;support subsetting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;geom_treescale for adding scale of branch length&lt;/li&gt;
&lt;li&gt;geom_cladelabel for labeling selected clade&lt;/li&gt;
&lt;li&gt;geom_tiplab2 for adding tiplab of circular tree&lt;/li&gt;
&lt;li&gt;geom_taxalink for connecting related taxa&lt;/li&gt;
&lt;li&gt;geom_range for adding range to present uncertainty of branch lengths&lt;/li&gt;
&lt;li&gt;subview and inset now support annotating with &lt;a href=&#34;http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function/&#34;&gt;image files&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;utilities:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;utilities&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;rescale_tree&lt;/a&gt; function to rescale branch lengths using numerical variable&lt;/li&gt;
&lt;li&gt;MRCA for finding Most Recent Common Ancestor among a vector of tips&lt;/li&gt;
&lt;li&gt;viewClade to zoom in a selected clade&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;vignettes:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;vignettes&lt;/h3&gt;

&lt;p&gt;Split the long vignette to several small ones and add more examples.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/ggtree.html&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/advanceTreeAnnotation.html&#34;&gt;Advance Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here is the NEWS record:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CHANGES IN VERSION 1.3.16
------------------------
 o geom_treescale() supports family argument &amp;lt;2016-04-27, Wed&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/56
 o update fortify.phylo to work with phylo that has missing value of edge length &amp;lt;2016-04-21, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/54
 o support passing textConnection(text_string) as a file &amp;lt;2016-04-21, Thu&amp;gt;
   + contributed by Casey Dunn &amp;lt;casey_dunn@brown.edu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/pull/55#issuecomment-212859693
 
CHANGES IN VERSION 1.3.15
------------------------
 o geom_tiplab2 supports parameter hjust &amp;lt;2016-04-18, Mon&amp;gt;
 o geom_tiplab and geom_tiplab2 support using geom_label2 by passing geom=&amp;quot;label&amp;quot; &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_label2 that support subsetting &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_tiplab2 for adding tip label of circular layout &amp;lt;2016-04-06, Wed&amp;gt;
 o use plot$plot_env to access ggplot2 parameter &amp;lt;2016-04-06, Wed&amp;gt;
 o geom_taxalink for connecting related taxa &amp;lt;2016-04-01, Fri&amp;gt; 
 o geom_range for adding range of HPD to present uncertainty of evolutionary inference &amp;lt;2016-04-01, Fri&amp;gt;
 
CHANGES IN VERSION 1.3.14
------------------------
 o geom_tiplab works with NA values, compatible with collapse &amp;lt;2016-03-05, Sat&amp;gt;
 o update theme_tree2 due to the issue of https://github.com/hadley/ggplot2/issues/1567 &amp;lt;2016-03-05, Sat&amp;gt;
 o offset works in `align=FFALSE` with `annotation_image` function &amp;lt;2016-02-23, Tue&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/46
 o subview and inset now supports annotating with img files &amp;lt;2016-02-23, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.13
------------------------
 o add example of rescale_tree function in treeAnnotation.Rmd &amp;lt;2016-02-07, Sun&amp;gt;
 o geom_cladelabel works with collapse &amp;lt;2016-02-07, Sun&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/38 

CHANGES IN VERSION 1.3.12
------------------------
 o exchange function name of geom_tree and geom_tree2  &amp;lt;2016-01-25, Mon&amp;gt;
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/hadley/ggplot2/issues/1512
 o colnames_level parameter in gheatmap &amp;lt;2016-01-25, Mon&amp;gt;
 o raxml2nwk function for converting raxml bootstrap tree to newick format &amp;lt;2016-01-25, Mon&amp;gt; 
 
CHANGES IN VERSION 1.3.11
------------------------
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/36
 o change compute_group() to compute_panel in geom_tree2() &amp;lt;2016-01-21, Thu&amp;gt;
   + fixed issue, https://github.com/GuangchuangYu/ggtree/issues/36
 o support phyloseq object &amp;lt;2016-01-21, Thu&amp;gt;
 o update geom_point2, geom_text2 and geom_segment2 to support setup_tree_data &amp;lt;2016-01-21, Thu&amp;gt;
 o implement geom_tree2 layer that support duplicated node records via the setup_tree_data function &amp;lt;2016-01-21, Thu&amp;gt;
 o rescale_tree function for rescaling branch length of tree object &amp;lt;2016-01-20, Wed&amp;gt;
 o upgrade set_branch_length, now branch can be rescaled using feature in extraInfo slot &amp;lt;2016-01-20, Wed&amp;gt;
 
CHANGES IN VERSION 1.3.10
------------------------
 o remove dependency of gridExtra by implementing multiplot function instead of using grid.arrange &amp;lt;2016-01-20, Wed&amp;gt;
 o remove dependency of colorspace &amp;lt;2016-01-20, Wed&amp;gt;
 o support phylip tree format and update vignette of phylip example &amp;lt;2016-01-15, Fri&amp;gt;

CHANGES IN VERSION 1.3.9
------------------------
 o optimize getYcoord &amp;lt;2016-01-14, Thu&amp;gt;
 o add &#39;multiPhylo&#39; example in &#39;Tree Visualization&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o viewClade, scaleClade, collapse, expand, rotate, flip, get_taxa_name and scale_x_ggtree accepts input tree_view=NULL.
   these function will access the last plot if tree_view=NULL. &amp;lt;2016-01-13, Wed&amp;gt;
   + &amp;gt; ggtree(rtree(30)); viewClade(node=35) works. no need to pipe.
 
CHANGES IN VERSION 1.3.8
------------------------
 o add example of viewClade in &#39;Tree Manipulation&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o add viewClade function &amp;lt;2016-01-12, Tue&amp;gt;
 o support obkData object defined by OutbreakTools &amp;lt;2016-01-12, Tue&amp;gt;
 o update vignettes &amp;lt;2016-01-07, Thu&amp;gt;
 o 05 advance tree annotation vignette &amp;lt;2016-01-04, Mon&amp;gt;
 o export theme_inset &amp;lt;2016-01-04, Mon&amp;gt;
 o inset, nodebar, nodepie functions &amp;lt;2015-12-31, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.7
------------------------
 o split the long vignette to several vignettes
   + 00 ggtree &amp;lt;2015-12-29, Tue&amp;gt;
   + 01 tree data import &amp;lt;2015-12-28, Mon&amp;gt;
   + 02 tree visualization &amp;lt;2015-12-28, Mon&amp;gt;
   + 03 tree manipulation &amp;lt;2015-12-28, Mon&amp;gt;
   + 04 tree annotation &amp;lt;2015-12-29, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.6
------------------------
 o MRCA function for finding Most Recent Common Ancestor among a vector of tips &amp;lt;2015-12-22, Tue&amp;gt;
 o geom_cladelabel: add bar and label to annotate a clade &amp;lt;2015-12-21, Mon&amp;gt;
   - remove annotation_clade and annotation_clade2 functions.
 o geom_treescale: tree scale layer. (add_legend was removed) &amp;lt;2015-12-21, Mon&amp;gt;
 
CHANGES IN VERSION 1.3.5
------------------------
 o bug fixed, read.nhx now works with scientific notation &amp;lt;2015-11-30, Mon&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/30

CHANGES IN VERSION 1.3.4
------------------------
 o rename beast feature when name conflict with reserve keywords (label, branch, etc) &amp;lt;2015-11-27, Fri&amp;gt;
 o get_clade_position function &amp;lt;2015-11-26, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/28
 o get_heatmap_column_position function &amp;lt;2015-11-25, Wed&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/26
 o support NHX (New Hampshire X) format via read.nhx function &amp;lt;2015-11-17, Tue&amp;gt;
 o bug fixed in extract.treeinfo.jplace &amp;lt;2015-11-17, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.3
------------------------
 o support color=NULL in gheatmap, then no colored line will draw within the heatmap &amp;lt;2015-10-30, Fri&amp;gt;
 o add `angle` for also rectangular, so that it will be available for layout=&#39;rectangular&#39; following by coord_polar() &amp;lt;2015-10-27, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.2
------------------------
 o update vignette, add example of ape bootstrap and phangorn ancestral sequences &amp;lt;2015-10-26, Mon&amp;gt;
 o add support of ape bootstrap analysis &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/20
 o add support of ancestral sequences inferred by phangorn &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/21
 
CHANGES IN VERSION 1.3.1
------------------------
 o change angle to angle + 90, so that label will in radial direction &amp;lt;2015-10-22, Thu&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/17
 o na.rm should be always passed to layer(), fixed it in geom_hilight and geom_text2 &amp;lt;2015-10-21, Wed&amp;gt;
   + see https://github.com/hadley/ggplot2/issues/1380
 o matching beast stats with tree using internal node number instead of label &amp;lt;2015-10-20, Tue&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;gosemsim:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GOSemSim&lt;/h2&gt;

&lt;p&gt;update IC data using update OrgDb packages.&lt;/p&gt;

&lt;h2 id=&#34;reactomepa:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ReactomePA&lt;/h2&gt;

&lt;p&gt;We published ReactomePA in &lt;a href=&#34;http://pubs.rsc.org/en/Content/ArticleLanding/2016/MB/C5MB00663E&#34;&gt;Molecular BioSystems&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>convert biological ID with KEGG API using clusterProfiler</title>
      <link>https://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler</link>
      <pubDate>Tue, 03 May 2016 17:00:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler</guid>
      <description>

&lt;h2 id=&#34;bitr-kegg:ea0718166651864960b492e0d7486a4f&#34;&gt;bitr_kegg&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; can convert biological IDs using &lt;code&gt;OrgDb&lt;/code&gt; object via the &lt;code&gt;bitr&lt;/code&gt; function. Now I implemented another function, &lt;code&gt;bitr_kegg&lt;/code&gt; for converting IDs through KEGG API.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(clusterProfiler)
data(gcSample)
hg &amp;lt;- gcSample[[1]]
head(hg)

## [1] &amp;quot;4597&amp;quot;  &amp;quot;7111&amp;quot;  &amp;quot;5266&amp;quot;  &amp;quot;2175&amp;quot;  &amp;quot;755&amp;quot;   &amp;quot;23046&amp;quot;

eg2np &amp;lt;- bitr_kegg(hg, fromType=&#39;kegg&#39;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;hsa&#39;)

## Warning in bitr_kegg(hg, fromType = &amp;quot;kegg&amp;quot;, toType = &amp;quot;ncbi-proteinid&amp;quot;,
## organism = &amp;quot;hsa&amp;quot;): 3.7% of input gene IDs are fail to map...

head(eg2np)

##     kegg ncbi-proteinid
## 1   8326      NP_003499
## 2  58487   NP_001034707
## 3 139081      NP_619647
## 4  59272      NP_068576
## 5    993      NP_001780
## 6   2676      NP_001487

np2up &amp;lt;- bitr_kegg(eg2np[,2], fromType=&#39;ncbi-proteinid&#39;, toType=&#39;uniprot&#39;, organism=&#39;hsa&#39;)

head(np2up)

##   ncbi-proteinid uniprot
## 1      NP_005457  O75586
## 2      NP_005792  P41567
## 3      NP_005792  Q6IAV3
## 4      NP_037536  Q13421
## 5      NP_006054  O60662
## 6   NP_001092002  O95398
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The ID type (both fromType &amp;amp; toType) should be one of &amp;lsquo;kegg&amp;rsquo;, &amp;lsquo;ncbi-geneid&amp;rsquo;, &amp;lsquo;ncbi-proteinid&amp;rsquo; or &amp;lsquo;uniprot&amp;rsquo;. The &amp;lsquo;kegg&amp;rsquo; is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the &amp;lsquo;kegg&amp;rsquo; ID is &lt;code&gt;entrezgene&lt;/code&gt; ID for eukaryote species and &lt;code&gt;Locus&lt;/code&gt; ID for prokaryotes.&lt;/p&gt;

&lt;p&gt;Many prokaryote species don&amp;rsquo;t have entrezgene ID available. For example we can check the gene information of &lt;code&gt;ece:Z5100&lt;/code&gt; in &lt;a href=&#34;http://www.genome.jp/dbget-bin/www_bget?ece:Z5100&#34;&gt;http://www.genome.jp/dbget-bin/www_bget?ece:Z5100&lt;/a&gt;, which have &lt;code&gt;NCBI-ProteinID&lt;/code&gt; and &lt;code&gt;UnitProt&lt;/code&gt; links in the &lt;code&gt;Other DBs&lt;/code&gt; Entry, but not &lt;code&gt;NCBI-GeneID&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If we try to convert &lt;code&gt;Z5100&lt;/code&gt; to &lt;code&gt;ncbi-geneid&lt;/code&gt;, &lt;code&gt;bitr_kegg&lt;/code&gt; will throw error of &lt;code&gt;ncbi-geneid is not supported&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;ncbi-geneid&#39;, organism=&#39;ece&#39;)

## Error in KEGG_convert(fromType, toType, organism) :
## ncbi-geneid is not supported for ece ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can of course convert it to &lt;code&gt;ncbi-proteinid&lt;/code&gt; and &lt;code&gt;uniprot&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;ece&#39;)

##    kegg ncbi-proteinid
## 1 Z5100       AAG58814

bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;uniprot&#39;, organism=&#39;ece&#39;)

##    kegg uniprot
## 1 Z5100  Q7DB85
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;search-kegg-organism:ea0718166651864960b492e0d7486a4f&#34;&gt;search_kegg_organism&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; supports more than 4k species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt; for hypergeometric test (&lt;code&gt;enrichKEGG&lt;/code&gt; &amp;amp; &lt;code&gt;enrichMKEGG&lt;/code&gt;) and GSEA (&lt;code&gt;gseKEGG&lt;/code&gt; &amp;amp; &lt;code&gt;gseMKEGG&lt;/code&gt;). We can use &lt;code&gt;bitr_kegg&lt;/code&gt; to convert ID for all these 4k species. To facilitate searching scientific name abbreviate used in the &lt;code&gt;organism&lt;/code&gt; parameter of these functions, I implemented the &lt;code&gt;search_kegg_organism&lt;/code&gt; function. We can search by &lt;code&gt;kegg_code&lt;/code&gt;, &lt;code&gt;scientific_name&lt;/code&gt; or &lt;code&gt;common_name&lt;/code&gt; (which is not available for prokaryotes).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;search_kegg_organism(&#39;ece&#39;, by=&#39;kegg_code&#39;)

##     kegg_code                        scientific_name common_name
## 334       ece Escherichia coli O157:H7 EDL933 (EHEC)        &amp;lt;NA&amp;gt;

ecoli &amp;lt;- search_kegg_organism(&#39;Escherichia coli&#39;, by=&#39;scientific_name&#39;)
dim(ecoli)

## [1] 64  3

head(ecoli)

##     kegg_code                        scientific_name common_name
## 329       eco           Escherichia coli K-12 MG1655        &amp;lt;NA&amp;gt;
## 330       ecj            Escherichia coli K-12 W3110        &amp;lt;NA&amp;gt;
## 331       ecd            Escherichia coli K-12 DH10B        &amp;lt;NA&amp;gt;
## 332       ebw                Escherichia coli BW2952        &amp;lt;NA&amp;gt;
## 333      ecok            Escherichia coli K-12 MDS42        &amp;lt;NA&amp;gt;
## 334       ece Escherichia coli O157:H7 EDL933 (EHEC)        &amp;lt;NA&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;keytype-parameter:ea0718166651864960b492e0d7486a4f&#34;&gt;keyType parameter&lt;/h2&gt;

&lt;p&gt;With the ID conversion utilities built in &lt;code&gt;clusterProfiler&lt;/code&gt;, I add a parameter &lt;code&gt;keyType&lt;/code&gt; in &lt;code&gt;enrichKEGG&lt;/code&gt;, &lt;code&gt;enrichMKEGG&lt;/code&gt;, &lt;code&gt;gseKEGG&lt;/code&gt; and &lt;code&gt;gseMKEGG&lt;/code&gt;. Now we can use ID type that is not the primary ID in KEGG database.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;x &amp;lt;- enrichKEGG(np2up[,2], organism=&#39;hsa&#39;, keyType=&#39;uniprot&#39;)
head(summary(x))

##                ID                            Description GeneRatio
## hsa04072 hsa04072      Phospholipase D signaling pathway    11/133
## hsa04060 hsa04060 Cytokine-cytokine receptor interaction    14/133
## hsa04390 hsa04390                Hippo signaling pathway    10/133
## hsa04975 hsa04975           Fat digestion and absorption     5/133
## hsa05221 hsa05221                 Acute myeloid leukemia     6/133
##           BgRatio       pvalue   p.adjust     qvalue
## hsa04072 216/9275 0.0002654190 0.03901659 0.03240905
## hsa04060 354/9275 0.0005349245 0.03931695 0.03265855
## hsa04390 213/9275 0.0009536247 0.04199404 0.03488227
## hsa04975  58/9275 0.0014014886 0.04199404 0.03488227
## hsa05221  86/9275 0.0014283687 0.04199404 0.03488227
##                                                                                                         geneID
## hsa04072                      O95398/Q99777/P49619/Q6FGP0/Q8WVM9/O14807/P41594/A8K5P7/P10145/A0A024RDA5/P16234
## hsa04060 A0N0N3/O00574/P19876/P01589/P10145/A0A024RDA5/B4DGA4/Q99665/P16234/P78556/Q6I9S7/P42830/P27930/Q9UBN6
## hsa04390                             Q8WW10/A8K141/Q9UI47/P35240/A0A024R1J8/Q659G9/Q9UJU2/P22003/M9VUD0/O00144
## hsa04975                                                            Q9UNK4/A0A087WZT4/A0A0C4DFX6/Q9UHC9/P04054
## hsa05221                                                         Q659G9/Q9UJU2/Q03181/A0A024RCW6/Q06455/B2R6I9
##          Count
## hsa04072    11
## hsa04060    14
## hsa04390    10
## hsa04975     5
## hsa05221     6
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;setreadable:ea0718166651864960b492e0d7486a4f&#34;&gt;setReadable&lt;/h2&gt;

&lt;p&gt;For GO analysis, we have a &lt;code&gt;readable&lt;/code&gt; parameter to control whether traslating the IDs to human readable gene name. This parameter is not available for KEGG analysis. But we still have the ability to translate input gene IDs to gene name using &lt;code&gt;setReadable&lt;/code&gt; function if and only if corresponding &lt;code&gt;OrgDb&lt;/code&gt; object is available.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;y &amp;lt;- setReadable(x, &#39;org.Hs.eg.db&#39;, keytype=&amp;quot;UNIPROT&amp;quot;)
head(summary(y))

##                ID                            Description GeneRatio
## hsa04072 hsa04072      Phospholipase D signaling pathway    11/133
## hsa04060 hsa04060 Cytokine-cytokine receptor interaction    14/133
## hsa04390 hsa04390                Hippo signaling pathway    10/133
## hsa04975 hsa04975           Fat digestion and absorption     5/133
## hsa05221 hsa05221                 Acute myeloid leukemia     6/133
##           BgRatio       pvalue   p.adjust     qvalue
## hsa04072 216/9275 0.0002654190 0.03901659 0.03240905
## hsa04060 354/9275 0.0005349245 0.03931695 0.03265855
## hsa04390 213/9275 0.0009536247 0.04199404 0.03488227
## hsa04975  58/9275 0.0014014886 0.04199404 0.03488227
## hsa05221  86/9275 0.0014283687 0.04199404 0.03488227
##                                                                                                geneID
## hsa04072                             RAPGEF3/RAPGEF3/DGKG/MRAS/MRAS/MRAS/GRM5/GRM5/CXCL8/CXCL8/PDGFRA
## hsa04060 CXCR6/CXCR6/CXCL3/IL2RA/CXCL8/CXCL8/IL12RB2/IL12RB2/PDGFRA/CCL20/CXCL5/CXCL5/IL1R2/TNFRSF10D
## hsa04390                                        CTNNA3/CTNNA3/CTNNA3/NF2/NF2/LEF1/LEF1/BMP5/BMP5/FZD9
## hsa04975                                                        PLA2G2D/PLA2G2D/NPC1L1/NPC1L1/PLA2G1B
## hsa05221                                                        LEF1/LEF1/PPARD/PPARD/RUNX1T1/RUNX1T1
##          Count
## hsa04072    11
## hsa04060    14
## hsa04390    10
## hsa04975     5
## hsa05221     6
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>about</title>
      <link>https://guangchuangyu.github.io/home/about/</link>
      <pubDate>Wed, 20 Apr 2016 00:00:00 +0000</pubDate>
      
      <guid>https://guangchuangyu.github.io/home/about/</guid>
      <description>

&lt;h2 id=&#34;biography:6083a88ee3411b0d17ce02d738f69d47&#34;&gt;Biography&lt;/h2&gt;

&lt;p&gt;I am Guangchuang YU. A PhD candidate studying evolution of influenza A virus at The University of Hong Kong.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>KEGG Module Enrichment Analysis</title>
      <link>https://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis</link>
      <pubDate>Wed, 13 Apr 2016 20:48:15 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;KEGG MODULE is a collection of manually defined functional units, called KEGG modules and identified by the M numbers, used for annotation and biological interpretation of sequenced genomes. There are four types of KEGG modules:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pathway modules – representing tight functional units in KEGG metabolic pathway maps, such as M00002 (Glycolysis, core module involving three-carbon compounds)&lt;/li&gt;
&lt;li&gt;structural complexes – often forming molecular machineries, such as M00072 (Oligosaccharyltransferase)&lt;/li&gt;
&lt;li&gt;functional sets – for other types of essential sets, such as M00360 (Aminoacyl-tRNA synthases, prokaryotes)&lt;/li&gt;
&lt;li&gt;signature modules – as markers of phenotypes, such as M00363 (EHEC pathogenicity signature, Shiga toxin)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&#34;http://www.genome.jp/kegg/module.html&#34;&gt;KEGG Modules&lt;/a&gt; have a much more straightforwared interpretation in many situations and there was a &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/37&#34;&gt;feature request&lt;/a&gt; for implementing an enrichment test from clusterProfiler user. Both hypergeometric test and GSEA of KEGG Module are now supported in &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;. Just like &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;KEGG Pathway Analysis&lt;/a&gt;, clusterProfiler accesses latest online data and supports more than 2000 species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To prevent confusing new users who may not fammiliar with KEGG, I created two new functions, &lt;em&gt;enrichMKEGG&lt;/em&gt; and &lt;em&gt;gseMKEGG&lt;/em&gt; for enrichment test of KEGG Module and keep the original functions, &lt;em&gt;enrichKEGG&lt;/em&gt; and &lt;em&gt;gseKEGG&lt;/em&gt; for KEGG pathway analysis only.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(clusterProfiler)

data(geneList)
de &amp;lt;- names(geneList)[1:100]
xx &amp;lt;- enrichMKEGG(de, organism=&#39;hsa&#39;, minGSSize=1)
head(summary(xx))

##            ID
## M00693 M00693
## M00286 M00286
## M00067 M00067
## M00691 M00691
##                                                                                    Description
## M00693                                                            Cell cycle - G2/M transition
## M00286                                                                            GINS complex
## M00067 Sulfoglycolipids biosynthesis, ceramide/1-alkyl-2-acylglycerol =&amp;gt; sulfatide/seminolipid
## M00691                                               DNA damage-induced cell cycle checkpoints
##        GeneRatio BgRatio       pvalue     p.adjust       qvalue
## M00693       3/8 10/1528 0.0000111304 5.565199e-05 1.171621e-05
## M00286       2/8  4/1528 0.0001432508 3.581269e-04 7.539514e-05
## M00067       1/8  2/1528 0.0104472034 1.741201e-02 3.665685e-03
## M00691       1/8  7/1528 0.0361484900 4.518561e-02 9.512761e-03
##              geneID Count
## M00693 9133/890/983     3
## M00286   9837/51659     2
## M00067         7368     1
## M00691         1111     1

yy &amp;lt;- gseMKEGG(geneList)

## [1] &amp;quot;calculating observed enrichment scores...&amp;quot;
## [1] &amp;quot;calculating permutation scores...&amp;quot;
## [1] &amp;quot;calculating p values...&amp;quot;
## [1] &amp;quot;done...&amp;quot;

head(summary(yy))

##            ID                     Description setSize enrichmentScore
## M00337 M00337                Immunoproteasome      15       0.7583644
## M00340 M00340   Proteasome, 20S core particle      13       0.7935026
## M00354 M00354 Spliceosome, U4/U6.U5 tri-snRNP      29       0.6053503
##             NES      pvalue   p.adjust    qvalues
## M00337 2.063359 0.002298851 0.03675214 0.02968961
## M00340 2.047060 0.002409639 0.03675214 0.02968961
## M00354 1.913834 0.002564103 0.03675214 0.02968961
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Please refer to &lt;a href=&#34;http://www.bioconductor.org/packages/devel/bioc/vignettes/clusterProfiler/inst/doc/clusterProfiler.html&#34;&gt;vignette&lt;/a&gt; for more details.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>yet an unofficial BioEdit for OSX</title>
      <link>https://guangchuangyu.github.io/2016/03/yet-an-unofficial-bioedit-for-osx</link>
      <pubDate>Wed, 30 Mar 2016 13:40:22 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/03/yet-an-unofficial-bioedit-for-osx</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.mbio.ncsu.edu/bioedit/bioedit.html&#34;&gt;&lt;img src=&#34;http://www.mbio.ncsu.edu/bioedit/Banner1.GIF&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To my knowledge, &lt;a href=&#34;http://www.mbio.ncsu.edu/bioedit/bioedit.html&#34;&gt;BioEdit&lt;/a&gt; is the most comprehensive biological sequence alignment editor. Most of my labmates run this software using &lt;code&gt;Parallels Desktop&lt;/code&gt;. For some of them, BioEdit is the only reason to install &lt;code&gt;Parallels Desktop&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I need to edit my alignment recently, and install it in my iMac using &lt;a href=&#34;https://www.winehq.org/&#34;&gt;Wine&lt;/a&gt;, which is a compatibility layer for running Windows applications on POSIX-compliant OS. Although it is famous in Linux community for many years, many OSX users never heard of it.&lt;/p&gt;

&lt;p&gt;I came out with an idea that maybe I can pack all the components into an OSX application bundle. Then I can share it with my labmates and others. I don&amp;rsquo;t need to teach them how to install and config &lt;code&gt;Wine&lt;/code&gt; and they can just drag the App to &lt;code&gt;/Applications&lt;/code&gt; and double click to run it.&lt;/p&gt;

&lt;p&gt;It took me one night to create this App. You can click &lt;a href=&#34;https://gitlab.com/GuangchuangYu/BioEdit-OSX/raw/master/BioEdit.dmg&#34;&gt;here&lt;/a&gt; to download it.&lt;/p&gt;

&lt;p&gt;As usual, you can install it by dragging the App to &lt;code&gt;Applications&lt;/code&gt; folder and open it by double click. It works just like native App.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2016/Screenshot 2016-03-30 11.30.03.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;BTW: If you don&amp;rsquo;t have &lt;a href=&#34;http://xquartz.macosforge.org/&#34;&gt;XQuartz&lt;/a&gt; installed, you need one for running &lt;code&gt;BioEdit&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>embed images in ggplot2 via subview and annotate a phylogenetic tree with images using inset function</title>
      <link>https://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function</link>
      <pubDate>Sun, 20 Mar 2016 10:50:00 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function</guid>
      <description>&lt;p&gt;I extended the &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt; function to support embed image file in a &lt;code&gt;ggplot&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(123)
d = data.frame(x=rnorm(10), y=rnorm(10))

imgfile &amp;lt;- tempfile(, fileext=&amp;quot;.png&amp;quot;)
download.file(&amp;quot;https://avatars1.githubusercontent.com/u/626539?v=3&amp;amp;u=e731426406dd3f45a73d96dd604bc45ae2e7c36f&amp;amp;s=140&amp;quot;,
              destfile=imgfile, mode=&#39;wb&#39;)

p = ggplot(d, aes(x, y))
subview(p, imgfile, x=d$x[1], y=d$y[1]) + geom_point(size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/subview_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/&#34;&gt;previous post&lt;/a&gt;, I have introduced using &lt;code&gt;annotation_image&lt;/code&gt; function for annotating tips with local images.&lt;/p&gt;

&lt;p&gt;Now with the updated &lt;code&gt;subview&lt;/code&gt; function, we can use &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/&#34;&gt;inset&lt;/a&gt; function to annotate nodes/tips with image files and/or subplots.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

img &amp;lt;- list(imgfile, imgfile)
names(img) &amp;lt;- c(&amp;quot;18&amp;quot;, &amp;quot;22&amp;quot;)
inset(p, img)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/inset_with_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;PS: As I got more and more emails from ggtree users, I created a forum, &lt;a href=&#34;https://groups.google.com/forum/#!forum/bioc-ggtree&#34;&gt;https://groups.google.com/forum/#!forum/bioc-ggtree&lt;/a&gt;. With this forum, &lt;code&gt;ggtree&lt;/code&gt; users can help each others and also solutions posted in the forum can help other peoples when they google search their questions. Please join the forum and post your questions if you have any.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Font Awesome supported in emojifont</title>
      <link>https://guangchuangyu.github.io/2016/03/font-awesome-supported-in-emojifont</link>
      <pubDate>Mon, 14 Mar 2016 16:21:11 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/03/font-awesome-supported-in-emojifont</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://cran.r-project.org/package=emojifont&#34;&gt;&lt;img src=&#34;http://www.r-pkg.org/badges/version/emojifont&#34; alt=&#34;CRAN_Status_Badge&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://cran.r-project.org/web/packages/emojifont/index.html&#34;&gt;&lt;code&gt;emojifont&lt;/code&gt;&lt;/a&gt; is available in CRAN, you can use the following command to install it.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;install.packages(&amp;quot;emojifont&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;An example of using emoji font in R plot is showed below:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2016/douban_emoji.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;More examples can be found in &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;the post&lt;/a&gt; and online &lt;a href=&#34;https://cran.r-project.org/web/packages/emojifont/vignettes/emojifont.html&#34;&gt;vignette&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I found &lt;a href=&#34;http://fontawesome.io/cheatsheet/&#34;&gt;FontAwesome&lt;/a&gt; is quite interesting especially in technical world. In &lt;code&gt;emojifont&lt;/code&gt; (version &amp;gt;= 0.3), I have packed the &lt;code&gt;Font Awesome&lt;/code&gt;. So that we can use this fancy font in both base and ggplot2 graphics.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;load.fontawesome()

set.seed(2016-03-09)
fa &amp;lt;- fontawesome(c(&#39;fa-github&#39;, &#39;fa-weibo&#39;, &#39;fa-twitter&#39;, &#39;fa-android&#39;, &#39;fa-coffee&#39;))
d &amp;lt;- data.frame(x=rnorm(20), 
                y=rnorm(20), 
                label=sample(fa, 20, replace=T))

ggplot(d, aes(x, y, color=label)) + 
    geom_text(aes(label=label), family=&#39;fontawesome-webfont&#39;)+
    xlab(NULL)+ylab(NULL)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/fontawesome.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Have fun with &lt;code&gt;emojifont&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/drob&#34;&gt;@drob&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;, this is data surfing (air quality data from Lima, Peru) / fun with your cool pkgs. Thx! &lt;a href=&#34;https://t.co/ikinjxDDZL&#34;&gt;pic.twitter.com/ikinjxDDZL&lt;/a&gt;&lt;/p&gt;&amp;mdash; Maëlle Salmon (@ma_salmon) &lt;a href=&#34;https://twitter.com/ma_salmon/status/706490090609106944&#34;&gt;March 6, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>covplot supports GRangesList</title>
      <link>https://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist</link>
      <pubDate>Mon, 29 Feb 2016 11:45:08 +0800</pubDate>
      
      <guid>https://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist</guid>
      <description>&lt;p&gt;To answer the &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/27&#34;&gt;issue&lt;/a&gt;, I extend the &lt;code&gt;covplot&lt;/code&gt; function to support viewing coverage of a list of &lt;code&gt;GRanges&lt;/code&gt; objects or &lt;code&gt;bed&lt;/code&gt; files.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ChIPseeker)
files &amp;lt;- getSampleFiles()
peak=GenomicRanges::GRangesList(CBX6=readPeakFile(files[[4]]),
                                CBX7=readPeakFile(files[[5]]))

p &amp;lt;- covplot(peak)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ChIPseeker/2016_ChIPseeker_covplot_files/unnamed-chunk-1-2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;By default, The coverage plots are merged together with different colors. Users can separate them to different panels using &lt;code&gt;facet_grid&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
col &amp;lt;- c(CBX6=&#39;red&#39;, CBX7=&#39;green&#39;)
p + facet_grid(chr ~ .id) + scale_color_manual(values=col) + scale_fill_manual(values=col)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ChIPseeker/2016_ChIPseeker_covplot_files/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>