<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ggtree on G. Yu</title>
    <link>http://guangchuangyu.github.io/categories/ggtree/</link>
    <description>Recent content in Ggtree on G. Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Fri, 15 Jan 2016 13:19:00 +0800</lastBuildDate>
    <atom:link href="http://guangchuangyu.github.io/categories/ggtree/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>ggtree supports phylip tree format</title>
      <link>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/</link>
      <pubDate>Fri, 15 Jan 2016 13:19:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/</guid>
      <description>&lt;p&gt;Phylip is also a widely used tree format, which contains taxa sequences with Newick tree text.&lt;/p&gt;

&lt;p&gt;In &lt;code&gt;ggtree&lt;/code&gt;, we can use &lt;code&gt;read.phylip()&lt;/code&gt; function to parse the file and use &lt;code&gt;ggtree()&lt;/code&gt; to visualize the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
phyfile &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.phy&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
phylip &amp;lt;- read.phylip(phyfile)
phylip

## &#39;phylip&#39; S4 object that stored information of
##   &#39;/Users/guangchuangyu/Library/R/3.2/library/ggtree/extdata/sample.phy&#39;.
## 
## ...@ tree: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
##  K, N, D, L, J, G, ...
## 
## Unrooted; no branch lengths.
## 
## with sequence alignment available (15 sequences of length 2148)

ggtree(phylip) + geom_tiplab()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;User can view the sequence alignment with the tree via &lt;code&gt;msaplot()&lt;/code&gt;
function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msaplot(phylip, offset=1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>label edge number in ggtree</title>
      <link>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree/</link>
      <pubDate>Wed, 13 Jan 2016 11:00:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree/</guid>
      <description>&lt;p&gt;This is a question from &lt;code&gt;ggtree&lt;/code&gt; user. In &lt;code&gt;ape&lt;/code&gt; and &lt;code&gt;phytools&lt;/code&gt;, it&amp;rsquo;s easy to label edge using the &lt;code&gt;edgelabels&lt;/code&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(1)
tr = rtree(30)
library(ape)
plot(tr, main=&amp;quot;ape&amp;quot;)
edgelabels()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I don&amp;rsquo;t see any necessity to label edge numbers, as they are meaningless. The number is labeled as the row index of &lt;code&gt;tr$edge&lt;/code&gt;, and edge can be uniquely mapped to child node. If we need to relate something to edge, we can relate them to corresponding child node. Node is a central hub in tree annotation in &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To label edge number, we can also attach the edge number to node and then label them as a node attribute.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
p = ggtree(tr, ladderize=F) + geom_tiplab() + ggtitle(&amp;quot;ggtree&amp;quot;)
edge=data.frame(tr$edge, edge_num=1:nrow(tr$edge))
colnames(edge)=c(&amp;quot;parent&amp;quot;, &amp;quot;node&amp;quot;, &amp;quot;edge_num&amp;quot;)
p %&amp;lt;+% edge + geom_label(aes(x=branch, label=edge_num))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Annotate a phylogenetic tree with insets</title>
      <link>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/</link>
      <pubDate>Mon, 11 Jan 2016 19:36:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/</guid>
      <description>

&lt;p&gt;&lt;code&gt;ggtree&lt;/code&gt; implemented a function, &lt;code&gt;subview&lt;/code&gt;, that can add subplots on a
ggplot2 object. It had successful applied to &lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;plot pie graphs on
map&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2016-01-04)
tr &amp;lt;- rtree(30)
tr &amp;lt;- groupClade(tr, node=45)
p &amp;lt;- ggtree(tr, aes(color=group)) + geom_tippoint()
cpos &amp;lt;- get_clade_position(p, node=45)
p1 &amp;lt;- p + geom_hilight(node=45)
p2 &amp;lt;- with(cpos, p+xlim(xmin, xmax*1.01)+ylim(ymin, ymax))
with(cpos, subview(p2+geom_tiplab(), p1+theme_transparent(), x=xmin+(xmax-xmin)*.15, y=ymin+(ymax-ymin)*.85))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 To make it more easy to use subview function for annotating taxa with
subplots, &lt;em&gt;ggtree&lt;/em&gt; provides a function, &lt;code&gt;inset&lt;/code&gt;, for adding subplots to
a phylogenetic tree. The input is a tree graphic object and a named list
of ggplot graphic objects (can be any kind of charts), these objects
should named by node numbers. To facilitate adding bar and pie charts
(e.g. summarized stats of results from ancestral reconstruction) to
phylogenetic tree, &lt;em&gt;ggtree&lt;/em&gt; provides &lt;code&gt;nodepie&lt;/code&gt; and &lt;code&gt;nodebar&lt;/code&gt; functions
to create a list of pie or bar charts.&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-bar-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with bar charts&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

a &amp;lt;- runif(14, 0, 0.33)
b &amp;lt;- runif(14, 0, 0.33)
c &amp;lt;- runif(14, 0, 0.33)
d &amp;lt;- 1 - a - b - c
dat &amp;lt;- data.frame(a=a, b=b, c=c, d=d)
## input data should have a column of `node` that store the node number
dat$node &amp;lt;- 15+1:14

## cols parameter indicate which columns store stats (a, b, c and d in this example)
bars &amp;lt;- nodebar(dat, cols=1:4)

inset(p, bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 The sizes of the insets can be ajusted by the paramter &lt;em&gt;width&lt;/em&gt; and
&lt;em&gt;height&lt;/em&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, bars, width=.03, height=.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 Users can set the color via the parameter &lt;em&gt;color&lt;/em&gt;. The &lt;em&gt;x&lt;/em&gt; position can
be one of &amp;lsquo;node&amp;rsquo; or &amp;lsquo;branch&amp;rsquo; and can be adjusted by the parameter
&lt;em&gt;hjust&lt;/em&gt; and &lt;em&gt;vjust&lt;/em&gt; for horizontal and vertical adjustment respecitvely.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bars2 &amp;lt;- nodebar(dat, cols=1:4, position=&#39;dodge&#39;,
                 color=c(a=&#39;blue&#39;, b=&#39;red&#39;, c=&#39;green&#39;, d=&#39;cyan&#39;))
p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.3)
print(p2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-pie-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with pie charts&lt;/h2&gt;

&lt;p&gt;Similarly, users can use &lt;code&gt;nodepie&lt;/code&gt; function to generate a list of pie
charts and place these charts to annotate corresponding nodes. Both
&lt;code&gt;nodebar&lt;/code&gt; and &lt;code&gt;nodepie&lt;/code&gt; accepts parameter &lt;em&gt;alpha&lt;/em&gt; to allow transparency.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies &amp;lt;- nodepie(dat, cols=1:4, alpha=.6)
inset(p, pies)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, pies, hjust=-.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-other-types-of-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with other types of charts&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;inset&lt;/code&gt; function accepts a list of ggplot graphic objects and these
input objects are not restricted to pie or bar charts. They can be any
kinds of charts and hybrid of these charts.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies_and_bars &amp;lt;- bars2
pies_and_bars[9:14] &amp;lt;- pies[9:14]
inset(p, pies_and_bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- lapply(1:15, rnorm, n=100)
ylim &amp;lt;- range(unlist(d))
bx &amp;lt;- lapply(d, function(y) {
    dd &amp;lt;- data.frame(y=y)
    ggplot(dd, aes(x=1, y=y))+geom_boxplot() + ylim(ylim) + theme_inset()
})
names(bx) &amp;lt;- 1:15
inset(p, bx, width=.03, height=.1, hjust=-.05)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-9-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After annotating with insets, users can further annotate the tree with
another layer of insets.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.4)
p2 &amp;lt;- inset(p2, pies, x=&#39;branch&#39;, vjust=.4)
bx2 &amp;lt;- lapply(bx, function(g) g+coord_flip())
inset(p2, bx2, width=.2, height=.03, vjust=.04, hjust=p2$data$x[1:15]-4) + xlim(NA, 4.5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-10-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>News of ggtree</title>
      <link>http://guangchuangyu.github.io/2015/12/news-of-ggtree/</link>
      <pubDate>Wed, 30 Dec 2015 14:11:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/news-of-ggtree/</guid>
      <description>

&lt;p&gt;A new version of &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt; that works with ggplot2 (version &amp;gt;= 2.0.0) is now availabel.&lt;/p&gt;

&lt;h2 id=&#34;new-layers:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;new layers&lt;/h2&gt;

&lt;p&gt;Some functions, &lt;em&gt;add_legend&lt;/em&gt;, &lt;em&gt;hilight&lt;/em&gt;, &lt;em&gt;annotation_clade&lt;/em&gt; and &lt;em&gt;annotation_clade2&lt;/em&gt; were removed. Instead we provide layer functions, &lt;code&gt;geom_treescale&lt;/code&gt;, &lt;code&gt;geom_hilight&lt;/code&gt; and &lt;code&gt;geom_cladelabel&lt;/code&gt;. You can use &lt;code&gt;+&lt;/code&gt; operator to add layers using these layer functions.&lt;/p&gt;

&lt;p&gt;In addtion, we provide &lt;code&gt;geom_point2&lt;/code&gt;, &lt;code&gt;geom_text2&lt;/code&gt; and &lt;code&gt;geom_segment2&lt;/code&gt; which works exactly as &lt;code&gt;geom_point&lt;/code&gt;, &lt;code&gt;geom_text&lt;/code&gt; and &lt;code&gt;geom_segment&lt;/code&gt; except they allow ggtree users to do &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;subsetting&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;rescale-tree:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;rescale tree&lt;/h2&gt;

&lt;p&gt;Most of the phylogenetic trees are scaled by evolutionary distance (substitution/site), in &lt;code&gt;ggtree&lt;/code&gt; we can re-scale a phylogenetic tree by any numerical variable inferred by evolutionary analysis. For example using substitution rate to scale a time-scaled tree inferred by BEAST, or using &lt;em&gt;dN/dS&lt;/em&gt; to re-scale a tree analyzed by CodeML.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/Screenshot%202015-12-30%2014.17.34.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;new-hampshire-extended-format-nhx-supported:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;New Hampshire eXtended format (NHX) supported&lt;/h2&gt;

&lt;p&gt;This is a &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/27&#34;&gt;feature request&lt;/a&gt; from &lt;code&gt;ggtree&lt;/code&gt; user. The NHX format is also commonly used in phylogenetic software (e.g. PHYLODOG, RevBayes, &lt;em&gt;etc&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/Screenshot 2015-12-30 14.25.45.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The original vignette was too long and I split them into several short ones. These vignettes should be more easy to follow. You can access the vignette via &lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;. More examples and detail explanation were provided. If there are something that I didn&amp;rsquo;t explain well or if you have suggestions for changes or improvements, &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues&#34;&gt;submit an issue&lt;/a&gt;, or (even better) fork &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt;, make modifications and submit a pull request.
I appreciate your help in improving &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Repo: &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;https://github.com/GuangchuangYu/ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;vignettes

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>use emoji font in R</title>
      <link>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/</link>
      <pubDate>Wed, 16 Dec 2015 11:11:11 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot 2015-12-16 10.55.49.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I have played with emoji in &lt;code&gt;R&lt;/code&gt; for a while. My solution of using it is different from what implemented in &lt;a href=&#34;https://github.com/dill/emoGG/&#34;&gt;emoGG&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;emoGG&lt;/code&gt; is a good attemp to add &lt;code&gt;emoji&lt;/code&gt; in &lt;code&gt;ggplot2&lt;/code&gt;. It render &lt;code&gt;emoji&lt;/code&gt; picture (png) and creat a layer, &lt;code&gt;geom_emoji&lt;/code&gt;, to add emoji.&lt;/p&gt;

&lt;p&gt;In my opinion, &lt;code&gt;emoji&lt;/code&gt; should be treated as ordinary font in user interface, albeit it maynot be true internally.&lt;/p&gt;

&lt;p&gt;It would be more flexible if we can use emoji as ordinary font and in this way user don&amp;rsquo;t need to learn extra stuff.&lt;/p&gt;

&lt;p&gt;I implemented my solution of using &lt;code&gt;emoji&lt;/code&gt; in the R package &lt;a href=&#34;https://github.com/GuangchuangYu/emojifont&#34;&gt;emojifont&lt;/a&gt;. The package is very simple, pack some emoji fonts (currently only &lt;a href=&#34;https://github.com/MorbZ/OpenSansEmoji&#34;&gt;OpenSansEmoji.ttf&lt;/a&gt;) and use &lt;a href=&#34;https://github.com/yixuan/showtext&#34;&gt;showtext&lt;/a&gt; to render the fonts, then we can use the font in either base plot or ggplot2.&lt;/p&gt;

&lt;h1 id=&#34;emojifont:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;emojifont&lt;/h1&gt;

&lt;h2 id=&#34;installation:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Installation&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;devtools::install_github(&amp;quot;GuangchuangYu/emojifont&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;load-emoji-font:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;load Emoji font&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(emojifont)
## list available emoji fonts
list.emojifonts()

## [1] &amp;quot;OpenSansEmoji.ttf&amp;quot;

## load selected emoji font
load.emojifont(&#39;OpenSansEmoji.ttf&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;emoji-characters:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji characters&lt;/h1&gt;

&lt;p&gt;To use &lt;code&gt;emoji&lt;/code&gt;, we need to use their corresponding unicode. Emoji unicode can be found in &lt;a href=&#34;http://apps.timwhitlock.info/emoji/tables/unicode&#34;&gt;http://apps.timwhitlock.info/emoji/tables/unicode&lt;/a&gt;, or searched using &lt;a href=&#34;https://github.com/richfitz/remoji&#34;&gt;remoji&lt;/a&gt; package.&lt;/p&gt;

&lt;h1 id=&#34;emoji-in-r-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji in R plot&lt;/h1&gt;

&lt;h2 id=&#34;base-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;base plot&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(remoji)
set.seed(123)
x &amp;lt;- rnorm(10)
set.seed(321)
y &amp;lt;- rnorm(10)
plot(x, y, cex=0)
text(x, y, labels=emoji(&#39;cow&#39;), cex=1.5, col=&#39;steelblue&#39;, family=&#39;OpenSansEmoji&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/inst/figures/base_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggplot2:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggplot2&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;d &amp;lt;- data.frame(x=x, y=y,
     label = sample(c(emoji(&#39;cow&#39;), emoji(&#39;camel&#39;)), 10, replace=TRUE),
     type = sample(LETTERS[1:3], 10, replace=TRUE))
require(ggplot2)
ggplot(d, aes(x, y, color=type, label=label)) + 
    geom_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/inst/figures/ggplot_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can also use &lt;code&gt;emoji&lt;/code&gt; in title, legend or axis label.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;dd=data.frame(x=emoji(c(&amp;quot;satisfied&amp;quot;, &amp;quot;disapointed&amp;quot;)), y=c(50, 10))
emoji_text=element_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=20)
ggplot(dd, aes(x, y)) + geom_bar(stat=&#39;identity&#39;, aes(fill=x)) + 
     ggtitle(paste(emoji(c(&amp;quot;+1&amp;quot;, &amp;quot;-1&amp;quot;)), collapse=&amp;quot; &amp;quot;))+ 
        theme(axis.text.x = emoji_text, legend.text=emoji_text, title=emoji_text) + 
            xlab(NULL)+ylab(NULL)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot 2015-12-16 11.10.51.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggtree:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggtree&lt;/h2&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;require(ggtree)
require(colorspace)

tree_text=paste0(
    &amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,
       &amp;quot;(&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&amp;quot;cow&amp;quot;), &amp;quot;,&amp;quot;,
               &amp;quot;(&amp;quot;,
                  emoji(&amp;quot;whale&amp;quot;),&amp;quot;,&amp;quot;,
                  emoji(&amp;quot;dolphin&amp;quot;),
               &amp;quot;)&amp;quot;,
            &amp;quot;),&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&#39;pig2&#39;),&amp;quot;,&amp;quot;,
               emoji(&#39;boar&#39;),
            &amp;quot;)&amp;quot;,
       &amp;quot;),&amp;quot;,
       emoji(&amp;quot;camel&amp;quot;),
    &amp;quot;),&amp;quot;, emoji(&amp;quot;fish&amp;quot;), &amp;quot;),&amp;quot;, 
emoji(&amp;quot;seedling&amp;quot;), &amp;quot;);&amp;quot;)

ggtree(read.tree(text=tree_text)) + xlim(NA, 7) +
   geom_tiplab(family=&amp;quot;OpenSansEmoji&amp;quot;, size=10,
               color=rainbow_hcl(8))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/inst/figures/ggtree_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h1 id=&#34;apple-color-emoji:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Apple Color Emoji&lt;/h1&gt;

&lt;p&gt;Although &lt;code&gt;R&lt;/code&gt;&amp;rsquo;s graphical devices don&amp;rsquo;t support &lt;code&gt;AppleColorEmoji&lt;/code&gt; font, it&amp;rsquo;s still possible to use it. We can export the &lt;code&gt;plot&lt;/code&gt; to &lt;code&gt;svg&lt;/code&gt; file and render it in &lt;code&gt;Safari&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-r&#34;&gt;library(gridSVG)
p &amp;lt;-  ggtree(read.tree(text=tree_text), size=2) + geom_tiplab(size=20)
p &amp;lt;- p %&amp;gt;% phylopic(&amp;quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&amp;quot;, color=&amp;quot;firebrick&amp;quot;, alpha = .3)
p &amp;lt;- p + xlim(NA, 7) + ylim(NA, 8.5)
p
ps = grid.export(&amp;quot;emoji.svg&amp;quot;, addClass=T)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/inst/figures/apple_emoji.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>BioC 3.2: NEWS of my BioC packages</title>
      <link>http://guangchuangyu.github.io/2015/10/bioc-3.2-news-of-my-bioc-packages/</link>
      <pubDate>Thu, 15 Oct 2015 16:13:57 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/10/bioc-3.2-news-of-my-bioc-packages/</guid>
      <description>

&lt;p&gt;In BioC 3.2 release, all my packages including
&lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/DOSE.html&#34;&gt;DOSE&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ReactomePA.html&#34;&gt;ReactomePA&lt;/a&gt;,
and &lt;a href=&#34;http://www.bioconductor.org/packages/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt; switch
from Sweave to R Markdown for package vignettes.&lt;/p&gt;

&lt;h3 id=&#34;gosemsim:35c90aeebec9a933fea1dafd42584f96&#34;&gt;GOSemSim&lt;/h3&gt;

&lt;p&gt;To make it consistent between
&lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt; and
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&amp;lsquo;worm&amp;rsquo; was deprecated and instead we should use &amp;lsquo;celegans&amp;rsquo;. As usual,
information content data was updated.&lt;/p&gt;

&lt;h3 id=&#34;clusterprofiler:35c90aeebec9a933fea1dafd42584f96&#34;&gt;clusterProfiler&lt;/h3&gt;

&lt;p&gt;Enrichment results may contains terms that are very general (less
informative) and we do not want to use them. In this release, we provide
&lt;em&gt;dropGO&lt;/em&gt; function that can be used to drop selected GO terms or specific
level of GO terms. It can be applied to output from both &lt;em&gt;enrichGO&lt;/em&gt; and
&lt;em&gt;compareCluster&lt;/em&gt;. This is a feature request from
&lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/26&#34;&gt;@ahorvath&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Another feature request is to visualize GO enrichment result with GO
topology. I implement &lt;em&gt;plotGOgraph&lt;/em&gt; function by extending
&lt;a href=&#34;http://www.bioconductor.org/packages/topGO&#34;&gt;topGO&lt;/a&gt; to support output of
both &lt;em&gt;enrichGO&lt;/em&gt; or &lt;em&gt;gseGO&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/06/dotplot-for-enrichment-result/&#34;&gt;dotplot&lt;/a&gt;&lt;/em&gt;
is another feature request and was implemented in
&lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt; as a general function
for visualize enrichment result.
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
import this function.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;merge_result&lt;/em&gt; function was implemented for merging enrichment results
and then the results can be visualized simultaneously for comparison.
This function was developed for comparing &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-for-gtex-paper/&#34;&gt;functional enrichment of GTEx
paper&lt;/a&gt;.
An example of comparing results from
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
and DAVID can be found in
&lt;a href=&#34;https://github.com/GuangchuangYu/enrichment4GTEx_clusterProfiler/blob/master/GO_BP.md&#34;&gt;github&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A section &amp;lsquo;Functional analysis of NGS data&amp;rsquo; was added in the vignette.
&lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;The blog
post&lt;/a&gt;
illustrated using &lt;em&gt;enricher&lt;/em&gt; and &lt;em&gt;GSEA&lt;/em&gt; function to analyze user defined
annotation.&lt;/p&gt;

&lt;h3 id=&#34;dose:35c90aeebec9a933fea1dafd42584f96&#34;&gt;DOSE&lt;/h3&gt;

&lt;p&gt;Network of Cancer Genes data was updated to version 4.9.0, contributed
by &lt;a href=&#34;https://github.com/GuangchuangYu/DOSE/pull/8&#34;&gt;@dalloliogm&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;dotplot&lt;/em&gt; function was implemented for visualizing enrichment result and
was imported to
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
and &lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;With new release of ChIPseeker, DOSE can be applied to &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-analysis-with-ngs-data/&#34;&gt;NGS
data&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Several bugs were removed and small improvement were incorporated.&lt;/p&gt;

&lt;h3 id=&#34;reactomepa:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ReactomePA&lt;/h3&gt;

&lt;p&gt;Now fly (Drosophila melanogaster) is supported.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;viewPathway&lt;/em&gt; supports other organisms, which was contributed by
&lt;a href=&#34;https://github.com/GuangchuangYu/ReactomePA/pull/1&#34;&gt;@vladpetyuk&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Import &lt;em&gt;dotplot&lt;/em&gt; from DOSE and add &amp;lsquo;Pathway analysis of NGS data&amp;rsquo;
section in vignette.&lt;/p&gt;

&lt;h3 id=&#34;chipseeker:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ChIPseeker&lt;/h3&gt;

&lt;p&gt;Implement
&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-analysis-with-ngs-data/&#34;&gt;seq2gene&lt;/a&gt;&lt;/em&gt;
function for linking genomic regions to genes by many-to-many mapping.
With this function, enrichment analysis of
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt; and
&lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt; can be
applied to NGS data.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/07/upsetplot-in-chipseeker/&#34;&gt;upsetplot&lt;/a&gt;
function is implemented for viewing overlap of ChIP annotation.&lt;/p&gt;

&lt;p&gt;Better implementation of internal function &lt;em&gt;getFirstHitIndex&lt;/em&gt;
contributed by
&lt;a href=&#34;https://support.bioconductor.org/p/70432/#70545&#34;&gt;@hpages&lt;/a&gt;. Now
annotating a BED file of size about 1GB only take several minutes.&lt;/p&gt;

&lt;p&gt;An issue of BED file that using &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/parsing-bed-coordinates/&#34;&gt;the 0-based coordinate
system&lt;/a&gt; was fixed.&lt;/p&gt;

&lt;p&gt;GEO data information was updated, now ChIPseeker contains more than
18,000 BED file information. User can compare their own data with those
deposited in GEO to &lt;a href=&#34;http://guangchuangyu.github.io/2015/10/chipseq-data-mining-with-chipseeker/&#34;&gt;identify co-occurrence binding
proteins&lt;/a&gt;
that maybe cooperated with the one we are interested in.&lt;/p&gt;

&lt;h3 id=&#34;ggtree:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ggtree&lt;/h3&gt;

&lt;p&gt;My major focus in the past half year is on developing
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;.
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; has a lot of
changes. Some of the updates can be found in &lt;a href=&#34;http://bioconductor.org/help/newsletters/2015_October/&#34;&gt;Bioconductor
Newsletter&lt;/a&gt;
(Oct. 2015). In addition, I would like to emphasize the
&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt;&lt;/em&gt; function which works
fine with all the ggplot objects and was applied to &lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;plot pie graph on a
map&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; can be fun by
using &lt;a href=&#34;http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/&#34;&gt;symbolic fonts&lt;/a&gt;, &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/&#34;&gt;cartoonize the tree&lt;/a&gt;
or annotating the tree &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;with
emoji&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are many updates that based on the github version of ggplot2.
Since the new features of ggplot2 are currently not available in CRAN. I
do not commit the change to Bioconductor and will introduce these new
feature to ggtree user when new version of ggplot2 is available in CRAN.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>subsetting data in ggtree</title>
      <link>http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/</link>
      <pubDate>Thu, 24 Sep 2015 01:20:21 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/</guid>
      <description>&lt;p&gt;Subsetting is commonly used in ggtree as we would like to for example
separating internal nodes from tips. We may also want to display
annotation to specific node(s)/tip(s).&lt;/p&gt;

&lt;p&gt;Some software may stored clade information (e.g. bootstrap value) as
internal node labels. Indeed we want to manipulate such information and
taxa labels separately.&lt;/p&gt;

&lt;p&gt;In current ggplot2 (version=1.0.1, access date:2015-09-23), it support
&lt;em&gt;subset&lt;/em&gt;. For instance:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;library(ggplot2)
library(ggtree)
tree=read.tree(text=&amp;quot;((A:2,B:2)95:2,(C:2,D:2)100:2);&amp;quot;)
ggtree(tree) + geom_text(aes(label=label), subset=.(!isTip), hjust=-.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But this feature was removed in github version of ggplot2 and will not
be available in next release.&lt;/p&gt;

&lt;p&gt;In github version of ggtree, we implemented geom_text2, geom_point2,
and geom_segment2, that works exactly like geom_text, geom_point and
geom_segment respectively with &lt;em&gt;subset&lt;/em&gt; supported. The syntax is
slightly different.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;ggtree(tree) + geom_text2(aes(label=label, subset=!isTip), hjust=-.2) +
        geom_point2(aes(subset=!isTip), color=&amp;quot;red&amp;quot;, size=3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/subsetting.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Note: The example was from the discussion of &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/13&#34;&gt;github
issue&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>comic phylogenetic tree with ggtree and comicR</title>
      <link>http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/</link>
      <pubDate>Tue, 08 Sep 2015 01:15:26 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
applies the concepts of grammar of graphic in phylogenetic tree
presentation and make it easy to add multiple layers of text and even
figures above a ðŸŒ².&lt;/p&gt;

&lt;p&gt;Here, I cartoonize a phylogenetic tree generated by
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
with &lt;a href=&#34;https://github.com/timelyportfolio/comicR&#34;&gt;comicR&lt;/a&gt;, which is a
funny package to generate comic (xkcd-like) graph in R. Have fun with
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
and &lt;a href=&#34;https://github.com/timelyportfolio/comicR&#34;&gt;comicR&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;library(htmltools)
library(XML)
library(gridSVG)
library(comicR)

library(ggplot2)
library(ggtree)

p &amp;lt;- ggtree(rtree(30), layout=&amp;quot;fan&amp;quot;)  + 
   geom_text(aes(label=label, angle=angle), size=5, color=&amp;quot;purple&amp;quot;, vjust=-0.3)


p
svg &amp;lt;- grid.export(name=&amp;quot;&amp;quot;)$svg
tagList(
      tags$div(
        id = &amp;quot;ggtree_comic&amp;quot;,
        tags$style(&amp;quot;#ggtree_comic text {font-family:Chalkduster;}&amp;quot;),
        HTML(saveXML(svg)),
        comicR(&amp;quot;#ggtree_comic&amp;quot;, ff=5)
      )
    ) %&amp;gt;% html_print
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/98dbdcdbbb0e7fdb174fc1f40c611aeba2ee2bc5/Bioconductor/ggtree/comicTree.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>subview</title>
      <link>http://guangchuangyu.github.io/2015/08/subview/</link>
      <pubDate>Mon, 31 Aug 2015 03:17:48 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/08/subview/</guid>
      <description>&lt;p&gt;I implemented a function, &lt;em&gt;subview&lt;/em&gt;, in
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
that make it easy to embed a subplot in ggplot.&lt;/p&gt;

&lt;p&gt;An example is shown below:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;library(ggplot2)
library(ggtree)

dd &amp;lt;- data.frame(x=LETTERS[1:3], y=1:3)
pie &amp;lt;- ggplot(dd, aes(x=1, y, fill=x)) + 
             geom_bar(stat=&amp;quot;identity&amp;quot;, width=1) + 
                    coord_polar(theta=&amp;quot;y&amp;quot;) + theme_tree() + 
                          xlab(NULL) + ylab(NULL) + 
                               theme_transparent()

x &amp;lt;- sample(2:9)
y &amp;lt;- sample(2:9)
width &amp;lt;- sample(seq(0.05, 0.15, length.out=length(x)))
height &amp;lt;- width

p &amp;lt;- ggplot(data=data.frame(x=c(0, 10), y=c(0, 10)), aes(x, y))+geom_blank()
print(p)
for (i in seq_along(x)) {
    p %&amp;lt;&amp;gt;% subview(pie, x[i], y[i], width[i], height[i])
    print(p)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/subview.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;With this function, we can plot a specific clade and add a subplot of
the whole topology; we can also add relative statistic graph above the
tree or to a specific node. It&amp;rsquo;s not specific to phylogenetic tree, it
works with all ggplot objects as demonstrated in the example.&lt;/p&gt;

&lt;p&gt;PS: &lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; is now
presented in &lt;a href=&#34;https://cran.r-project.org/web/views/Phylogenetics.html&#34;&gt;CRAN Task View:
Phylogenetics&lt;/a&gt;.
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/taskview_cran.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;AND get its first citation.
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/Screenshot%202015-08-04%2021.49.27.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree annotate phylogenetic tree with local images</title>
      <link>http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/</link>
      <pubDate>Sat, 01 Aug 2015 12:52:34 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/Screenshot%202015-08-01%2020.53.50.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;,
we provide a function &lt;em&gt;annotation_image&lt;/em&gt; for annotating phylogenetic
tree with images.&lt;/p&gt;

&lt;p&gt;To demonstrate the usage, I created a tree view from a random tree as
shown below:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;set.seed(2015-08-01)
p &amp;lt;- ggtree(rtree(10)) + xlim(0, 5)+ ylim(0, 11)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We need a &lt;em&gt;data.frame&lt;/em&gt; that contains information of taxa labels and
image paths. Here I created such a &lt;em&gt;data.frame&lt;/em&gt; containing image files
downloaded from phylopic.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;&amp;gt; img_info
  V1                                           V2
1 t1 25f165fa-f279-4f7c-9869-c55be251ffb8.512.png
2 t2 5d7ab302-960b-4db7-9dfd-215175a55906.512.png
3 t3 6fbe723c-3a6b-4d06-8680-bb2a52113df4.512.png
4 t4 d83c02ca-76ed-436b-83ae-7f98d7297be9.512.png
5 t5 ee764929-c865-44f6-b5db-b4e7d5693d1a.512.png
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Annotating tree with images is simple in
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; by using
&lt;em&gt;annotation_image&lt;/em&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;annotation_image(p, img_info)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;By default, all the images will align to the right hand side. We can use
&lt;em&gt;align=FALSE&lt;/em&gt;, to disable it.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;annotation_image(p, img_info, align=FALSE)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can change the type and size of lines, as demonstrated below:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;annotation_image(p, img_info, linetype=&amp;quot;dashed&amp;quot;, linesize=0.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The width of the images were controlled by width parameter, and the
height will automatically determined by image dimension.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;annotation_image(p, img_info, width = .2, linetype=&amp;quot;dashed&amp;quot;, linesize=0.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In the following example, we add tip labels to the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;p &amp;lt;- p+geom_tiplab(align=TRUE, linetype=&amp;quot;dashed&amp;quot;, linesize=.2)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If we also want to add the image and align them, we don&amp;rsquo;t want to show
the line added by &lt;em&gt;annotation_image&lt;/em&gt; function. This can be achieved by
setting &lt;em&gt;linetype=NULL&lt;/em&gt;. By default the images and tip labels will be
overlapped, we can move the images by &lt;em&gt;offset&lt;/em&gt; parameter.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;p %&amp;gt;% annotation_image(img_info, width=.2, linetype=NULL, offset=.3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/annotation_image/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>flip and rotate branches in ggtree</title>
      <link>http://guangchuangyu.github.io/2015/07/flip-and-rotate-branches-in-ggtree/</link>
      <pubDate>Wed, 01 Jul 2015 02:51:34 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/07/flip-and-rotate-branches-in-ggtree/</guid>
      <description>&lt;p&gt;&lt;strong&gt;&lt;em&gt;flip&lt;/em&gt;&lt;/strong&gt; function is a feature request from ggtree user. It accepts a
tree view and two node numbers and exchange the positions of the
selected clades.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;require(ggtree)
set.seed(2015-07-01)
tr &amp;lt;- rtree(30)
p &amp;lt;- ggtree(tr) + geom_text(aes(label=node))
gridExtra::grid.arrange(p, flip(p, 38, 33), ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/flip_1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s chainable and all possible position adjustment can be achieved via
multiple flip operations.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;flip(p, 38, 33) %&amp;gt;% flip(53, 58) %&amp;gt;% flip(32, 51)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/Bioconductor/ggtree/flip_animation.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s tedious to rotate a clade by 180 degree with several flip
operations, ggtree provides another function &lt;strong&gt;&lt;em&gt;rotate&lt;/em&gt;&lt;/strong&gt; that accepts a
selected node and rotate that branch by 180 degree.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;col = c(&amp;quot;black&amp;quot;, &amp;quot;firebrick&amp;quot;, &amp;quot;steelblue&amp;quot;)[groupClade(tr, c(33, 52))]
gridExtra::grid.arrange(ggtree(tr, color=col), 
                        ggtree(tr, color=col) %&amp;gt;% rotate(33) %&amp;gt;% rotate(52), 
                        ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/45fc101df9b7c711643fdb641d76f6822ad031a8/Bioconductor/ggtree/rotate.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree with funny fonts</title>
      <link>http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/</link>
      <pubDate>Fri, 12 Jun 2015 06:19:56 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://cran.r-project.org/web/packages/showtext/index.html&#34;&gt;showtext&lt;/a&gt;
is a neat solution to use various types of fonts in R graphs and make it
easy to use funny fonts. With
&lt;a href=&#34;http://cran.r-project.org/web/packages/showtext/index.html&#34;&gt;showtext&lt;/a&gt;,
we can draw phylogenetic tree with different types of fonts even with
symbolic/icon fonts.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;require(showtext)

font.add.google(&amp;quot;Gochi Hand&amp;quot;, &amp;quot;gochi&amp;quot;)
font.add.google(&amp;quot;Rock Salt&amp;quot;, &amp;quot;rock&amp;quot;)

link = &amp;quot;http://img.dafont.com/dl/?f=wm_people_1&amp;quot;;
download.file(link, &amp;quot;wmpeople1.zip&amp;quot;, mode = &amp;quot;wb&amp;quot;);
unzip(&amp;quot;wmpeople1.zip&amp;quot;);
font.add(&amp;quot;wmpeople1&amp;quot;, &amp;quot;wmpeople1.TTF&amp;quot;);

link = &amp;quot;http://img.dafont.com/dl/?f=emoticons&amp;quot;;
download.file(link, &amp;quot;emoticons.zip&amp;quot;, mode = &amp;quot;wb&amp;quot;);
unzip(&amp;quot;emoticons.zip&amp;quot;);
font.add(&amp;quot;emoticons&amp;quot;, &amp;quot;emoticons.ttf&amp;quot;);


showtext.auto()
set.seed(2015-05-14)

library(ggplot2)
library(ggtree)

tree &amp;lt;- rtree(30)
ggtree(tree, color=&amp;quot;darkgreen&amp;quot;) + geom_tiplab(family=&amp;quot;gochi&amp;quot;) + theme_classic() +
    theme(axis.text.x=element_text(size=rel(4), family=&amp;quot;emoticons&amp;quot;, color=&amp;quot;firebrick&amp;quot;)) +
        scale_y_continuous(breaks=seq(0, 30, 4), labels=letters[c(12:17, 20, 21)]) +
            theme(axis.text.y=element_text(size=rel(4), family=&amp;quot;wmpeople1&amp;quot;, color=&amp;quot;#FDAC4F&amp;quot;)) +
                annotate(&amp;quot;text&amp;quot;, x=2, y=18, label=&amp;quot;Have fun with ggtree!&amp;quot;,
                         family=&amp;quot;rock&amp;quot;, angle=30, size=12, color=&amp;quot;steelblue&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/f6217cb7815a824b0a273e6f5147f01a9ebb367a/Bioconductor/ggtree/ggtree_funny_font.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;download.file(&amp;quot;http://dl.dafont.com/dl/?f=people_freak&amp;quot;, &amp;quot;people_freak.zip&amp;quot;, mode=&amp;quot;wb&amp;quot;)
unzip(&amp;quot;people_freak.zip&amp;quot;)
font.add(&amp;quot;people_freak&amp;quot;, &amp;quot;People_freak.ttf&amp;quot;)
ggtree(rtree(10)) + geom_text(aes(label=node, color=isTip), family=&amp;quot;people_freak&amp;quot;, hjust=0) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/524ea41306f6d9a93251eaf9e193a264e5d4dbd4/Bioconductor/ggtree/ggtree_funny_font2.png&#34; alt=&#34;&#34; /&gt;
Funny fonts can be downloaded from
&lt;a href=&#34;http://www.dafont.com/search.php?q=icon&#34;&gt;1&lt;/a&gt;,
&lt;a href=&#34;http://www.dafont.com/search.php?q=people&#34;&gt;2&lt;/a&gt; and
&lt;a href=&#34;http://www.fontspace.com/category/people&#34;&gt;3&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Bioc 3.1: NEWS of my BioC packages</title>
      <link>http://guangchuangyu.github.io/2015/04/bioc-3.1-news-of-my-bioc-packages/</link>
      <pubDate>Mon, 20 Apr 2015 11:44:01 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/04/bioc-3.1-news-of-my-bioc-packages/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot%202015-03-12%2019.05.54.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;gosemsim:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;GOSemSim&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;www.bioconductor.org/packages/release/bioc/html/GOSemSim.html&#34;&gt;GOSemSim&lt;/a&gt;
was first implemented in &lt;a href=&#34;http://guangchuangyu.github.io/2008/08/gosemsim/&#34;&gt;2008&lt;/a&gt;
and published in
&lt;a href=&#34;http://bioinformatics.oxfordjournals.org/content/26/7/976&#34;&gt;Bioinformatics&lt;/a&gt;
in 2010. It&amp;rsquo;s now a mature package with no bugs found in the past half
year. Only vignette and Information content data were updated.
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/a9ed4c29e8f66c07de917937694d7f43933d4fe5/Bioconductor/GOSemSim/gosemsim_stats.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;clusterprofiler:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;clusterProfiler&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;www.bioconductor.org/packages/release/bioc/html/clusterProfiler.html&#34;&gt;clusterProfiler&lt;/a&gt;
was developed in
&lt;a href=&#34;http://guangchuangyu.github.io/2011/03/clusterprofiler-in-bioconductor-2.8/&#34;&gt;2011&lt;/a&gt; and
published in
&lt;a href=&#34;http://online.liebertpub.com/doi/abs/10.1089/omi.2011.0118&#34;&gt;OMICS&lt;/a&gt; in
2012. I am very glad to find that
&lt;a href=&#34;www.bioconductor.org/packages/release/bioc/html/clusterProfiler.html&#34;&gt;clusterProfiler&lt;/a&gt;
was presented in the book &amp;lsquo;&lt;a href=&#34;https://www.safaribooksonline.com/library/view/bioinformatics-with-r/9781783283132/ch02s08.html&#34;&gt;Bioinformatics with R
Cookbook&lt;/a&gt;&amp;lsquo;:
In this release, KEGG enrichment analysis (both hypergeometric and GSEA)
now supports &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;using latest online
data&lt;/a&gt;
and &lt;a href=&#34;http://guangchuangyu.github.io/2015/03/david-functional-analysis-with-clusterprofiler/&#34;&gt;DAVID functional
analysis&lt;/a&gt;
is also supported. In addition, compareCluster function now supports
&lt;a href=&#34;http://bioinfoblog.it/2015/02/a-formula-interface-for-geneontology-analysis/&#34;&gt;formula
interface&lt;/a&gt;
like x ~ y + z; this feature was contributed by
&lt;a href=&#34;https://twitter.com/dalloliogm&#34;&gt;@dalloliogm&lt;/a&gt;. Considering that many new
users have problem of converting biological IDs,
&lt;a href=&#34;www.bioconductor.org/packages/release/bioc/html/clusterProfiler.html&#34;&gt;clusterProfiler&lt;/a&gt;
contains a new function &lt;em&gt;bitr&lt;/em&gt;, stands for Biological Id TranslatoR.
NOW,
&lt;a href=&#34;www.bioconductor.org/packages/release/bioc/html/clusterProfiler.html&#34;&gt;clusterProfiler&lt;/a&gt;
is not restricted to GO and KEGG analyses. All kinds of annotation can
be supported via &lt;em&gt;enricher&lt;/em&gt; function for hypergeometric test and &lt;em&gt;GSEA&lt;/em&gt;
function for gene set enrichment analysis. These two functions are not
yet documented in vignette and will soon.&lt;/p&gt;

&lt;h3 id=&#34;dose:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;DOSE&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/DOSE.html&#34;&gt;DOSE&lt;/a&gt;
was first released in
&lt;a href=&#34;http://guangchuangyu.github.io/2011/06/r-package-dose-released/&#34;&gt;2011&lt;/a&gt;, and has been
published in
&lt;a href=&#34;http://bioinformatics.oxfordjournals.org/cgi/content/abstract/btu684&#34;&gt;Bioinformatics&lt;/a&gt;
on February 2015. An example of applying DOSE for disease ontology
enrichment analysis can be found in &lt;a href=&#34;http://www.sciencedirect.com/science/article/pii/S0002929714002626&#34;&gt;Genome-wide Identification and
Characterization of Fixed Human-Specific Regulatory
Regions&lt;/a&gt;.
Besides,
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/DOSE.html&#34;&gt;DOSE&lt;/a&gt;
also supports &lt;a href=&#34;http://bioinfoblog.it/2015/04/ncg-enrichment-implemented-in-dose/&#34;&gt;Network of Cancer Genes
database&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;reactomepa:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;ReactomePA&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ReactomePA.html&#34;&gt;ReactomePA&lt;/a&gt;
was developed in 2012 when KEGG is no longer available in public domain.
In BioC 3.0, reactome.db has &lt;a href=&#34;https://support.bioconductor.org/p/63024/&#34;&gt;a lot of
issues&lt;/a&gt;. Until the early of
this April, Bioconductor restored reactome.db in Bioc 3.0 to Bioc 2.14.
This issue affects ReactomePA several months and was removed in BioC
3.1.&lt;/p&gt;

&lt;h3 id=&#34;chipseeker:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;ChIPseeker&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ChIPseeker.html&#34;&gt;ChIPseeker&lt;/a&gt;
was developed in
&lt;a href=&#34;http://guangchuangyu.github.io/2014/04/chipseeker-for-chip-peak-annotation/&#34;&gt;2014&lt;/a&gt;,
after I found a &lt;a href=&#34;http://guangchuangyu.github.io/2014/01/bug-of-r-package-chippeakanno/&#34;&gt;bug of
ChIPpeakAnno&lt;/a&gt;
package. Many new features were added thereafter, including &lt;a href=&#34;http://guangchuangyu.github.io/2014/04/visualization-methods-in-chipseeker/&#34;&gt;several
visualization
methods&lt;/a&gt;,
&lt;a href=&#34;http://guangchuangyu.github.io/2014/10/multiple-annotation-in-chipseeker/&#34;&gt;multiple
annotations&lt;/a&gt;,
ChIP-peak comparison and data mining with GEO database. ChIPseeker has
been published in
&lt;a href=&#34;http://bioinformatics.oxfordjournals.org/cgi/content/abstract/btv145&#34;&gt;Bioinformatics&lt;/a&gt;.
In this release, several minor bugs were fixed, a new parameter
&lt;em&gt;genomicAnnotationPriority&lt;/em&gt; was added in &lt;em&gt;annotatePeak&lt;/em&gt; and
&lt;em&gt;plotAvgProf&lt;/em&gt; supports estimating confidence interval as shown below:
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/dd399ab1d2287d0c7fee1009abf3b1b95553c73a/2015/Screenshot%202015-03-30%2020.09.44.png&#34; alt=&#34;&#34; /&gt;
This CI estimation feature was contributed by &lt;a href=&#34;https://github.com/Puriney&#34;&gt;Yan
Yun&lt;/a&gt;.
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ChIPseeker.html&#34;&gt;ChIPseeker&lt;/a&gt;
works fine with other ChIP-seq related tools as demonstrated in the
&lt;a href=&#34;http://compbio.ucdenver.edu/Hunter_lab/Phang/resources/Tzu-Software/ChIPseq.Analysis.html&#34;&gt;ChIPseq Analysis
workflow&lt;/a&gt;.
It has also been presented in &lt;a href=&#34;http://physiology.med.cornell.edu/faculty/elemento/lab/data/courses/2014/CSHLseq/ChIP-seq.pdf&#34;&gt;2014 CSHLseq
course&lt;/a&gt;
and &lt;a href=&#34;https://github.com/Bioconductor/UseBioconductor/blob/master/vignettes/F_ChIPSeq.Rmd&#34;&gt;2015 Use Bioconductor
course&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;ggtree:d7b2a91b2c7afdf12777a4b5cd75c8f0&#34;&gt;ggtree&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.27.27.png&#34; alt=&#34;&#34; /&gt;
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
was developed on &lt;a href=&#34;http://guangchuangyu.github.io/2014/12/viewing-and-annotating-phylogenetic-tree-with-ggtree/&#34;&gt;December 2014&lt;/a&gt;,
when I got tired of annotating tree by modifying node labels. This
release (version=1.0.0) is the first release, output of many common
software in evolution were supported and many new features were
introduced in the past few months. Please view the
&lt;a href=&#34;http://www.bioconductor.org/packages/3.1/bioc/vignettes/ggtree/inst/doc/ggtree.html&#34;&gt;vignette&lt;/a&gt;
to find out more and I can guarantee that you won&amp;rsquo;t be disappointed.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree updating a tree view using %&lt;% operator</title>
      <link>http://guangchuangyu.github.io/2015/02/ggtree-updating-a-tree-view-using--operator/</link>
      <pubDate>Tue, 10 Feb 2015 02:58:23 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/02/ggtree-updating-a-tree-view-using--operator/</guid>
      <description>&lt;p&gt;I am very exciting that I have received very positive feedback from
&lt;a href=&#34;https://twitter.com/AhmedMoustafa&#34;&gt;Ahmed Moustafa&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/sdwfrost&#34;&gt;Simon
Frost&lt;/a&gt;.
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.27.27.png&#34; alt=&#34;&#34; /&gt;
&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.27.07.png&#34; alt=&#34;&#34; /&gt;
&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt; now has equipped with
a lot of new features. This time, I would like to introduce the replace
operator, &lt;code&gt;%&amp;lt;%&lt;/code&gt;. Suppose we have build a tree view using ggtree with
multiple layers, we don&amp;rsquo;t need to run the code again to build a new tree
view with another tree. In
&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt;, we provides an
operator, &lt;code&gt;%&amp;lt;%&lt;/code&gt;, for updating tree view.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;library(ggplot2)
library(ggtree)
ggtree(rtree(15)) %&amp;lt;% rtree(30)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.22.07.png&#34; alt=&#34;&#34; /&gt;
It supports different layout.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;ggtree(rtree(15), layout=&amp;quot;unrooted&amp;quot;, ladderize=FALSE) %&amp;lt;% rtree(45)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.23.48.png&#34; alt=&#34;&#34; /&gt;
It is chainable.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;ggtree(rtree(15), layout=&amp;quot;cladogram&amp;quot;, ladderize=FALSE) %&amp;lt;% 
    rtree(30) %&amp;lt;% 
       rtree(45)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.23.14.png&#34; alt=&#34;&#34; /&gt;
It also supports multiple layers.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;(ggtree(rtree(15), layout=&amp;quot;fan&amp;quot;) + 
    geom_point(aes(shape=isTip, color=isTip))) %&amp;lt;% 
      rtree(40)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.25.31.png&#34; alt=&#34;&#34; /&gt;
In the final example, we parse rst file from BaseML output and annotate
the tree with marginal_AA_subs.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Baseml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tipfas &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;pa.fas&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
rst &amp;lt;- read.paml_rst(rstfile, tipfas)

p &amp;lt;- plot(rst, annotation=&amp;quot;marginal_AA_subs&amp;quot;, annotation.color=&amp;quot;steelblue&amp;quot;)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.51.17.png&#34; alt=&#34;&#34; /&gt;
We have ancestral sequences inferred from CodeML with the same tree. We
can use this new data to update the tree view.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Codeml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
rst &amp;lt;- read.paml_rst(rstfile, tipfas)
p %&amp;lt;% rst
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2015/Screenshot-2015-02-10-10.53.41.png&#34; alt=&#34;&#34; /&gt;
In these two figures, we can found that they have different evolution
distances, and substitutions inferred from BASEML and CODEML are
slightly different.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree in Bioconductor 3.1</title>
      <link>http://guangchuangyu.github.io/2015/01/ggtree-in-bioconductor-3.1/</link>
      <pubDate>Mon, 19 Jan 2015 03:50:23 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/01/ggtree-in-bioconductor-3.1/</guid>
      <description>&lt;p&gt;I am very glad that &lt;a href=&#34;http://guangchuangyu.github.io/2014/12/ggtree/&#34;&gt;ggtree&lt;/a&gt; is now
available via Bioconductor. This is my 6th Bioconductor package.
&lt;a href=&#34;http://guangchuangyu.github.io/2014/12/ggtree/&#34;&gt;ggtree&lt;/a&gt; now supports parsing output
files from BEAST, PAML, HYPHY, EPA and PPLACER and can annotate
phylogenetic tree directly using plot methods. Now you can use the
following
&lt;a href=&#34;http://guangchuangyu.github.io/2014/12/ggtree/&#34;&gt;command&lt;/a&gt; to
install ggtree:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-lang=&amp;quot;rsplus&amp;quot;&#34;&gt;install.packages(&amp;quot;ggtree&amp;quot;,
                 repos = &amp;quot;http://www.bioconductor.org/packages/devel/bioc&amp;quot;,
                 type  = &amp;quot;source&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Find out more at
&lt;a href=&#34;http://www.bioconductor.org/packages/3.1/bioc/html/ggtree.html&#34;&gt;http://www.bioconductor.org/packages/3.1/bioc/html/ggtree.html&lt;/a&gt; and
check out the vignette,
&lt;a href=&#34;http://www.bioconductor.org/packages/3.1/bioc/vignettes/ggtree/inst/doc/ggtree.html&#34;&gt;http://www.bioconductor.org/packages/3.1/bioc/vignettes/ggtree/inst/doc/ggtree.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>