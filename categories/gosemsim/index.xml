<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Gosemsim on G. Yu</title>
    <link>http://guangchuangyu.github.io/categories/gosemsim/</link>
    <description>Recent content in Gosemsim on G. Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 23 Nov 2014 02:27:23 +0800</lastBuildDate>
    <atom:link href="http://guangchuangyu.github.io/categories/gosemsim/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>proper use of GOSemSim</title>
      <link>http://guangchuangyu.github.io/2014/11/proper-use-of-gosemsim/</link>
      <pubDate>Sun, 23 Nov 2014 02:27:23 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2014/11/proper-use-of-gosemsim/</guid>
      <description>&lt;p&gt;One day, I am looking for R packages that can analyze PPI and after
searching, I found the
&lt;a href=&#34;http://cran.r-project.org/web/packages/ppiPre/index.html&#34;&gt;ppiPre&lt;/a&gt;
package in CRAN.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/master/2014/11/2014-11-22-215959_895x256_scrot.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The function of this package is not impressive, and I already knew some
related works, including &lt;a href=&#34;http://intscore.molgen.mpg.de/&#34;&gt;http://intscore.molgen.mpg.de/&lt;/a&gt;. The authors
of this webserver contacted me for the usages of GOSemSim when they
developing it. What makes me curious is that the
&lt;a href=&#34;http://cran.r-project.org/web/packages/ppiPre/index.html&#34;&gt;ppiPre&lt;/a&gt;
package can calculate GO semantic similarity and supports 20 species
exactly like GOSemSim. I opened the source tarball, and surprisingly
found that its sources related to semantic similarity calculation are
totally copied from GOSemSim.&lt;/p&gt;

&lt;p&gt;GOSemSim was &lt;a href=&#34;http://guangchuangyu.github.io/2008/08/gosemsim/&#34;&gt;firstly released in 2008 Bioconductor
2.4&lt;/a&gt; (at that time, devel version)
and published in &lt;a href=&#34;http://guangchuangyu.github.io/2010/05/gosemsim-an-r-package-for-measuring-semantic-similarity-among-go-terms-and-gene-products/&#34;&gt;Bioinformatics in
2010&lt;/a&gt;.
After compared the sources, I found the sources in ppiPre were copied
from &lt;a href=&#34;http://www.bioconductor.org/packages/2.6/bioc/html/GOSemSim.html&#34;&gt;GOSemSim version
1.6.8&lt;/a&gt;
which released in 2010 Bioconductor 2.6. The Wang method defined in
GOKEGGSims.r file of ppiPre is:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   119  WangMethod &amp;lt;- function(GOID1, GOID2, ont=&amp;quot;MF&amp;quot;, organism=&amp;quot;yeast&amp;quot;) {
   120      if(!exists(&amp;quot;ppiPreEnv&amp;quot;)) .initial()
   121      weight.isa = 0.8
   122      weight.partof = 0.6
   123
   124      if (GOID1 == GOID2)
   125          return (1)
   126
   127      Parents.name &amp;lt;- switch(ont,
   128          MF = &amp;quot;MFParents&amp;quot;,
   129          BP = &amp;quot;BPParents&amp;quot;,
   130          CC = &amp;quot;CCParents&amp;quot;
   131      )
   132      if (!exists(Parents.name, envir=ppiPreEnv)) {
   133          GetGOParents(ont)
   134      }
   135      Parents &amp;lt;- get(Parents.name, envir=ppiPreEnv)
   136
   137      sv.a &amp;lt;- 1
   138      sv.b &amp;lt;- 1
   139      sw &amp;lt;- 1
   140      names(sv.a) &amp;lt;- GOID1
   141      names(sv.b) &amp;lt;- GOID2
   142
   143      sv.a &amp;lt;- WangSemVal(GOID1, ont, Parents, sv.a, sw, weight.isa, weight.partof)
   144      sv.b &amp;lt;- WangSemVal(GOID2, ont, Parents, sv.b, sw, weight.isa, weight.partof)
   145
   146      sv.a &amp;lt;- uniqsv(sv.a)
   147      sv.b &amp;lt;- uniqsv(sv.b)
   148
   149      idx &amp;lt;- intersect(names(sv.a), names(sv.b))
   150      inter.sva &amp;lt;- unlist(sv.a[idx])
   151      inter.svb &amp;lt;- unlist(sv.b[idx])
   152      sim &amp;lt;- sum(inter.sva,inter.svb) / sum(sv.a, sv.b)
   153      return(sim)
   154  }
   155  WangSemVal &amp;lt;- function(goid, ont, Parents, sv, w, weight.isa, weight.partof) {
   156      if(!exists(&amp;quot;ppiPreCache&amp;quot;))
   157          return(WangSemVal_internal(goid, ont, Parents, sv, w, weight.isa, weight.partof))
   158      goid.ont &amp;lt;- paste(goid, ont, sep=&amp;quot;.&amp;quot;)
   159      if (!exists(goid.ont, envir=ppiPreCache)) {
   160          value &amp;lt;- WangSemVal_internal(goid, ont, Parents, sv, w, weight.isa, weight.partof)
   161          assign(eval(goid.ont), value, envir=ppiPreCache)
   162      }
   163      return(get(goid.ont, envir=ppiPreCache))
   164  }
   165
   166  WangSemVal_internal &amp;lt;- function(goid, ont, Parents, sv, w, weight.isa, weight.partof) {
   167      p &amp;lt;- Parents[goid]
   168      p &amp;lt;- unlist(p[[1]])
   169      if (length(p) == 0) {
   170          return(0)
   171      }
   172      relations &amp;lt;- names(p)
   173      old.w &amp;lt;- w
   174      for (i in 1:length(p)) {
   175          if (relations[i] == &amp;quot;is_a&amp;quot;) {
   176              w &amp;lt;- old.w * weight.isa
   177          } else {
   178              w &amp;lt;- old.w * weight.partof
   179          }
   180          names(w) &amp;lt;- p[i]
   181          sv &amp;lt;- c(sv,w)
   182          if (p[i] != &amp;quot;all&amp;quot;) {
   183              sv &amp;lt;- WangSemVal_internal(p[i], ont, Parents, sv, w, weight.isa, weight.partof)
   184          }
   185      }
   186      return (sv)
   187  }
   188
   189  uniqsv &amp;lt;- function(sv) {
   190      sv &amp;lt;- unlist(sv)
   191      una &amp;lt;- unique(names(sv))
   192      sv &amp;lt;- unlist(sapply(una, function(x) {max(sv[names(sv)==x])}))
   193      return (sv)
   194  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It is identical to the one I defined in GOSemSim 1.6.8:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   196  ygcWangMethod &amp;lt;- function(GOID1, GOID2, ont=&amp;quot;MF&amp;quot;, organism=&amp;quot;human&amp;quot;) {
   197      if(!exists(&amp;quot;GOSemSimEnv&amp;quot;)) .initial()
   198      weight.isa = 0.8
   199      weight.partof = 0.6
   200
   201      if (GOID1 == GOID2)
   202          return (gosim=1)
   203
   204      Parents.name &amp;lt;- switch(ont,
   205          MF = &amp;quot;MFParents&amp;quot;,
   206          BP = &amp;quot;BPParents&amp;quot;,
   207          CC = &amp;quot;CCParents&amp;quot;
   208      )
   209      if (!exists(Parents.name, envir=GOSemSimEnv)) {
   210          ygcGetParents(ont)
   211      }
   212      Parents &amp;lt;- get(Parents.name, envir=GOSemSimEnv)
   213
   214      sv.a &amp;lt;- 1
   215      sv.b &amp;lt;- 1
   216      sw &amp;lt;- 1
   217      names(sv.a) &amp;lt;- GOID1
   218      names(sv.b) &amp;lt;- GOID2
   219
   220      sv.a &amp;lt;- ygcSemVal(GOID1, ont, Parents, sv.a, sw, weight.isa, weight.partof)
   221      sv.b &amp;lt;- ygcSemVal(GOID2, ont, Parents, sv.b, sw, weight.isa, weight.partof)
   222
   223      sv.a &amp;lt;- uniqsv(sv.a)
   224      sv.b &amp;lt;- uniqsv(sv.b)
   225
   226      idx &amp;lt;- intersect(names(sv.a), names(sv.b))
   227      inter.sva &amp;lt;- unlist(sv.a[idx])
   228      inter.svb &amp;lt;- unlist(sv.b[idx])
   229      sim &amp;lt;- sum(inter.sva,inter.svb) / sum(sv.a, sv.b)
   230      return(sim)
   231  }
   232
   233
   234
   235  uniqsv &amp;lt;- function(sv) {
   236      sv &amp;lt;- unlist(sv)
   237      una &amp;lt;- unique(names(sv))
   238      sv &amp;lt;- unlist(sapply(una, function(x) {max(sv[names(sv)==x])}))
   239      return (sv)
   240  }
   241
   242  ygcSemVal_internal &amp;lt;- function(goid, ont, Parents, sv, w, weight.isa, weight.partof) {
   243      p &amp;lt;- Parents[goid]
   244      p &amp;lt;- unlist(p[[1]])
   245      if (length(p) == 0) {
   246          #warning(goid, &amp;quot; may not belong to Ontology &amp;quot;, ont)
   247          return(0)
   248      }
   249      relations &amp;lt;- names(p)
   250      old.w &amp;lt;- w
   251      for (i in 1:length(p)) {
   252          if (relations[i] == &amp;quot;is_a&amp;quot;) {
   253              w &amp;lt;- old.w * weight.isa
   254          } else {
   255              w &amp;lt;- old.w * weight.partof
   256          }
   257          names(w) &amp;lt;- p[i]
   258          sv &amp;lt;- c(sv,w)
   259          if (p[i] != &amp;quot;all&amp;quot;) {
   260              sv &amp;lt;- ygcSemVal_internal(p[i], ont, Parents, sv, w, weight.isa, weight.partof)
   261          }
   262      }
   263      return (sv)
   264  }
   265
   266  ygcSemVal &amp;lt;- function(goid, ont, Parents, sv, w, weight.isa, weight.partof) {
   267      if(!exists(&amp;quot;GOSemSimCache&amp;quot;)) return(ygcSemVal_internal(goid, ont, Parents, sv, w, weight.isa, weight.partof))
   268      goid.ont &amp;lt;- paste(goid, ont, sep=&amp;quot;.&amp;quot;)
   269      if (!exists(goid.ont, envir=GOSemSimCache)) {
   270          value &amp;lt;- ygcSemVal_internal(goid, ont, Parents, sv, w, weight.isa, weight.partof)
   271          assign(goid.ont, value, envir=GOSemSimCache)
   272          #cat(&amp;quot;recompute &amp;quot;, goid, value, &amp;quot;\n&amp;quot;)
   273      }
   274      else{
   275          #cat(&amp;quot;cache &amp;quot;, goid, get(goid, envir=GOSemSimCache), &amp;quot;\n&amp;quot;)
   276      }
   277      return(get(goid.ont, envir=GOSemSimCache))
   278  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The information content based method in ppiPre:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   495  GetLatestCommonAncestor&amp;lt;-function(GOID1, GOID2, ont, organism){
   496  #message(&amp;quot;Calulating Latest Common Ancestor...&amp;quot;)
   497      if(!exists(&amp;quot;ppiPreEnv&amp;quot;)) .initial()
   498
   499      fname &amp;lt;- paste(&amp;quot;Info_Contents&amp;quot;, ont, organism, sep=&amp;quot;_&amp;quot;)
   500      tryCatch(utils::data(list=fname, package=&amp;quot;ppiPre&amp;quot;, envir=ppiPreEnv))
   501      InfoContents &amp;lt;- get(&amp;quot;IC&amp;quot;, envir=ppiPreEnv)
   502
   503      rootCount &amp;lt;- max(InfoContents[InfoContents != Inf])
   504      InfoContents[&amp;quot;all&amp;quot;] = 0
   505      p1 &amp;lt;- InfoContents[GOID1]/rootCount
   506      p2 &amp;lt;- InfoContents[GOID2]/rootCount
   507      if(is.na(p1) || is.na(p2)) return (NA)
   508      if (p1 == 0 || p2 == 0) return (NA)
   509      Ancestor.name &amp;lt;- switch(ont,MF = &amp;quot;MFAncestors&amp;quot;,BP = &amp;quot;BPAncestors&amp;quot;,CC = &amp;quot;CCAncestors&amp;quot;)
   510      if (!exists(Ancestor.name, envir=ppiPreEnv)) {
   511          TCSSGetAncestors(ont)
   512      }
   513
   514      Ancestor &amp;lt;- get(Ancestor.name, envir=ppiPreEnv)
   515      ancestor1 &amp;lt;- unlist(Ancestor[GOID1])
   516      ancestor2 &amp;lt;- unlist(Ancestor[GOID2])
   517      if (GOID1 == GOID2) {
   518          commonAncestor &amp;lt;- GOID1
   519      } else if (GOID1 %in% ancestor2) {
   520          commonAncestor &amp;lt;- GOID1
   521      } else if (GOID2 %in% ancestor1) {
   522          commonAncestor &amp;lt;- GOID2
   523      } else {
   524          commonAncestor &amp;lt;- intersect(ancestor1, ancestor2)
   525      }
   526      if (length(commonAncestor) == 0)
   527          LCA&amp;lt;-NULL
   528      max&amp;lt;- -100
   529      LCA&amp;lt;-NULL
   530      for(a in commonAncestor){
   531          if(!is.na(InfoContents[a])) {
   532              if(InfoContents[a]&amp;gt;max){
   533                  max&amp;lt;-InfoContents[a]
   534                  LCA&amp;lt;-a
   535              }
   536          }
   537      }
   538  #message(&amp;quot;done...&amp;quot;)
   539      return (LCA)
   540
   541  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;also identical to the one in GOSemSim 1.6.8:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   280  `ygcInfoContentMethod` &amp;lt;- function(GOID1, GOID2, ont, measure, organism) {
   281      if(!exists(&amp;quot;GOSemSimEnv&amp;quot;)) .initial()
   282      fname &amp;lt;- paste(&amp;quot;Info_Contents&amp;quot;, ont, organism, sep=&amp;quot;_&amp;quot;)
   283      tryCatch(utils::data(list=fname, package=&amp;quot;GOSemSim&amp;quot;, envir=GOSemSimEnv))
   284      Info.contents &amp;lt;- get(&amp;quot;IC&amp;quot;, envir=GOSemSimEnv)
   285
   286      rootCount &amp;lt;- max(Info.contents[Info.contents != Inf])
   287      Info.contents[&amp;quot;all&amp;quot;] = 0
   288      p1 &amp;lt;- Info.contents[GOID1]/rootCount
   289      p2 &amp;lt;- Info.contents[GOID2]/rootCount
   290
   291      if (p1 == 0 || p2 == 0) return (NA)
   292      Ancestor.name &amp;lt;- switch(ont,
   293          MF = &amp;quot;MFAncestors&amp;quot;,
   294          BP = &amp;quot;BPAncestors&amp;quot;,
   295          CC = &amp;quot;CCAncestors&amp;quot;
   296      )
   297      if (!exists(Ancestor.name, envir=GOSemSimEnv)) {
   298          ygcGetAncestors(ont)
   299      }
   300
   301      Ancestor &amp;lt;- get(Ancestor.name, envir=GOSemSimEnv)
   302      ancestor1 &amp;lt;- unlist(Ancestor[GOID1])
   303      ancestor2 &amp;lt;- unlist(Ancestor[GOID2])
   304      if (GOID1 == GOID2) {
   305          commonAncestor &amp;lt;- GOID1
   306      } else if (GOID1 %in% ancestor2) {
   307          commonAncestor &amp;lt;- GOID1
   308      } else if (GOID2 %in% ancestor1) {
   309          commonAncestor &amp;lt;- GOID2
   310      } else {
   311          commonAncestor &amp;lt;- intersect(ancestor1, ancestor2)
   312      }
   313      if (length(commonAncestor) == 0) return (NA)
   314      pms &amp;lt;- max(Info.contents[commonAncestor], na.rm=TRUE)/rootCount
   315      sim&amp;lt;-switch(measure,
   316          Resnik = pms,
   317          Lin = pms/(p1+p2),
   318          Jiang = 1 - min(1, -2*pms + p1 + p2),
   319          Rel = 2*pms/(p1+p2)*(1-exp(-pms*rootCount))
   320      )
   321      return (sim)
   322  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;rsquo;s look at some helper functions in ppiPre:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   477  rebuildICdata &amp;lt;- function(){
   478      ont &amp;lt;- c(&amp;quot;MF&amp;quot;,&amp;quot;CC&amp;quot;, &amp;quot;BP&amp;quot;)
   479      species &amp;lt;- c(&amp;quot;human&amp;quot;, &amp;quot;rat&amp;quot;, &amp;quot;mouse&amp;quot;, &amp;quot;fly&amp;quot;, &amp;quot;yeast&amp;quot;, &amp;quot;zebrafish&amp;quot;, &amp;quot;arabidopsis&amp;quot;,&amp;quot;worm&amp;quot;, &amp;quot;ecolik12&amp;quot;, &amp;quot;bovine&amp;quot;,&amp;quot;canine&amp;quot;,&amp;quot;anopheles&amp;quot;,&amp;quot;ecsakai&amp;quot;,&amp;quot;chicken&amp;quot;,&amp;quot;chimp&amp;quot;,&amp;quot;malaria&amp;quot;,&amp;quot;rhesus&amp;quot;,&amp;quot;pig&amp;quot;,&amp;quot;xenopus&amp;quot;,&amp;quot;coelicolor&amp;quot;)
   480      cat(&amp;quot;------------------------------------\n&amp;quot;)
   481      cat(&amp;quot;calulating Information Content...\nSpecies:\t\tOntology\n&amp;quot;)
   482      for (i in ont) {
   483          for (j in species) {
   484              cat(j)
   485              cat(&amp;quot;\t\t\t&amp;quot;)
   486              cat(i)
   487              cat(&amp;quot;\n&amp;quot;)
   488              TCSSComputeIC(ont=i, organism=j)
   489          }
   490      }
   491      cat(&amp;quot;------------------------------------\n&amp;quot;)
   492      message(&amp;quot;done...&amp;quot;)
   493  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Again, it is identical to GOSemSim 1.6.8:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   390  rebuildICdata &amp;lt;- function(){
   391      ont &amp;lt;- c(&amp;quot;MF&amp;quot;,&amp;quot;CC&amp;quot;, &amp;quot;BP&amp;quot;)
   392      species &amp;lt;- c(&amp;quot;human&amp;quot;, &amp;quot;rat&amp;quot;, &amp;quot;mouse&amp;quot;, &amp;quot;fly&amp;quot;, &amp;quot;yeast&amp;quot;, &amp;quot;zebrafish&amp;quot;, &amp;quot;arabidopsis&amp;quot;,&amp;quot;worm&amp;quot;, &amp;quot;ecolik12&amp;quot;, &amp;quot;bovine&amp;quot;,&amp;quot;canine&amp;quot;,&amp;quot;anopheles&amp;quot;,&amp;quot;ecsakai&amp;quot;,&amp;quot;chicken&amp;quot;,&amp;quot;chimp&amp;quot;,&amp;quot;malaria&amp;quot;,&amp;quot;rhesus&amp;quot;,&amp;quot;pig&amp;quot;,&amp;quot;xenopus&amp;quot;)
   393      cat(&amp;quot;------------------------------------\n&amp;quot;)
   394      cat(&amp;quot;calulating Information Content...\nSpecies:\t\tOntology\n&amp;quot;)
   395      for (i in ont) {
   396          for (j in species) {
   397              cat(j)
   398              cat(&amp;quot;\t\t\t&amp;quot;)
   399              cat(i)
   400              cat(&amp;quot;\n&amp;quot;)
   401              ygcCompute_Information_Content(ont=i, organism=j)
   402          }
   403      }
   404      cat(&amp;quot;------------------------------------\n&amp;quot;)
   405      print(&amp;quot;done...&amp;quot;)
   406  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;rsquo;s look at the internal function TCSSComputeIC in ppiPre:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   410  TCSSComputeIC &amp;lt;- function(dropCodes=&amp;quot;IEA&amp;quot;, ont, organism) {
   411  message(&amp;quot;Calulating IC...&amp;quot;)
   412      wh_ont &amp;lt;- match.arg(ont, c(&amp;quot;MF&amp;quot;, &amp;quot;BP&amp;quot;, &amp;quot;CC&amp;quot;))
   413      wh_organism &amp;lt;- match.arg(organism, c(&amp;quot;human&amp;quot;, &amp;quot;fly&amp;quot;, &amp;quot;mouse&amp;quot;, &amp;quot;rat&amp;quot;, &amp;quot;yeast&amp;quot;, &amp;quot;zebrafish&amp;quot;, &amp;quot;worm&amp;quot;, &amp;quot;arabidopsis&amp;quot;, &amp;quot;ecolik12&amp;quot;, &amp;quot;bovine&amp;quot;,&amp;quot;canine&amp;quot;,&amp;quot;anopheles&amp;quot;,&amp;quot;ecsakai&amp;quot;,&amp;quot;chicken&amp;quot;,&amp;quot;chimp&amp;quot;,&amp;quot;malaria&amp;quot;,&amp;quot;rhesus&amp;quot;,&amp;quot;pig&amp;quot;,&amp;quot;xenopus&amp;quot;, &amp;quot;coelicolor&amp;quot;))
   414      CheckAnnotationPackage(wh_organism)
   415      gomap &amp;lt;- switch(organism,
   416          human = org.Hs.egGO,
   417          fly = org.Dm.egGO,
   418          mouse = org.Mm.egGO,
   419          rat = org.Rn.egGO,
   420          yeast = org.Sc.sgdGO,
   421          zebrafish = org.Dr.egGO,
   422          worm = org.Ce.egGO,
   423          arabidopsis = org.At.tairGO,
   424          ecoli = org.EcK12.egGO,
   425          bovine  = org.Bt.egGO,
   426          canine  = org.Cf.egGO,
   427          anopheles   =   org.Ag.egGO,
   428          ecsakai =   org.EcSakai.egGO,
   429          chicken =   org.Gg.egGO,
   430          chimp   =   org.Pt.egGO,
   431          malaria =   org.Pf.plasmoGO,
   432          rhesus  =   org.Mmu.egGO,
   433          pig = org.Ss.egGO,
   434          xenopus =   org.Xl.egGO,
   435          coelicolor  =   org.Sco.egGO
   436      )
   437
   438      mapped_genes &amp;lt;- mappedkeys(gomap)
   439      gomap = AnnotationDbi::as.list(gomap[mapped_genes])
   440      if (!is.null(dropCodes)){
   441          gomap&amp;lt;-sapply(gomap,function(x) sapply(x,function(y) c(y$Evidence %in% dropCodes, y$Ontology %in% wh_ont)))
   442          gomap&amp;lt;-sapply(gomap, function(x) x[2,x[1,]==&amp;quot;FALSE&amp;quot;])
   443          gomap&amp;lt;-gomap[sapply(gomap,length) &amp;gt;0]
   444      }else {
   445          gomap &amp;lt;- sapply(gomap,function(x) sapply(x,function(y) y$Ontology %in% wh_ont))
   446      }
   447
   448      goterms&amp;lt;-unlist(sapply(gomap, function(x) names(x)), use.names=FALSE) # all GO terms appearing in an annotation
   449      goids &amp;lt;- toTable(GOTERM)
   450
   451      goids &amp;lt;- unique(goids[goids[,&amp;quot;Ontology&amp;quot;] == wh_ont, &amp;quot;go_id&amp;quot;])
   452      gocount &amp;lt;- table(goterms)
   453      goname &amp;lt;- names(gocount) #goid of specific organism and selected category.
   454
   455      go.diff &amp;lt;- setdiff(goids, goname)
   456      m &amp;lt;- double(length(go.diff))
   457      names(m) &amp;lt;- go.diff
   458      gocount &amp;lt;- as.vector(gocount)
   459      names(gocount) &amp;lt;- goname
   460      gocount &amp;lt;- c(gocount, m)
   461
   462      Offsprings.name &amp;lt;- switch(wh_ont,
   463          MF = &amp;quot;MFOffsprings&amp;quot;,
   464          BP = &amp;quot;BPOffsprings&amp;quot;,
   465          CC = &amp;quot;CCOffsprings&amp;quot;
   466      )
   467      if (!exists(Offsprings.name, envir=ppiPreEnv)) {
   468          TCSSGetOffsprings(wh_ont)
   469      }
   470      Offsprings &amp;lt;- get(Offsprings.name, envir=ppiPreEnv)
   471      cnt &amp;lt;- sapply(goids,function(x){ c=gocount[unlist(Offsprings[x])]; gocount[x]+sum(c[!is.na(c)])})
   472      names(cnt) &amp;lt;- goids
   473      IC&amp;lt;- -log(cnt/sum(gocount))
   474  message(&amp;quot;done...&amp;quot;)
   475      return (IC)
   476  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and ygcCompute_Information_Content in GOSemSim 1.6.8:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   326  ygcCompute_Information_Content &amp;lt;- function(dropCodes=&amp;quot;NULL&amp;quot;, ont, organism) {
   327      wh_ont &amp;lt;- match.arg(ont, c(&amp;quot;MF&amp;quot;, &amp;quot;BP&amp;quot;, &amp;quot;CC&amp;quot;))
   328      wh_organism &amp;lt;- match.arg(organism, c(&amp;quot;human&amp;quot;, &amp;quot;fly&amp;quot;, &amp;quot;mouse&amp;quot;, &amp;quot;rat&amp;quot;, &amp;quot;yeast&amp;quot;, &amp;quot;zebrafish&amp;quot;, &amp;quot;worm&amp;quot;, &amp;quot;arabidopsis&amp;quot;, &amp;quot;ecolik12&amp;quot;, &amp;quot;bovine&amp;quot;,&amp;quot;canine&amp;quot;,&amp;quot;anopheles&amp;quot;,&amp;quot;ecsakai&amp;quot;,&amp;quot;chicken&amp;quot;,&amp;quot;chimp&amp;quot;,&amp;quot;malaria&amp;quot;,&amp;quot;rhesus&amp;quot;,&amp;quot;pig&amp;quot;,&amp;quot;xenopus&amp;quot;))
   329      ygcCheckAnnotationPackage(wh_organism)
   330      gomap &amp;lt;- switch(wh_organism,
   331          human = org.Hs.egGO,
   332          fly = org.Dm.egGO,
   333          mouse = org.Mm.egGO,
   334          rat = org.Rn.egGO,
   335          yeast = org.Sc.sgdGO,
   336          zebrafish = org.Dr.egGO,
   337          worm = org.Ce.egGO,
   338          arabidopsis = org.At.tairGO,
   339          ecolik12 = org.EcK12.egGO,
   340          bovine  = org.Bt.egGO,
   341          canine  = org.Cf.egGO,
   342          anopheles   =   org.Ag.egGO,
   343          ecsakai =   org.EcSakai.egGO,
   344          chicken =   org.Gg.egGO,
   345          chimp   =   org.Pt.egGO,
   346          malaria =   org.Pf.plasmoGO,
   347          rhesus  =   org.Mmu.egGO,
   348          pig = org.Ss.egGO,
   349          xenopus =   org.Xl.egGO
   350      )
   351      mapped_genes &amp;lt;- mappedkeys(gomap)
   352      gomap = AnnotationDbi::as.list(gomap[mapped_genes])
   353      if (!is.null(dropCodes)){
   354          gomap&amp;lt;-sapply(gomap,function(x) sapply(x,function(y) c(y$Evidence %in% dropCodes, y$Ontology %in% wh_ont)))
   355          gomap&amp;lt;-sapply(gomap, function(x) x[2,x[1,]==&amp;quot;FALSE&amp;quot;])
   356          gomap&amp;lt;-gomap[sapply(gomap,length) &amp;gt;0]
   357      }else {
   358          gomap &amp;lt;- sapply(gomap,function(x) sapply(x,function(y) y$Ontology %in% wh_ont))
   359      }
   360
   361      goterms&amp;lt;-unlist(sapply(gomap, function(x) names(x)), use.names=FALSE) # all GO terms appearing in an annotation
   362      goids &amp;lt;- toTable(GOTERM)
   363      # all go terms which belong to the corresponding category..
   364      goids &amp;lt;- unique(goids[goids[,&amp;quot;Ontology&amp;quot;] == wh_ont, &amp;quot;go_id&amp;quot;])
   365      gocount &amp;lt;- table(goterms)
   366      goname &amp;lt;- names(gocount) #goid of specific organism and selected category.
   367      ## ensure goterms not appearing in the specific annotation have 0 frequency..
   368      go.diff &amp;lt;- setdiff(goids, goname)
   369      m &amp;lt;- double(length(go.diff))
   370      names(m) &amp;lt;- go.diff
   371      gocount &amp;lt;- as.vector(gocount)
   372      names(gocount) &amp;lt;- goname
   373      gocount &amp;lt;- c(gocount, m)
   374
   375      Offsprings.name &amp;lt;- switch(wh_ont,
   376          MF = &amp;quot;MFOffsprings&amp;quot;,
   377          BP = &amp;quot;BPOffsprings&amp;quot;,
   378          CC = &amp;quot;CCOffsprings&amp;quot;
   379      )
   380      if (!exists(Offsprings.name, envir=GOSemSimEnv)) {
   381          ygcGetOffsprings(wh_ont)
   382      }
   383      Offsprings &amp;lt;- get(Offsprings.name, envir=GOSemSimEnv)
   384      cnt &amp;lt;- sapply(goids,function(x){ c=gocount[unlist(Offsprings[x])]; gocount[x]+sum(c[!is.na(c)])})
   385      names(cnt) &amp;lt;- goids
   386      IC&amp;lt;- -log(cnt/sum(gocount))
   387      save(IC, file=paste(paste(&amp;quot;Info_Contents&amp;quot;, wh_ont, organism, sep=&amp;quot;_&amp;quot;), &amp;quot;.rda&amp;quot;, sep=&amp;quot;&amp;quot;))
   388  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Another helper function GetGOMap in ppiPre:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   308  GetGOMap &amp;lt;- function(organism=&amp;quot;yeast&amp;quot;) {
   309      if(!exists(&amp;quot;ppiPreEnv&amp;quot;)) .initial()
   310      CheckAnnotationPackage(organism) #download and install the packages
   311      species &amp;lt;- switch(organism,
   312          human = &amp;quot;Hs&amp;quot;,
   313          fly = &amp;quot;Dm&amp;quot;,
   314          mouse = &amp;quot;Mm&amp;quot;,
   315          rat = &amp;quot;Rn&amp;quot;,
   316          yeast = &amp;quot;Sc&amp;quot;,
   317          zebrafish = &amp;quot;Dr&amp;quot;,
   318          worm = &amp;quot;Ce&amp;quot;,
   319          arabidopsis = &amp;quot;At&amp;quot;,
   320          ecolik12 = &amp;quot;EcK12&amp;quot;,
   321          bovine  = &amp;quot;Bt&amp;quot;,
   322          canine  = &amp;quot;Cf&amp;quot;,
   323          anopheles   =   &amp;quot;Ag&amp;quot;,
   324          ecsakai =   &amp;quot;EcSakai&amp;quot;,
   325          chicken =   &amp;quot;Gg&amp;quot;,
   326          chimp   =   &amp;quot;Pt&amp;quot;,
   327          malaria =   &amp;quot;Pf&amp;quot;,
   328          rhesus  =   &amp;quot;Mmu&amp;quot;,
   329          pig = &amp;quot;Ss&amp;quot;,
   330          xenopus =   &amp;quot;Xl&amp;quot;,
   331          coelicolor  =   &amp;quot;Sco&amp;quot;
   332      )
   333
   334      gomap &amp;lt;- switch(organism,
   335          human = org.Hs.egGO,
   336          fly = org.Dm.egGO,
   337          mouse = org.Mm.egGO,
   338          rat = org.Rn.egGO,
   339          yeast = org.Sc.sgdGO,
   340          zebrafish = org.Dr.egGO,
   341          worm = org.Ce.egGO,
   342          arabidopsis = org.At.tairGO,
   343          ecoli = org.EcK12.egGO,
   344          bovine  = org.Bt.egGO,
   345          canine  = org.Cf.egGO,
   346          anopheles   =   org.Ag.egGO,
   347          ecsakai =   org.EcSakai.egGO,
   348          chicken =   org.Gg.egGO,
   349          chimp   =   org.Pt.egGO,
   350          malaria =   org.Pf.plasmoGO,
   351          rhesus  =   org.Mmu.egGO,
   352          pig = org.Ss.egGO,
   353          xenopus =   org.Xl.egGO,
   354          coelicolor  =   org.Sco.egGO
   355      )
   356
   357      assign(eval(species), gomap, envir=ppiPreEnv)
   358  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;My ygcGetGOMap in GOSemSim 1.6.8:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;   100  ygcGetGOMap &amp;lt;- function(organism=&amp;quot;human&amp;quot;) {
   101      if(!exists(&amp;quot;GOSemSimEnv&amp;quot;)) .initial()
   102      ygcCheckAnnotationPackage(organism)
   103      species &amp;lt;- switch(organism,
   104          human = &amp;quot;Hs&amp;quot;,
   105          fly = &amp;quot;Dm&amp;quot;,
   106          mouse = &amp;quot;Mm&amp;quot;,
   107          rat = &amp;quot;Rn&amp;quot;,
   108          yeast = &amp;quot;Sc&amp;quot;,
   109          zebrafish = &amp;quot;Dr&amp;quot;,
   110          worm = &amp;quot;Ce&amp;quot;,
   111          arabidopsis = &amp;quot;At&amp;quot;,
   112          ecolik12 = &amp;quot;EcK12&amp;quot;,
   113          bovine  = &amp;quot;Bt&amp;quot;,
   114          canine  = &amp;quot;Cf&amp;quot;,
   115          anopheles   =   &amp;quot;Ag&amp;quot;,
   116          ecsakai =   &amp;quot;EcSakai&amp;quot;,
   117          chicken =   &amp;quot;Gg&amp;quot;,
   118          chimp   =   &amp;quot;Pt&amp;quot;,
   119          malaria =   &amp;quot;Pf&amp;quot;,
   120          rhesus  =   &amp;quot;Mmu&amp;quot;,
   121          pig = &amp;quot;Ss&amp;quot;,
   122          xenopus =   &amp;quot;Xl&amp;quot;
   123      )
   124      gomap &amp;lt;- switch(organism,
   125          human = org.Hs.egGO,
   126          fly = org.Dm.egGO,
   127          mouse = org.Mm.egGO,
   128          rat = org.Rn.egGO,
   129          yeast = org.Sc.sgdGO,
   130          zebrafish = org.Dr.egGO,
   131          worm = org.Ce.egGO,
   132          arabidopsis = org.At.tairGO,
   133          ecolik12 = org.EcK12.egGO,
   134          bovine  = org.Bt.egGO,
   135          canine  = org.Cf.egGO,
   136          anopheles   =   org.Ag.egGO,
   137          ecsakai =   org.EcSakai.egGO,
   138          chicken =   org.Gg.egGO,
   139          chimp   =   org.Pt.egGO,
   140          malaria =   org.Pf.plasmoGO,
   141          rhesus  =   org.Mmu.egGO,
   142          pig = org.Ss.egGO,
   143          xenopus =   org.Xl.egGO
   144      )
   145      assign(eval(species), gomap, envir=GOSemSimEnv)
   146  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There are many other small helper functions that are identical. ppiPre
copy most of the source code of GOSemSim. There is 862 lines in
GOKEGGSims.r, in which only the following function is about KEGG that is
not related to GOSemSim.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    10  KEGGSim &amp;lt;- function(protein1, protein2)    # KEGG-based similarity of two proteins
    11  {
    12
    13    if(!require(&amp;quot;KEGG.db&amp;quot;)){ stop(&amp;quot;package KEGG.db is needed.&amp;quot;)}
    14    Pathway1 &amp;lt;- KEGG.db::KEGGEXTID2PATHID[[protein1]]
    15      Pathway2 &amp;lt;- KEGG.db::KEGGEXTID2PATHID[[protein2]]
    16      intersec &amp;lt;- length(na.omit(match(Pathway1, Pathway2)))
    17      if(intersec==0)
    18          sim&amp;lt;-0
    19      else
    20          sim&amp;lt;-intersec/(length(Pathway1)+length(Pathway2)-intersec)
    21      return(sim)
    22  }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This function is only 12 lines, and it calculates the similarity by
divide the intersect to the total sum. The other lines in GOKEGGSims.r,
more than 800 lines, were totally copied from GOSemSim. Other source
files in the ppiPre only has less than 450 lines in sum. &lt;strong&gt;About &lt;sup&gt;2&lt;/sup&gt;&amp;frasl;&lt;sub&gt;3&lt;/sub&gt; of
ppiPre were copied from GOSemSim&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;The author of ppiPre changed the function names and pretend it is their
original works. They just copy and paste and take the credit of months
of development of GOSemSim. This is really sucks.&lt;/p&gt;

&lt;p&gt;After I found this issue, I add a proper use of GOSemSim statement in
its &lt;a href=&#34;https://github.com/GuangchuangYu/GOSemSim&#34;&gt;github page&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-style=&amp;quot;word-wrap: break-word; white-space: pre-wrap; white-space: -moz-pre-wrap&amp;quot;&#34;&gt;I am very glad that many people find GOSemSim useful and GOSemSim has been cited by 114 (by google scholar, Aug, 2014).

There are two R packages BiSEp and tRanslatome depend on GOSemSim and three R packages clusterProfiler, DOSE and Rcpi import GOSemSim.

SemDist package copy some of the source code from GOSemSim with acknowledging within source code and document.

ppiPre package copy many source code from GOSemSim without any acknowledgement in souce code or document and did not cited GOSemSim in their publication. This violates the restriction of open source license.

For R developers, if you found functions provided in GOSemSim useful, please depends or imports GOSemSim. If you would like to copy and paste source code, you should acknowledge the source code was copied/derived from GOSemSim authored by Guangchuang Yu guangchuangyu@gmail.com within source code, add GOSemSim in Suggests field and also includes the following reference in the man files for functions that copied/derived from GOSemSim and cited in vignettes.

\references{
  Yu et al. (2010) GOSemSim: an R package for measuring
  semantic similarity among GO terms and gene products
  \emph{Bioinformatics} (Oxford, England), 26:7 976--978,
  April 2010. ISSN 1367-4803
  \url{http://bioinformatics.oxfordjournals.org/cgi/content/abstract/26/7/976}
  PMID: 20179076
}

You are welcome to use GOSemSim in the way you like, but please cite it and give it the proper credit. I hope you can understand.
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>GOSemSim an R package for measuring semantic similarity among GO terms and gene products</title>
      <link>http://guangchuangyu.github.io/2010/05/gosemsim-an-r-package-for-measuring-semantic-similarity-among-go-terms-and-gene-products/</link>
      <pubDate>Fri, 28 May 2010 05:06:26 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2010/05/gosemsim-an-r-package-for-measuring-semantic-similarity-among-go-terms-and-gene-products/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://www.ncbi.nlm.nih.gov/pubmed/20179076&#34;&gt;&lt;img src=&#34;http://bioinformatics.oxfordjournals.org/content/26/18.cover.gif&#34; alt=&#34;&#34; title=&#34;bioinfo&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;abstract:c41832c6f53a1eda12f563057a868592&#34;&gt;Abstract&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;SUMMARY&lt;/strong&gt;: The semantic comparisons of Gene Ontology (GO) annotations
provide quantitative ways to compute similarities between genes and gene
groups, and have became important basis for many bioinformatics analysis
approaches. GOSemSim is an R package for semantic similarity computation
among GO terms, sets of GO terms, gene products and gene clusters. Four
information content (IC)- and a graph-based methods are implemented in
the GOSemSim package, multiple species including human, rat, mouse, fly
and yeast are also supported. The functions provided by the GOSemSim
offer flexibility for applications, and can be easily integrated into
high-throughput analysis pipelines. AVAILABILITY: GOSemSim is released
under the GNU General Public License within Bioconductor project, and
freely available at
&lt;a href=&#34;http://bioconductor.org/packages/2.6/bioc/html/GOSemSim.html&#34;&gt;http://bioconductor.org/packages/2.6/bioc/html/GOSemSim.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Yu,G., Li, F., Qin, Y., Bo, X., Wu, Y., &amp;amp; Wang, S. (2010). GOSemSim: an R package for measuring semantic similarity among GO terms and gene
products &lt;em&gt;&lt;strong&gt;Bioinformatics&lt;/strong&gt;&lt;/em&gt;, 26(7), 976-978 DOI:
&lt;a href=&#34;http://dx.doi.org/10.1093/bioinformatics/btq064&#34;&gt;10.1093/bioinformatics/btq064&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>GOSemSim</title>
      <link>http://guangchuangyu.github.io/2008/08/gosemsim/</link>
      <pubDate>Mon, 11 Aug 2008 14:21:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2008/08/gosemsim/</guid>
      <description>&lt;p&gt;第一次写软件包，计算基因和GO的语义相似性。&lt;/p&gt;

&lt;p&gt;实现&lt;a href=&#34;http://bioinformatics.oxfordjournals.org/cgi/content/full/23/10/1274&#34;&gt;Wang&lt;/a&gt;的方法，基于GO的图结构。
以及四种基于信息含量的计算方法（Resnik, Jiang, Lin, Rel）。&lt;/p&gt;

&lt;p&gt;可以从Bioconductor下载到。
&lt;a href=&#34;http://bioconductor.org/packages/release/bioc/html/GOSemSim.html&#34;&gt;http://bioconductor.org/packages/release/bioc/html/GOSemSim.html&lt;/a&gt;
&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/html/GOSemSim.html&#34;&gt;http://bioconductor.org/packages/devel/bioc/html/GOSemSim.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;支持human, rat, mouse, fly, yeast, zebrafish,worm, E coli,
arabidopsis等物种。&lt;/p&gt;

&lt;p&gt;下载量统计如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://bioconductor.org/packages/stats/bioc/GOSemSim.png&#34; alt=&#34;&#34; title=&#34;GOSemSim_Downloads&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>