<!DOCTYPE html>
<html lang="en-us">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme" content="hugo-academic">
    <meta name="generator" content="Hugo 0.15" />
    <meta name="author" content="Guangchuang YU">
    <meta name="description" content="PhD student">

    <link rel="stylesheet" href="http://guangchuangyu.github.io/css/highlight.min.css">
    <link rel="stylesheet" href="http://guangchuangyu.github.io/css/bootstrap.min.css">
    <link rel="stylesheet" href="http://guangchuangyu.github.io/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://guangchuangyu.github.io/css/academicons.min.css">
    <link rel="stylesheet" href="http://guangchuangyu.github.io/css/hugo-academic.css">
    


    <link rel="shortcut icon" href="http://guangchuangyu.github.io/img/favicon.ico" type="image/x-icon">
    <link rel="canonical" href="http://guangchuangyu.github.io/post/stats/2009_bootstrap-method/">

    <title>Bootstrap Method | Guangchuang YU</title>

</head>
<body id="top">


<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
    <div class="container">

        
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://guangchuangyu.github.io/">Guangchuang YU</a>
        </div>

        
        <div class="collapse navbar-collapse" id="#navbar-collapse-1">

            
            <ul class="nav navbar-nav navbar-right">
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#top">Home</a></li>
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#publications">Publications</a></li>
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#posts">Posts</a></li>
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#projects">Projects</a></li>
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#teaching">Teaching</a></li>
                
                <li class="nav-item"><a href="http://guangchuangyu.github.io/#contact">Contact</a></li>
                
            </ul>

        </div>
    </div>
</nav>

<div class="container">

    <article class="article" itemscope itemtype="http://schema.org/Article">
        <h1 itemprop="name">Bootstrap Method</h1>

        

<div class="article-metadata">

    <span class="article-date">
        <time datetime="2009-07-31 09:14:42 &#43;0800 CST" itemprop="datePublished">Fri, Jul 31, 2009</time>
    </span>

    
    
    
    <span class="article-tags">
        <i class="fa fa-tags"></i>
        
        <a class="article-tag-link" href="http://guangchuangyu.github.io/tags/bootstrap">bootstrap</a>
        
    </span>
    
    

    
    <div class="pull-right">
        
<div class="share">

    <a class="facebook" href="https://www.facebook.com/sharer.php?u=" target="_blank">
        <i class="fa fa-facebook-square"></i>
        <span class="hidden">Facebook</span>
    </a>

    <a class="twitter" href="https://twitter.com/intent/tweet?text=&amp;url=" target="_blank">
        <i class="fa fa-twitter-square"></i>
        <span class="hidden">Twitter</span>
    </a>

    <a class="email" href="mailto:?subject=&amp;body=">
        <i class="fa fa-envelope-square"></i>
        <span class="hidden">Email</span>
    </a>

</div>


    </div>
    

</div>


        <div class="post" itemprop="articleBody">
            

<p><a href="http://en.wikipedia.org/wiki/Bootstrapping_(statistics)">bootstrap</a>是对观测数据集进行有放回（replacement）的随机抽样，以评估总体的各项统计指标。可以用于假设检验、参数估计。好处是并不要求大样本，也不要求正态数据，并且对于不同的统计指标使用的是同样的计算方法。结果也更为可靠，坏处是计算量大。</p>

<p>统计推断(statistical
inference)是基于样本统计值的抽样分布来计算的，抽样分布需要从总体中许多的样本来计算，在只有一个样本的情况下，bootstrap对这一随机样本进行有放回的重复抽样，每一个重抽样本与原始随机样本一样大，每次计算相应的抽样的统计值，重复了N次之后，就可以计算统计值的bootstrap分布。</p>

<p>下面做一个小小的试验：</p>

<pre><code>a &lt;- c(seq(1:10), rnorm(50))  
</code></pre>

<p>#创建一个样本，60个数据，非正态分布的，如下图</p>

<p><img src="http://guangchuangyu.github.io/blog_images/2009/07/sample_a.png" alt="" title="sample_a" /></p>

<pre><code>b &lt;- rep(0, 1000)
for (i in 1:1000) {
    b[i] &lt;- mean(sample(a, replace=TRUE))
}
</code></pre>

<p>对它进行1000次有放回重复抽样，计算均值，均值分布的柱状图和qq图如下：</p>

<p><img src="http://guangchuangyu.github.io/blog_images/2009/07/hist_qq.png" alt="" /></p>

<p>分布是正态的。</p>

<pre><code>&gt; mean(a)    #样本均值
[1] 0.947186
&gt; mean(b)   #重抽样1000个样本均值的均值
[1] 0.9358049
&gt; sd(b)
[1] 0.3245479
&gt; sd(a)/sqrt(60)
[1] 0.3318863
</code></pre>

<p>由bootstrap方法得到的标准误是0.325，而由原先随机样本所估算的是0.332，两者是相当接近的。由此可见呢，bootstrap方法与理论上的从总体中抽样所得到的样本分布是一致的，这样子就可以基于一个样本来计算样本的分布，而不是要从总体中抽N个样本。</p>

<p>还用上面的例子，使用样本均值$ \bar{x}$去估算总体的均值$
\mu$，虽然我们的样本不是正态的，但如果bootstrap
distribution是正态的话，就可以使用类似于单样本t置信区间（要求样本是正态的）的公式:$
\bar{x} \pm t \cdot SE = \bar{x} \pm t \cdot
\frac{s}{\sqrt{n}}$ 相应的bootstrap t置信区间是：$ statistic
\pm t \cdot SE_{boot}$ 上面例子，总体均值$ \mu$
95%的置信度，就会落在：$ mean(a) \pm 2.009 \cdot sd(b)$
可以使用它，计算所有统计指标的置信区间。</p>

<p>用于层次聚类分析的一个例子，使用Pvclust这个包，用于层次聚类，并通过multiscale
bootstrap
resampling给出相应的<em>p</em>-value用于评估聚类结果的不确定性。提供了两种<em>p</em>-values，AU（approximately
unbiased p-value, 通过multiscale bootstrap
resampling计算）和BP（bootstrap probability, 通过normal bootstrap
resampling计算），AU比BP较为unbiased。
Pvclust使用*hclust*（来自于stats包）进行层次聚类，并自动计算所有的子类的<em>p</em>-value。</p>

<pre><code>library(pvclust)  # loads package
a &lt;- matrix(rnorm(1000), 100, 10, dimnames=list(paste(&quot;g&quot;, 1:100, sep=&quot;&quot;), paste(&quot;t&quot;,1:10, sep=&quot;&quot;)))  # creats sample data
at &lt;- t(a)  # transposes of a
cl &lt;- pvclust(at, nboot=1000)  #performs hierarchical cluster analysis with multiscale bootstrap with 1000 repetitions.
pvrect(cl, alpha=0.95)  #highlights with red rectangles all clusters in the dendrogram which have an AU value above 95%, AU p-value &gt; 0.95, the hypothesis that &quot;the cluster does not exist&quot; is rejected with significance level 0.05;
</code></pre>

<p><img src="http://guangchuangyu.github.io/blog_images/2009/07/pvclust_test.png" alt="" /></p>

<pre><code>#pick significant clusters.
clsig &lt;- pvpick(cl, alpha=0.95, pv=&quot;au&quot;, type=&quot;geq&quot;, max.only=TRUE)  
</code></pre>

<h3 id="reference:5129f3fc49180ee68d0efdb6ded483c8">Reference</h3>

<p>1.  Moore, D.S., McCabe, G.P. &amp; Craig, B. Introduction to the Practice
of Statistics w/CD-ROM.  (W. H. Freeman: 2007).</p>

<p>2.  Suzuki, R. (2006). Pvclust: an R package for assessing the uncertainty in hierarchical clustering, Bioinformatics, 22(12), 1540-1542
DOI:
<a href="http://dx.doi.org/10.1093/bioinformatics/btl117">10.1093/bioinformatics/btl117</a></p>

        </div>
    </article>

    <nav>
    <ul class="pager">
        
        <li class="previous"><a href="http://guangchuangyu.github.io/post/r/gosemsim/2008_gosemsim/"><span aria-hidden="true">&larr;</span> GOSemSim</a></li>
        

        
        <li class="next"><a href="http://guangchuangyu.github.io/post/r/gosemsim/2010_gosemsim-an-r-package-for-measuring-semantic-similarity-among-go-terms-and-gene-products/">GOSemSim an R package for measuring semantic similarity among GO terms and gene products <span aria-hidden="true">&rarr;</span></a></li>
        
    </ul>
</nav>

    
<section id="comments">
    <div id="disqus_thread">
        <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'gcyu';
    var disqus_identifier = 'http:\/\/guangchuangyu.github.io\/post\/stats\/2009_bootstrap-method\/';
    var disqus_title = 'Bootstrap Method';
    var disqus_url = 'http:\/\/guangchuangyu.github.io\/post\/stats\/2009_bootstrap-method\/';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
</section>



    <footer class="site-footer">
    <div class="inner">
        <p class="powered-by">

            &copy; 2016 Guangchuang YU &middot; 

            Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

            <span class="pull-right"><a href="#" id="back_to_top"><span class="button_icon"><i class="fa fa-chevron-up fa-2x" aria-hidden="true"></i></span></a></span>

        </p>
    </div>
</footer>

 </div>
        <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
        <script src="http://guangchuangyu.github.io/js/jquery-1.12.3.min.js"></script>
        <script src="http://guangchuangyu.github.io/js/bootstrap.min.js"></script>
        <script src="http://guangchuangyu.github.io/js/hugo-academic.js"></script>
        

        

        
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.3.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

        
        
        <script type="text/x-mathjax-config">
            MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
        </script>
        <script async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
        

    </body>
</html>

