<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on Guangchuang YU</title>
    <link>http://guangchuangyu.github.io/post/</link>
    <description>Recent content in Posts on Guangchuang YU</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016 Guangchuang YU</copyright>
    <lastBuildDate>Thu, 05 May 2016 20:13:57 +0800</lastBuildDate>
    <atom:link href="http://guangchuangyu.github.io/post/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>NEWS of my BioC packages</title>
      <link>http://guangchuangyu.github.io/2016/05/news-of-my-bioc-packages</link>
      <pubDate>Thu, 05 May 2016 20:13:57 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/05/news-of-my-bioc-packages</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/MISC/ke.jpg&#34; width=600&gt;&lt;/p&gt;

&lt;p&gt;Today is my birthday and it happened to be the release day of Bioconductor 3.3. It&amp;rsquo;s again the time to reflect what I&amp;rsquo;ve done in the past year.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/DOSE&#34;&gt;DOSE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;chipseeker:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ChIPseeker&lt;/h2&gt;

&lt;p&gt;Although ChIPseeker was designed for ChIP-seq annotation, I am very glad to find that someone else use it to annotate other data including &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/32&#34;&gt;copy number variants&lt;/a&gt; and &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/17&#34;&gt;DNA breakpoints&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;annotatepeak:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;annotatePeak&lt;/h3&gt;

&lt;p&gt;Several parameters including &lt;code&gt;sameStrand&lt;/code&gt;,&lt;code&gt;ignoreOverlap&lt;/code&gt;, &lt;code&gt;ignoreUpstream&lt;/code&gt; and &lt;code&gt;ignoreDownstream&lt;/code&gt; were added in &lt;code&gt;annotatePeak&lt;/code&gt; requested by &lt;a href=&#34;https://github.com/crazyhottommy&#34;&gt;@crazyhottommy&lt;/a&gt; for using ChIPseeker to annotate breakpoints from whole genome sequencing data.&lt;/p&gt;

&lt;p&gt;Another parameter &lt;code&gt;overlap&lt;/code&gt; was also introduced. By default &lt;code&gt;overlap=&amp;quot;TSS&amp;quot;&lt;/code&gt; and only overlap with TSS will be reported as the nearest gene. If &lt;code&gt;overlap=&amp;quot;all&amp;quot;&lt;/code&gt;, then gene overlap with peak will be reported as nearest gene, no matter the overlap is at TSS region or not.&lt;/p&gt;

&lt;p&gt;Now &lt;code&gt;annotatePeak&lt;/code&gt; also support using user&amp;rsquo;s customize regions to annotate their data by passing &lt;code&gt;TxDb=user_defined_GRanges&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;getbioregion:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;getBioRegion&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;getPromoters()&lt;/code&gt; function prepare a &lt;code&gt;GRanges&lt;/code&gt; object of promoter regions by user specific upstream and downstream distance from Transcript Start Site (TSS). Then we can align the peaks that are mapping to these regions and visualize the profile or heatmap of ChIP binding to the TSS regions.&lt;/p&gt;

&lt;p&gt;Users (&lt;a href=&#34;https://support.bioconductor.org/p/73069/#73157&#34;&gt;1&lt;/a&gt; and &lt;a href=&#34;https://support.bioconductor.org/p/73377/&#34;&gt;2&lt;/a&gt;) are interesting in the intensity of peaks binding to the start of intron/exon, and ChIPseeker provides a new function &lt;code&gt;getBioRegion&lt;/code&gt; to output &lt;code&gt;GRanges&lt;/code&gt; object of Intron/Exon start regions.&lt;/p&gt;

&lt;h3 id=&#34;visualization:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;visualization&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize &lt;a href=&#34;http://guangchuangyu.github.io/2015/07/upsetplot-in-chipseeker/&#34;&gt;ChIP annotation overlap&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;covplot&lt;/code&gt; now support &lt;a href=&#34;http://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist/&#34;&gt;GRangesList&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;geo-data-mining:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GEO data mining&lt;/h3&gt;

&lt;p&gt;ChIPseeker incorporates GEO database and supports data mining to infer cooperative regulation. The data was updated and now ChIPseeker contains 19348 bed file information.&lt;/p&gt;

&lt;h2 id=&#34;clusterprofiler:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;clusterProfiler&lt;/h2&gt;

&lt;p&gt;We compare clusterProfiler with GSEA-P (which released by broad institute), the p-values calculated by these two software are &lt;a href=&#34;http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;almost identical&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For comparing biological themes, &lt;code&gt;clusterProfiler&lt;/code&gt; supports formula to express complex conditions and facet is supported to &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/32&#34;&gt;visualize complex result&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;read.gmt&lt;/code&gt; function for parsing GMT file format from &lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;, so that gene set collections in this database can be used in &lt;code&gt;clusterProfiler&lt;/code&gt; for both hypergeometric test and GSEA.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis/&#34;&gt;KEGG Module&lt;/a&gt; was supported just like the KEGG Pathway, &lt;code&gt;clusterProfiler&lt;/code&gt; will query the online annotation data which keep the annotation data alwasy updated.&lt;/p&gt;

&lt;p&gt;The KEGG database was updated quite frequently. The &lt;code&gt;KEGG.db&lt;/code&gt; which was not updated since 2012, it contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2014/08/why-clusterprofiler-fails/&#34;&gt;5894 human genes&lt;/a&gt;. In Feb. 2015, when &lt;code&gt;clusterProfiler&lt;/code&gt; first supports querying online KEGG data, KEGG contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;6861 human genes&lt;/a&gt; and today it has &lt;strong&gt;7018&lt;/strong&gt; human genes annotated. Most of the tools/webservers used out-dated data (e.g. DAVID not updated since 2010, 5085 human genes annotated by KEGG), the analyzed result may totally changed if we use a recently updated data. Indeed &lt;code&gt;clusterProfiler&lt;/code&gt; is more reliable as we always use the latest data.&lt;/p&gt;

&lt;p&gt;In addition to &lt;code&gt;bitr&lt;/code&gt; function that can translate biological ID using &lt;code&gt;OrgDb&lt;/code&gt; object, we provides &lt;a href=&#34;http://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler/&#34;&gt;bitr_kegg&lt;/a&gt; that uses KEGG API for translating biological ID. It supports more than 4000 species (can be search via the &lt;code&gt;search_kegg_species&lt;/code&gt; function) as in KEGG Pathway and Module analyses.&lt;/p&gt;

&lt;p&gt;The function called of &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler/&#34;&gt;enrichGO and gseGO&lt;/a&gt; was changed. Now not only species that have OrgDb available in Bioconductor can be analyzed but also all species that have an OrgDb can be analyzed which can be query online via &lt;code&gt;AnnotationHub&lt;/code&gt; or build with user&amp;rsquo;s own data. With this update, &lt;code&gt;enrichGO&lt;/code&gt; and &lt;code&gt;gseGO&lt;/code&gt; can input any gene ID type if only the ID type was supported in the &lt;code&gt;OrgDb&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;GO enrichment analysis alwasy output redundant terms, we implemented a &lt;code&gt;simplify&lt;/code&gt; function to remove redundant terms by calculating GO semantic similarity using &lt;code&gt;GOSemSim&lt;/code&gt;. Several useful utilities include &lt;code&gt;dropGO&lt;/code&gt;, &lt;code&gt;go2ont&lt;/code&gt;, &lt;code&gt;go2term&lt;/code&gt;, &lt;code&gt;gofilter&lt;/code&gt; and &lt;code&gt;gsfilter&lt;/code&gt; are also provided.&lt;/p&gt;

&lt;p&gt;I bump the version to 3.0.0 the following three reasons:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the changes of function calls&lt;/li&gt;
&lt;li&gt;can analyze any ontology/pathway annotation (supports user&amp;rsquo;s customize annotation data)&lt;/li&gt;
&lt;li&gt;can analyze all speices that have annotation available (e.g. more than 4000 species for KEGG)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Although the package is very simple when I published it, I keep update and add new features from my own idea or user&amp;rsquo;s request. Now this package is indeed in good shape. Here is the summary.&lt;/p&gt;

&lt;p&gt;This package implements methods to analyze and visualize functional profiles of genomic coordinates (supported by &lt;a href=&#34;http://www.bioconductor.org/packages/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;), gene and gene clusters.&lt;/p&gt;

&lt;p&gt;clusterProfiler supports both &lt;em&gt;hypergeometric test&lt;/em&gt; and &lt;em&gt;Gene Set Enrichment Analysis&lt;/em&gt; for many ontologies/pathways, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Disease Ontology (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ncg.kcl.ac.uk/&#34;&gt;Network of Cancer Gene&lt;/a&gt; (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Gene Ontology (supports many species with GO annotation query online via &lt;a href=&#34;https://bioconductor.org/packages/AnnotationHub/&#34;&gt;AnnotationHub&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;KEGG Pathway and Module with latest online data (supports more than 4000 species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Reactome Pathway (via &lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;DAVID (via &lt;a href=&#34;http://www.bioconductor.org/packages/RDAVIDWebService&#34;&gt;RDAVIDWebService&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;hallmark gene sets&lt;/li&gt;
&lt;li&gt;positional gene sets&lt;/li&gt;
&lt;li&gt;curated gene sets&lt;/li&gt;
&lt;li&gt;motif gene sets&lt;/li&gt;
&lt;li&gt;computational gene sets&lt;/li&gt;
&lt;li&gt;GO gene sets&lt;/li&gt;
&lt;li&gt;oncogenic signatures&lt;/li&gt;
&lt;li&gt;immunologic signatures&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Other Annotations

&lt;ul&gt;
&lt;li&gt;from other sources (e.g. &lt;a href=&#34;http://www.disgenet.org/web/DisGeNET/menu/home&#34;&gt;DisGeNET&lt;/a&gt; as &lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;an example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;user&amp;rsquo;s annotation&lt;/li&gt;
&lt;li&gt;customized ontology&lt;/li&gt;
&lt;li&gt;and many others&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;clusterProfiler&lt;/em&gt; also provides several visualization methods to help interpreting enriched results, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;barplot&lt;/li&gt;
&lt;li&gt;cnetplot&lt;/li&gt;
&lt;li&gt;dotplot&lt;/li&gt;
&lt;li&gt;enrichMap&lt;/li&gt;
&lt;li&gt;gseaplot&lt;/li&gt;
&lt;li&gt;plotGOgraph (via &lt;a href=&#34;http://www.bioconductor.org/packages/topGO&#34;&gt;topGO&lt;/a&gt; package)&lt;/li&gt;
&lt;li&gt;upsetplot (via &lt;a href=&#34;https://github.com/cran/UpSetR&#34;&gt;UpSetR&lt;/a&gt; package)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and several useful utilities:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;bitr (Biological Id TranslatoR)&lt;/li&gt;
&lt;li&gt;bitr_kegg (bitr using KEGG source)&lt;/li&gt;
&lt;li&gt;compareCluster (biological theme comparison)&lt;/li&gt;
&lt;li&gt;dropGO (screen out GO term of specific level or specific term)&lt;/li&gt;
&lt;li&gt;go2ont (convert GO ID to Ontology)&lt;/li&gt;
&lt;li&gt;go2term (convert GO ID to descriptive term)&lt;/li&gt;
&lt;li&gt;gofilter (restrict result at specific GO level)&lt;/li&gt;
&lt;li&gt;gsfilter (restrict result by gene set size)&lt;/li&gt;
&lt;li&gt;search_kegg_organism (search kegg supported organism)&lt;/li&gt;
&lt;li&gt;setReadable (convert IDs stored &lt;code&gt;enrichResult&lt;/code&gt; object to gene symbol)&lt;/li&gt;
&lt;li&gt;simplify (remove redundant GO terms, supported via &lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;dose:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;DOSE&lt;/h2&gt;

&lt;p&gt;DOSE now test bimodal separately in GSEA and the output pvalues are &lt;a href=&#34;(http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;more conserved&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;maxGSSize&lt;/code&gt; parameter was added, with default value of &lt;code&gt;500&lt;/code&gt;. Usually if the geneset &amp;gt; 500, its probability of being called significant by GSEA rises quite dramatically.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;gsfilter&lt;/code&gt; function for restricting enriched results with minimal and maximal gene set sizes.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize overlap of enriched gene sets.&lt;/p&gt;

&lt;p&gt;The dot sizes in &lt;code&gt;enrichMap&lt;/code&gt; now scaled by category sizes&lt;/p&gt;

&lt;p&gt;All these changes also affect &lt;code&gt;clusterProfiler&lt;/code&gt; and &lt;code&gt;ReactomePA&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&#34;ggtree:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ggtree&lt;/h2&gt;

&lt;p&gt;I put more efforts to extend &lt;code&gt;ggtree&lt;/code&gt; than the sum of all other packages. Here listed the major new features while small improvement and bug fixed can be found in the NEWS file.&lt;/p&gt;

&lt;h3 id=&#34;io:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;IO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;supports &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;NHX&lt;/a&gt; file format via &lt;code&gt;read.nhx&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;supports &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/&#34;&gt;phylip&lt;/a&gt; tree format via &lt;code&gt;read.phylip&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;raxml2nwk for converting raxml bootstrap tree to newick text&lt;/li&gt;
&lt;li&gt;all parser functions support passing &lt;code&gt;textConnection(text_string)&lt;/code&gt; as a file&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;ape&lt;/code&gt; bootstrap analysis&lt;/li&gt;
&lt;li&gt;supports annotating tree with ancestral sequences inferred by &lt;code&gt;phangorn&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;obkData&lt;/code&gt; object defined by &lt;code&gt;OutbreakTools&lt;/code&gt; package&lt;/li&gt;
&lt;li&gt;supports &lt;code&gt;phyloseq&lt;/code&gt; object defined by &lt;code&gt;phyloseq&lt;/code&gt; package&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;layers:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;layers&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;geom_point2,geom_text2, geom_segment2 and geom_label2 to &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;support subsetting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;geom_treescale for adding scale of branch length&lt;/li&gt;
&lt;li&gt;geom_cladelabel for labeling selected clade&lt;/li&gt;
&lt;li&gt;geom_tiplab2 for adding tiplab of circular tree&lt;/li&gt;
&lt;li&gt;geom_taxalink for connecting related taxa&lt;/li&gt;
&lt;li&gt;geom_range for adding range to present uncertainty of branch lengths&lt;/li&gt;
&lt;li&gt;subview and inset now support annotating with &lt;a href=&#34;http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function/&#34;&gt;image files&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;utilities:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;utilities&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;rescale_tree&lt;/a&gt; function to rescale branch lengths using numerical variable&lt;/li&gt;
&lt;li&gt;MRCA for finding Most Recent Common Ancestor among a vector of tips&lt;/li&gt;
&lt;li&gt;viewClade to zoom in a selected clade&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;vignettes:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;vignettes&lt;/h3&gt;

&lt;p&gt;Split the long vignette to several small ones and add more examples.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/ggtree.html&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/advanceTreeAnnotation.html&#34;&gt;Advance Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here is the NEWS record:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CHANGES IN VERSION 1.3.16
------------------------
 o geom_treescale() supports family argument &amp;lt;2016-04-27, Wed&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/56
 o update fortify.phylo to work with phylo that has missing value of edge length &amp;lt;2016-04-21, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/54
 o support passing textConnection(text_string) as a file &amp;lt;2016-04-21, Thu&amp;gt;
   + contributed by Casey Dunn &amp;lt;casey_dunn@brown.edu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/pull/55#issuecomment-212859693
 
CHANGES IN VERSION 1.3.15
------------------------
 o geom_tiplab2 supports parameter hjust &amp;lt;2016-04-18, Mon&amp;gt;
 o geom_tiplab and geom_tiplab2 support using geom_label2 by passing geom=&amp;quot;label&amp;quot; &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_label2 that support subsetting &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_tiplab2 for adding tip label of circular layout &amp;lt;2016-04-06, Wed&amp;gt;
 o use plot$plot_env to access ggplot2 parameter &amp;lt;2016-04-06, Wed&amp;gt;
 o geom_taxalink for connecting related taxa &amp;lt;2016-04-01, Fri&amp;gt; 
 o geom_range for adding range of HPD to present uncertainty of evolutionary inference &amp;lt;2016-04-01, Fri&amp;gt;
 
CHANGES IN VERSION 1.3.14
------------------------
 o geom_tiplab works with NA values, compatible with collapse &amp;lt;2016-03-05, Sat&amp;gt;
 o update theme_tree2 due to the issue of https://github.com/hadley/ggplot2/issues/1567 &amp;lt;2016-03-05, Sat&amp;gt;
 o offset works in `align=FFALSE` with `annotation_image` function &amp;lt;2016-02-23, Tue&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/46
 o subview and inset now supports annotating with img files &amp;lt;2016-02-23, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.13
------------------------
 o add example of rescale_tree function in treeAnnotation.Rmd &amp;lt;2016-02-07, Sun&amp;gt;
 o geom_cladelabel works with collapse &amp;lt;2016-02-07, Sun&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/38 

CHANGES IN VERSION 1.3.12
------------------------
 o exchange function name of geom_tree and geom_tree2  &amp;lt;2016-01-25, Mon&amp;gt;
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/hadley/ggplot2/issues/1512
 o colnames_level parameter in gheatmap &amp;lt;2016-01-25, Mon&amp;gt;
 o raxml2nwk function for converting raxml bootstrap tree to newick format &amp;lt;2016-01-25, Mon&amp;gt; 
 
CHANGES IN VERSION 1.3.11
------------------------
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/36
 o change compute_group() to compute_panel in geom_tree2() &amp;lt;2016-01-21, Thu&amp;gt;
   + fixed issue, https://github.com/GuangchuangYu/ggtree/issues/36
 o support phyloseq object &amp;lt;2016-01-21, Thu&amp;gt;
 o update geom_point2, geom_text2 and geom_segment2 to support setup_tree_data &amp;lt;2016-01-21, Thu&amp;gt;
 o implement geom_tree2 layer that support duplicated node records via the setup_tree_data function &amp;lt;2016-01-21, Thu&amp;gt;
 o rescale_tree function for rescaling branch length of tree object &amp;lt;2016-01-20, Wed&amp;gt;
 o upgrade set_branch_length, now branch can be rescaled using feature in extraInfo slot &amp;lt;2016-01-20, Wed&amp;gt;
 
CHANGES IN VERSION 1.3.10
------------------------
 o remove dependency of gridExtra by implementing multiplot function instead of using grid.arrange &amp;lt;2016-01-20, Wed&amp;gt;
 o remove dependency of colorspace &amp;lt;2016-01-20, Wed&amp;gt;
 o support phylip tree format and update vignette of phylip example &amp;lt;2016-01-15, Fri&amp;gt;

CHANGES IN VERSION 1.3.9
------------------------
 o optimize getYcoord &amp;lt;2016-01-14, Thu&amp;gt;
 o add &#39;multiPhylo&#39; example in &#39;Tree Visualization&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o viewClade, scaleClade, collapse, expand, rotate, flip, get_taxa_name and scale_x_ggtree accepts input tree_view=NULL.
   these function will access the last plot if tree_view=NULL. &amp;lt;2016-01-13, Wed&amp;gt;
   + &amp;gt; ggtree(rtree(30)); viewClade(node=35) works. no need to pipe.
 
CHANGES IN VERSION 1.3.8
------------------------
 o add example of viewClade in &#39;Tree Manipulation&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o add viewClade function &amp;lt;2016-01-12, Tue&amp;gt;
 o support obkData object defined by OutbreakTools &amp;lt;2016-01-12, Tue&amp;gt;
 o update vignettes &amp;lt;2016-01-07, Thu&amp;gt;
 o 05 advance tree annotation vignette &amp;lt;2016-01-04, Mon&amp;gt;
 o export theme_inset &amp;lt;2016-01-04, Mon&amp;gt;
 o inset, nodebar, nodepie functions &amp;lt;2015-12-31, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.7
------------------------
 o split the long vignette to several vignettes
   + 00 ggtree &amp;lt;2015-12-29, Tue&amp;gt;
   + 01 tree data import &amp;lt;2015-12-28, Mon&amp;gt;
   + 02 tree visualization &amp;lt;2015-12-28, Mon&amp;gt;
   + 03 tree manipulation &amp;lt;2015-12-28, Mon&amp;gt;
   + 04 tree annotation &amp;lt;2015-12-29, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.6
------------------------
 o MRCA function for finding Most Recent Common Ancestor among a vector of tips &amp;lt;2015-12-22, Tue&amp;gt;
 o geom_cladelabel: add bar and label to annotate a clade &amp;lt;2015-12-21, Mon&amp;gt;
   - remove annotation_clade and annotation_clade2 functions.
 o geom_treescale: tree scale layer. (add_legend was removed) &amp;lt;2015-12-21, Mon&amp;gt;
 
CHANGES IN VERSION 1.3.5
------------------------
 o bug fixed, read.nhx now works with scientific notation &amp;lt;2015-11-30, Mon&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/30

CHANGES IN VERSION 1.3.4
------------------------
 o rename beast feature when name conflict with reserve keywords (label, branch, etc) &amp;lt;2015-11-27, Fri&amp;gt;
 o get_clade_position function &amp;lt;2015-11-26, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/28
 o get_heatmap_column_position function &amp;lt;2015-11-25, Wed&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/26
 o support NHX (New Hampshire X) format via read.nhx function &amp;lt;2015-11-17, Tue&amp;gt;
 o bug fixed in extract.treeinfo.jplace &amp;lt;2015-11-17, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.3
------------------------
 o support color=NULL in gheatmap, then no colored line will draw within the heatmap &amp;lt;2015-10-30, Fri&amp;gt;
 o add `angle` for also rectangular, so that it will be available for layout=&#39;rectangular&#39; following by coord_polar() &amp;lt;2015-10-27, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.2
------------------------
 o update vignette, add example of ape bootstrap and phangorn ancestral sequences &amp;lt;2015-10-26, Mon&amp;gt;
 o add support of ape bootstrap analysis &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/20
 o add support of ancestral sequences inferred by phangorn &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/21
 
CHANGES IN VERSION 1.3.1
------------------------
 o change angle to angle + 90, so that label will in radial direction &amp;lt;2015-10-22, Thu&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/17
 o na.rm should be always passed to layer(), fixed it in geom_hilight and geom_text2 &amp;lt;2015-10-21, Wed&amp;gt;
   + see https://github.com/hadley/ggplot2/issues/1380
 o matching beast stats with tree using internal node number instead of label &amp;lt;2015-10-20, Tue&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;gosemsim:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GOSemSim&lt;/h2&gt;

&lt;p&gt;update IC data using update OrgDb packages.&lt;/p&gt;

&lt;h2 id=&#34;reactomepa:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ReactomePA&lt;/h2&gt;

&lt;p&gt;We published ReactomePA in &lt;a href=&#34;http://pubs.rsc.org/en/Content/ArticleLanding/2016/MB/C5MB00663E&#34;&gt;Molecular BioSystems&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>convert biological ID with KEGG API using clusterProfiler</title>
      <link>http://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler</link>
      <pubDate>Tue, 03 May 2016 17:00:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler</guid>
      <description>

&lt;h2 id=&#34;bitr-kegg:ea0718166651864960b492e0d7486a4f&#34;&gt;bitr_kegg&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; can convert biological IDs using &lt;code&gt;OrgDb&lt;/code&gt; object via the &lt;code&gt;bitr&lt;/code&gt; function. Now I implemented another function, &lt;code&gt;bitr_kegg&lt;/code&gt; for converting IDs through KEGG API.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(clusterProfiler)
data(gcSample)
hg &amp;lt;- gcSample[[1]]
head(hg)

## [1] &amp;quot;4597&amp;quot;  &amp;quot;7111&amp;quot;  &amp;quot;5266&amp;quot;  &amp;quot;2175&amp;quot;  &amp;quot;755&amp;quot;   &amp;quot;23046&amp;quot;

eg2np &amp;lt;- bitr_kegg(hg, fromType=&#39;kegg&#39;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;hsa&#39;)

## Warning in bitr_kegg(hg, fromType = &amp;quot;kegg&amp;quot;, toType = &amp;quot;ncbi-proteinid&amp;quot;,
## organism = &amp;quot;hsa&amp;quot;): 3.7% of input gene IDs are fail to map...

head(eg2np)

##     kegg ncbi-proteinid
## 1   8326      NP_003499
## 2  58487   NP_001034707
## 3 139081      NP_619647
## 4  59272      NP_068576
## 5    993      NP_001780
## 6   2676      NP_001487

np2up &amp;lt;- bitr_kegg(eg2np[,2], fromType=&#39;ncbi-proteinid&#39;, toType=&#39;uniprot&#39;, organism=&#39;hsa&#39;)

head(np2up)

##   ncbi-proteinid uniprot
## 1      NP_005457  O75586
## 2      NP_005792  P41567
## 3      NP_005792  Q6IAV3
## 4      NP_037536  Q13421
## 5      NP_006054  O60662
## 6   NP_001092002  O95398
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The ID type (both fromType &amp;amp; toType) should be one of &amp;lsquo;kegg&amp;rsquo;, &amp;lsquo;ncbi-geneid&amp;rsquo;, &amp;lsquo;ncbi-proteinid&amp;rsquo; or &amp;lsquo;uniprot&amp;rsquo;. The &amp;lsquo;kegg&amp;rsquo; is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the &amp;lsquo;kegg&amp;rsquo; ID is &lt;code&gt;entrezgene&lt;/code&gt; ID for eukaryote species and &lt;code&gt;Locus&lt;/code&gt; ID for prokaryotes.&lt;/p&gt;

&lt;p&gt;Many prokaryote species don&amp;rsquo;t have entrezgene ID available. For example we can check the gene information of &lt;code&gt;ece:Z5100&lt;/code&gt; in &lt;a href=&#34;http://www.genome.jp/dbget-bin/www_bget?ece:Z5100&#34;&gt;http://www.genome.jp/dbget-bin/www_bget?ece:Z5100&lt;/a&gt;, which have &lt;code&gt;NCBI-ProteinID&lt;/code&gt; and &lt;code&gt;UnitProt&lt;/code&gt; links in the &lt;code&gt;Other DBs&lt;/code&gt; Entry, but not &lt;code&gt;NCBI-GeneID&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;If we try to convert &lt;code&gt;Z5100&lt;/code&gt; to &lt;code&gt;ncbi-geneid&lt;/code&gt;, &lt;code&gt;bitr_kegg&lt;/code&gt; will throw error of &lt;code&gt;ncbi-geneid is not supported&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;ncbi-geneid&#39;, organism=&#39;ece&#39;)

## Error in KEGG_convert(fromType, toType, organism) :
## ncbi-geneid is not supported for ece ...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can of course convert it to &lt;code&gt;ncbi-proteinid&lt;/code&gt; and &lt;code&gt;uniprot&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;ncbi-proteinid&#39;, organism=&#39;ece&#39;)

##    kegg ncbi-proteinid
## 1 Z5100       AAG58814

bitr_kegg(&amp;quot;Z5100&amp;quot;, fromType=&amp;quot;kegg&amp;quot;, toType=&#39;uniprot&#39;, organism=&#39;ece&#39;)

##    kegg uniprot
## 1 Z5100  Q7DB85
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;search-kegg-organism:ea0718166651864960b492e0d7486a4f&#34;&gt;search_kegg_organism&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; supports more than 4k species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt; for hypergeometric test (&lt;code&gt;enrichKEGG&lt;/code&gt; &amp;amp; &lt;code&gt;enrichMKEGG&lt;/code&gt;) and GSEA (&lt;code&gt;gseKEGG&lt;/code&gt; &amp;amp; &lt;code&gt;gseMKEGG&lt;/code&gt;). We can use &lt;code&gt;bitr_kegg&lt;/code&gt; to convert ID for all these 4k species. To facilitate searching scientific name abbreviate used in the &lt;code&gt;organism&lt;/code&gt; parameter of these functions, I implemented the &lt;code&gt;search_kegg_organism&lt;/code&gt; function. We can search by &lt;code&gt;kegg_code&lt;/code&gt;, &lt;code&gt;scientific_name&lt;/code&gt; or &lt;code&gt;common_name&lt;/code&gt; (which is not available for prokaryotes).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;search_kegg_organism(&#39;ece&#39;, by=&#39;kegg_code&#39;)

##     kegg_code                        scientific_name common_name
## 334       ece Escherichia coli O157:H7 EDL933 (EHEC)        &amp;lt;NA&amp;gt;

ecoli &amp;lt;- search_kegg_organism(&#39;Escherichia coli&#39;, by=&#39;scientific_name&#39;)
dim(ecoli)

## [1] 64  3

head(ecoli)

##     kegg_code                        scientific_name common_name
## 329       eco           Escherichia coli K-12 MG1655        &amp;lt;NA&amp;gt;
## 330       ecj            Escherichia coli K-12 W3110        &amp;lt;NA&amp;gt;
## 331       ecd            Escherichia coli K-12 DH10B        &amp;lt;NA&amp;gt;
## 332       ebw                Escherichia coli BW2952        &amp;lt;NA&amp;gt;
## 333      ecok            Escherichia coli K-12 MDS42        &amp;lt;NA&amp;gt;
## 334       ece Escherichia coli O157:H7 EDL933 (EHEC)        &amp;lt;NA&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;keytype-parameter:ea0718166651864960b492e0d7486a4f&#34;&gt;keyType parameter&lt;/h2&gt;

&lt;p&gt;With the ID conversion utilities built in &lt;code&gt;clusterProfiler&lt;/code&gt;, I add a parameter &lt;code&gt;keyType&lt;/code&gt; in &lt;code&gt;enrichKEGG&lt;/code&gt;, &lt;code&gt;enrichMKEGG&lt;/code&gt;, &lt;code&gt;gseKEGG&lt;/code&gt; and &lt;code&gt;gseMKEGG&lt;/code&gt;. Now we can use ID type that is not the primary ID in KEGG database.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;x &amp;lt;- enrichKEGG(np2up[,2], organism=&#39;hsa&#39;, keyType=&#39;uniprot&#39;)
head(summary(x))

##                ID                            Description GeneRatio
## hsa04072 hsa04072      Phospholipase D signaling pathway    11/133
## hsa04060 hsa04060 Cytokine-cytokine receptor interaction    14/133
## hsa04390 hsa04390                Hippo signaling pathway    10/133
## hsa04975 hsa04975           Fat digestion and absorption     5/133
## hsa05221 hsa05221                 Acute myeloid leukemia     6/133
##           BgRatio       pvalue   p.adjust     qvalue
## hsa04072 216/9275 0.0002654190 0.03901659 0.03240905
## hsa04060 354/9275 0.0005349245 0.03931695 0.03265855
## hsa04390 213/9275 0.0009536247 0.04199404 0.03488227
## hsa04975  58/9275 0.0014014886 0.04199404 0.03488227
## hsa05221  86/9275 0.0014283687 0.04199404 0.03488227
##                                                                                                         geneID
## hsa04072                      O95398/Q99777/P49619/Q6FGP0/Q8WVM9/O14807/P41594/A8K5P7/P10145/A0A024RDA5/P16234
## hsa04060 A0N0N3/O00574/P19876/P01589/P10145/A0A024RDA5/B4DGA4/Q99665/P16234/P78556/Q6I9S7/P42830/P27930/Q9UBN6
## hsa04390                             Q8WW10/A8K141/Q9UI47/P35240/A0A024R1J8/Q659G9/Q9UJU2/P22003/M9VUD0/O00144
## hsa04975                                                            Q9UNK4/A0A087WZT4/A0A0C4DFX6/Q9UHC9/P04054
## hsa05221                                                         Q659G9/Q9UJU2/Q03181/A0A024RCW6/Q06455/B2R6I9
##          Count
## hsa04072    11
## hsa04060    14
## hsa04390    10
## hsa04975     5
## hsa05221     6
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;setreadable:ea0718166651864960b492e0d7486a4f&#34;&gt;setReadable&lt;/h2&gt;

&lt;p&gt;For GO analysis, we have a &lt;code&gt;readable&lt;/code&gt; parameter to control whether traslating the IDs to human readable gene name. This parameter is not available for KEGG analysis. But we still have the ability to translate input gene IDs to gene name using &lt;code&gt;setReadable&lt;/code&gt; function if and only if corresponding &lt;code&gt;OrgDb&lt;/code&gt; object is available.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;y &amp;lt;- setReadable(x, &#39;org.Hs.eg.db&#39;, keytype=&amp;quot;UNIPROT&amp;quot;)
head(summary(y))

##                ID                            Description GeneRatio
## hsa04072 hsa04072      Phospholipase D signaling pathway    11/133
## hsa04060 hsa04060 Cytokine-cytokine receptor interaction    14/133
## hsa04390 hsa04390                Hippo signaling pathway    10/133
## hsa04975 hsa04975           Fat digestion and absorption     5/133
## hsa05221 hsa05221                 Acute myeloid leukemia     6/133
##           BgRatio       pvalue   p.adjust     qvalue
## hsa04072 216/9275 0.0002654190 0.03901659 0.03240905
## hsa04060 354/9275 0.0005349245 0.03931695 0.03265855
## hsa04390 213/9275 0.0009536247 0.04199404 0.03488227
## hsa04975  58/9275 0.0014014886 0.04199404 0.03488227
## hsa05221  86/9275 0.0014283687 0.04199404 0.03488227
##                                                                                                geneID
## hsa04072                             RAPGEF3/RAPGEF3/DGKG/MRAS/MRAS/MRAS/GRM5/GRM5/CXCL8/CXCL8/PDGFRA
## hsa04060 CXCR6/CXCR6/CXCL3/IL2RA/CXCL8/CXCL8/IL12RB2/IL12RB2/PDGFRA/CCL20/CXCL5/CXCL5/IL1R2/TNFRSF10D
## hsa04390                                        CTNNA3/CTNNA3/CTNNA3/NF2/NF2/LEF1/LEF1/BMP5/BMP5/FZD9
## hsa04975                                                        PLA2G2D/PLA2G2D/NPC1L1/NPC1L1/PLA2G1B
## hsa05221                                                        LEF1/LEF1/PPARD/PPARD/RUNX1T1/RUNX1T1
##          Count
## hsa04072    11
## hsa04060    14
## hsa04390    10
## hsa04975     5
## hsa05221     6
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>KEGG Module Enrichment Analysis</title>
      <link>http://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis</link>
      <pubDate>Wed, 13 Apr 2016 20:48:15 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;KEGG MODULE is a collection of manually defined functional units, called KEGG modules and identified by the M numbers, used for annotation and biological interpretation of sequenced genomes. There are four types of KEGG modules:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;pathway modules – representing tight functional units in KEGG metabolic pathway maps, such as M00002 (Glycolysis, core module involving three-carbon compounds)&lt;/li&gt;
&lt;li&gt;structural complexes – often forming molecular machineries, such as M00072 (Oligosaccharyltransferase)&lt;/li&gt;
&lt;li&gt;functional sets – for other types of essential sets, such as M00360 (Aminoacyl-tRNA synthases, prokaryotes)&lt;/li&gt;
&lt;li&gt;signature modules – as markers of phenotypes, such as M00363 (EHEC pathogenicity signature, Shiga toxin)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&#34;http://www.genome.jp/kegg/module.html&#34;&gt;KEGG Modules&lt;/a&gt; have a much more straightforwared interpretation in many situations and there was a &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/37&#34;&gt;feature request&lt;/a&gt; for implementing an enrichment test from clusterProfiler user. Both hypergeometric test and GSEA of KEGG Module are now supported in &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;. Just like &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;KEGG Pathway Analysis&lt;/a&gt;, clusterProfiler accesses latest online data and supports more than 2000 species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;To prevent confusing new users who may not fammiliar with KEGG, I created two new functions, &lt;em&gt;enrichMKEGG&lt;/em&gt; and &lt;em&gt;gseMKEGG&lt;/em&gt; for enrichment test of KEGG Module and keep the original functions, &lt;em&gt;enrichKEGG&lt;/em&gt; and &lt;em&gt;gseKEGG&lt;/em&gt; for KEGG pathway analysis only.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(clusterProfiler)

data(geneList)
de &amp;lt;- names(geneList)[1:100]
xx &amp;lt;- enrichMKEGG(de, organism=&#39;hsa&#39;, minGSSize=1)
head(summary(xx))

##            ID
## M00693 M00693
## M00286 M00286
## M00067 M00067
## M00691 M00691
##                                                                                    Description
## M00693                                                            Cell cycle - G2/M transition
## M00286                                                                            GINS complex
## M00067 Sulfoglycolipids biosynthesis, ceramide/1-alkyl-2-acylglycerol =&amp;gt; sulfatide/seminolipid
## M00691                                               DNA damage-induced cell cycle checkpoints
##        GeneRatio BgRatio       pvalue     p.adjust       qvalue
## M00693       3/8 10/1528 0.0000111304 5.565199e-05 1.171621e-05
## M00286       2/8  4/1528 0.0001432508 3.581269e-04 7.539514e-05
## M00067       1/8  2/1528 0.0104472034 1.741201e-02 3.665685e-03
## M00691       1/8  7/1528 0.0361484900 4.518561e-02 9.512761e-03
##              geneID Count
## M00693 9133/890/983     3
## M00286   9837/51659     2
## M00067         7368     1
## M00691         1111     1

yy &amp;lt;- gseMKEGG(geneList)

## [1] &amp;quot;calculating observed enrichment scores...&amp;quot;
## [1] &amp;quot;calculating permutation scores...&amp;quot;
## [1] &amp;quot;calculating p values...&amp;quot;
## [1] &amp;quot;done...&amp;quot;

head(summary(yy))

##            ID                     Description setSize enrichmentScore
## M00337 M00337                Immunoproteasome      15       0.7583644
## M00340 M00340   Proteasome, 20S core particle      13       0.7935026
## M00354 M00354 Spliceosome, U4/U6.U5 tri-snRNP      29       0.6053503
##             NES      pvalue   p.adjust    qvalues
## M00337 2.063359 0.002298851 0.03675214 0.02968961
## M00340 2.047060 0.002409639 0.03675214 0.02968961
## M00354 1.913834 0.002564103 0.03675214 0.02968961
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Please refer to &lt;a href=&#34;http://www.bioconductor.org/packages/devel/bioc/vignettes/clusterProfiler/inst/doc/clusterProfiler.html&#34;&gt;vignette&lt;/a&gt; for more details.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>yet an unofficial BioEdit for OSX</title>
      <link>http://guangchuangyu.github.io/2016/03/yet-an-unofficial-bioedit-for-osx</link>
      <pubDate>Wed, 30 Mar 2016 13:40:22 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/03/yet-an-unofficial-bioedit-for-osx</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.mbio.ncsu.edu/bioedit/bioedit.html&#34;&gt;&lt;img src=&#34;http://www.mbio.ncsu.edu/bioedit/Banner1.GIF&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To my knowledge, &lt;a href=&#34;http://www.mbio.ncsu.edu/bioedit/bioedit.html&#34;&gt;BioEdit&lt;/a&gt; is the most comprehensive biological sequence alignment editor. Most of my labmates run this software using &lt;code&gt;Parallels Desktop&lt;/code&gt;. For some of them, BioEdit is the only reason to install &lt;code&gt;Parallels Desktop&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I need to edit my alignment recently, and install it in my iMac using &lt;a href=&#34;https://www.winehq.org/&#34;&gt;Wine&lt;/a&gt;, which is a compatibility layer for running Windows applications on POSIX-compliant OS. Although it is famous in Linux community for many years, many OSX users never heard of it.&lt;/p&gt;

&lt;p&gt;I came out with an idea that maybe I can pack all the components into an OSX application bundle. Then I can share it with my labmates and others. I don&amp;rsquo;t need to teach them how to install and config &lt;code&gt;Wine&lt;/code&gt; and they can just drag the App to &lt;code&gt;/Applications&lt;/code&gt; and double click to run it.&lt;/p&gt;

&lt;p&gt;It took me one night to create this App. You can click &lt;a href=&#34;https://gitlab.com/GuangchuangYu/BioEdit-OSX/raw/master/BioEdit.dmg&#34;&gt;here&lt;/a&gt; to download it.&lt;/p&gt;

&lt;p&gt;As usual, you can install it by dragging the App to &lt;code&gt;Applications&lt;/code&gt; folder and open it by double click. It works just like native App.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2016/Screenshot 2016-03-30 11.30.03.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;BTW: If you don&amp;rsquo;t have &lt;a href=&#34;http://xquartz.macosforge.org/&#34;&gt;XQuartz&lt;/a&gt; installed, you need one for running &lt;code&gt;BioEdit&lt;/code&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>embed images in ggplot2 via subview and annotate a phylogenetic tree with images using inset function</title>
      <link>http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function</link>
      <pubDate>Sun, 20 Mar 2016 10:50:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function</guid>
      <description>&lt;p&gt;I extended the &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt; function to support embed image file in a &lt;code&gt;ggplot&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(123)
d = data.frame(x=rnorm(10), y=rnorm(10))

imgfile &amp;lt;- tempfile(, fileext=&amp;quot;.png&amp;quot;)
download.file(&amp;quot;https://avatars1.githubusercontent.com/u/626539?v=3&amp;amp;u=e731426406dd3f45a73d96dd604bc45ae2e7c36f&amp;amp;s=140&amp;quot;,
              destfile=imgfile, mode=&#39;wb&#39;)

p = ggplot(d, aes(x, y))
subview(p, imgfile, x=d$x[1], y=d$y[1]) + geom_point(size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/subview_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/&#34;&gt;previous post&lt;/a&gt;, I have introduced using &lt;code&gt;annotation_image&lt;/code&gt; function for annotating tips with local images.&lt;/p&gt;

&lt;p&gt;Now with the updated &lt;code&gt;subview&lt;/code&gt; function, we can use &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/&#34;&gt;inset&lt;/a&gt; function to annotate nodes/tips with image files and/or subplots.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

img &amp;lt;- list(imgfile, imgfile)
names(img) &amp;lt;- c(&amp;quot;18&amp;quot;, &amp;quot;22&amp;quot;)
inset(p, img)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/inset_with_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;PS: As I got more and more emails from ggtree users, I created a forum, &lt;a href=&#34;https://groups.google.com/forum/#!forum/bioc-ggtree&#34;&gt;https://groups.google.com/forum/#!forum/bioc-ggtree&lt;/a&gt;. With this forum, &lt;code&gt;ggtree&lt;/code&gt; users can help each others and also solutions posted in the forum can help other peoples when they google search their questions. Please join the forum and post your questions if you have any.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Font Awesome supported in emojifont</title>
      <link>http://guangchuangyu.github.io/2016/03/font-awesome-supported-in-emojifont</link>
      <pubDate>Mon, 14 Mar 2016 16:21:11 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/03/font-awesome-supported-in-emojifont</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://cran.r-project.org/package=emojifont&#34;&gt;&lt;img src=&#34;http://www.r-pkg.org/badges/version/emojifont&#34; alt=&#34;CRAN_Status_Badge&#34; /&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://cran.r-project.org/web/packages/emojifont/index.html&#34;&gt;&lt;code&gt;emojifont&lt;/code&gt;&lt;/a&gt; is available in CRAN, you can use the following command to install it.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;install.packages(&amp;quot;emojifont&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;An example of using emoji font in R plot is showed below:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2016/douban_emoji.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;More examples can be found in &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;the post&lt;/a&gt; and online &lt;a href=&#34;https://cran.r-project.org/web/packages/emojifont/vignettes/emojifont.html&#34;&gt;vignette&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I found &lt;a href=&#34;http://fontawesome.io/cheatsheet/&#34;&gt;FontAwesome&lt;/a&gt; is quite interesting especially in technical world. In &lt;code&gt;emojifont&lt;/code&gt; (version &amp;gt;= 0.3), I have packed the &lt;code&gt;Font Awesome&lt;/code&gt;. So that we can use this fancy font in both base and ggplot2 graphics.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;load.fontawesome()

set.seed(2016-03-09)
fa &amp;lt;- fontawesome(c(&#39;fa-github&#39;, &#39;fa-weibo&#39;, &#39;fa-twitter&#39;, &#39;fa-android&#39;, &#39;fa-coffee&#39;))
d &amp;lt;- data.frame(x=rnorm(20), 
                y=rnorm(20), 
                label=sample(fa, 20, replace=T))

ggplot(d, aes(x, y, color=label)) + 
    geom_text(aes(label=label), family=&#39;fontawesome-webfont&#39;)+
    xlab(NULL)+ylab(NULL)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/fontawesome.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Have fun with &lt;code&gt;emojifont&lt;/code&gt;.&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/drob&#34;&gt;@drob&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;, this is data surfing (air quality data from Lima, Peru) / fun with your cool pkgs. Thx! &lt;a href=&#34;https://t.co/ikinjxDDZL&#34;&gt;pic.twitter.com/ikinjxDDZL&lt;/a&gt;&lt;/p&gt;&amp;mdash; Maëlle Salmon (@ma_salmon) &lt;a href=&#34;https://twitter.com/ma_salmon/status/706490090609106944&#34;&gt;March 6, 2016&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;//platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>covplot supports GRangesList</title>
      <link>http://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist</link>
      <pubDate>Mon, 29 Feb 2016 11:45:08 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist</guid>
      <description>&lt;p&gt;To answer the &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/27&#34;&gt;issue&lt;/a&gt;, I extend the &lt;code&gt;covplot&lt;/code&gt; function to support viewing coverage of a list of &lt;code&gt;GRanges&lt;/code&gt; objects or &lt;code&gt;bed&lt;/code&gt; files.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ChIPseeker)
files &amp;lt;- getSampleFiles()
peak=GenomicRanges::GRangesList(CBX6=readPeakFile(files[[4]]),
                                CBX7=readPeakFile(files[[5]]))

p &amp;lt;- covplot(peak)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ChIPseeker/2016_ChIPseeker_covplot_files/unnamed-chunk-1-2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;By default, The coverage plots are merged together with different colors. Users can separate them to different panels using &lt;code&gt;facet_grid&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
col &amp;lt;- c(CBX6=&#39;red&#39;, CBX7=&#39;green&#39;)
p + facet_grid(chr ~ .id) + scale_color_manual(values=col) + scale_fill_manual(values=col)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ChIPseeker/2016_ChIPseeker_covplot_files/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>tweets of ggtree</title>
      <link>http://guangchuangyu.github.io/2016/02/tweets-of-ggtree</link>
      <pubDate>Tue, 23 Feb 2016 11:10:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/02/tweets-of-ggtree</guid>
      <description>&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Treespace visualization of a heuristic best tree search in &lt;a href=&#34;https://twitter.com/hashtag/R?src=hash&#34;&gt;#R&lt;/a&gt; package &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/phylogenetics?src=hash&#34;&gt;#phylogenetics&lt;/a&gt; &lt;a href=&#34;https://t.co/hnSJpIABql&#34;&gt;pic.twitter.com/hnSJpIABql&lt;/a&gt;&lt;/p&gt;&amp;mdash; Alex Damián (@antropoteuthis) &lt;a href=&#34;https://twitter.com/antropoteuthis/status/693123105707986944&#34;&gt;January 29, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Updated to latest &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; and very impressed! Any ideas on using geom_label with tip labels to add box/fill?&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/691762302492790788&#34;&gt;January 25, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree looks really good! &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt;&lt;a href=&#34;https://t.co/7rtexYV3I5&#34;&gt;https://t.co/7rtexYV3I5&lt;/a&gt;&lt;/p&gt;&amp;mdash; Paul Staab (@paulstaab) &lt;a href=&#34;https://twitter.com/paulstaab/status/687933344219312128&#34;&gt;January 15, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;If you’re not using ggtree by &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; for your trees in R then you should be! &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/bioinformatics?src=hash&#34;&gt;#bioinformatics&lt;/a&gt;&lt;a href=&#34;https://t.co/Z8HdLeyiIg&#34;&gt;https://t.co/Z8HdLeyiIg&lt;/a&gt;&lt;/p&gt;&amp;mdash; Matt Workentine (@mworkentine) &lt;a href=&#34;https://twitter.com/mworkentine/status/684411780412526592&#34;&gt;January 5, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; has actually changed my life! it is &lt;a href=&#34;https://twitter.com/hashtag/awesome?src=hash&#34;&gt;#awesome&lt;/a&gt;! &lt;a href=&#34;https://twitter.com/hashtag/RePlottingEveryTreeFigureEver?src=hash&#34;&gt;#RePlottingEveryTreeFigureEver&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt;&lt;/p&gt;&amp;mdash; Peter Cowman (@pete_cowman) &lt;a href=&#34;https://twitter.com/pete_cowman/status/665188011047563268&#34;&gt;November 13, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;I continue to be amazed by the speed and quality of support &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; provides for &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/664040586001915904&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/tylerrinker&#34;&gt;@tylerrinker&lt;/a&gt; really appreciate all of &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; efforts with &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;; extends well beyond its original intent; love it&lt;/p&gt;&amp;mdash; klr (@timelyportfolio) &lt;a href=&#34;https://twitter.com/timelyportfolio/status/639507420054749184&#34;&gt;September 3, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; I even used &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;!&lt;/p&gt;&amp;mdash; Simon Frost (@sdwfrost) &lt;a href=&#34;https://twitter.com/sdwfrost/status/671673570259509248&#34;&gt;December 1, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/minisciencegirl&#34;&gt;@minisciencegirl&lt;/a&gt; Yep we use it mainly for that... there&amp;#39;s a more featured version in &lt;a href=&#34;https://t.co/5oOeLwx2Hg&#34;&gt;https://t.co/5oOeLwx2Hg&lt;/a&gt; but I need to switch to ggtree!&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/667490462693912576&#34;&gt;November 19, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Sent my first &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/shiny?src=hash&#34;&gt;#shiny&lt;/a&gt; app off to be alpha tested by a colleague today. Wouldn&amp;#39;t be possible without &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;.&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/660278158663401473&#34;&gt;October 31, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/genetics_blog&#34;&gt;@genetics_blog&lt;/a&gt; Thanks. We have turned this into a shiny app too, but need to iron out some bugs... Also, try the new ggtree library!&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/641251456595685376&#34;&gt;September 8, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; My bad :( It&amp;#39;s working perfectly fine. Thanks so much for an awesome &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; package ggtree! &lt;a href=&#34;http://t.co/ofmzyOWe9C&#34;&gt;pic.twitter.com/ofmzyOWe9C&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/559734740488818688&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; A bit improved version :) &lt;a href=&#34;http://t.co/TZTSBK5aSm&#34;&gt;pic.twitter.com/TZTSBK5aSm&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/559762891478667264&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;I wish this guy was my student! &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Sure, it won&amp;#39;t get a Nature or Science paper, but who cares? &lt;a href=&#34;http://t.co/XnA7uaFVms&#34;&gt;http://t.co/XnA7uaFVms&lt;/a&gt;&lt;/p&gt;&amp;mdash; Simon Frost (@sdwfrost) &lt;a href=&#34;https://twitter.com/sdwfrost/status/561514846291001344&#34;&gt;January 31, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/CieraReports&#34;&gt;@CieraReports&lt;/a&gt; ggtree is a cool package that is based on the drawing of ggplot2 &lt;a href=&#34;https://t.co/gFPHSdGAj1&#34;&gt;https://t.co/gFPHSdGAj1&lt;/a&gt;&lt;/p&gt;&amp;mdash; ホクソうり (@u_ribo) &lt;a href=&#34;https://twitter.com/u_ribo/status/559542705663905793&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://t.co/VFrKCcz0DI&#34;&gt;https://t.co/VFrKCcz0DI&lt;/a&gt; is a pretty powerful &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Bioconductor&#34;&gt;@Bioconductor&lt;/a&gt; pkg for neat &lt;a href=&#34;https://twitter.com/hashtag/phylogenetic?src=hash&#34;&gt;#phylogenetic&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/dataviz?src=hash&#34;&gt;#dataviz&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/561056244782227456&#34;&gt;January 30, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree extends ggplot2 for phylogenetic trees. tons of documentation+examples: &lt;a href=&#34;https://t.co/y9V52s2yWd&#34;&gt;https://t.co/y9V52s2yWd&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; &lt;a href=&#34;https://t.co/Z9SDcueR2c&#34;&gt;pic.twitter.com/Z9SDcueR2c&lt;/a&gt;&lt;/p&gt;&amp;mdash; Stephen Turner (@genetics_blog) &lt;a href=&#34;https://twitter.com/genetics_blog/status/664085841766195200&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Need to visualize some trees? Recent  &lt;a href=&#34;https://twitter.com/hashtag/R?src=hash&#34;&gt;#R&lt;/a&gt; package &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; looks quite interesting. &amp;#10;&lt;a href=&#34;https://t.co/EPaXIqmvDZ&#34;&gt;https://t.co/EPaXIqmvDZ&lt;/a&gt;&lt;/p&gt;&amp;mdash; Sebastian Schmidt (@TSBSchm) &lt;a href=&#34;https://twitter.com/TSBSchm/status/664431087683260416&#34;&gt;November 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/flashton2003&#34;&gt;@flashton2003&lt;/a&gt; world of possibilities now! Also looking at ggtree (ggplot2 expansion) for future stuff - that looks really cool too&lt;/p&gt;&amp;mdash; David W. Cleary (@Bacterioskeptic) &lt;a href=&#34;https://twitter.com/Bacterioskeptic/status/667706456045694976&#34;&gt;November 20, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;time for you to learn &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/LAevolving&#34;&gt;@LAevolving&lt;/a&gt; &amp;lt;- &lt;a href=&#34;https://twitter.com/StephSpiel&#34;&gt;@StephSpiel&lt;/a&gt; new &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; package ggtree &lt;a href=&#34;https://twitter.com/ggplot2&#34;&gt;@ggplot2&lt;/a&gt; &lt;a href=&#34;https://t.co/DFmKGyTVwE&#34;&gt;https://t.co/DFmKGyTVwE&lt;/a&gt; &lt;a href=&#34;https://t.co/WRBZHlRsIa&#34;&gt;pic.twitter.com/WRBZHlRsIa&lt;/a&gt;&lt;/p&gt;&amp;mdash; Salamanda (@ajzellmer) &lt;a href=&#34;https://twitter.com/ajzellmer/status/663937183791759360&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-cards=&#34;hidden&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;V. cool new &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; package ggtree, addon 2 &lt;a href=&#34;https://twitter.com/ggplot2&#34;&gt;@ggplot2&lt;/a&gt;, for automating tree drawing/annotating &lt;a href=&#34;https://t.co/k3eSdVKp9C&#34;&gt;https://t.co/k3eSdVKp9C&lt;/a&gt; &lt;a href=&#34;https://t.co/nH8SKSaXaN&#34;&gt;pic.twitter.com/nH8SKSaXaN&lt;/a&gt;&lt;/p&gt;&amp;mdash; Stephanie Spielman (@StephSpiel) &lt;a href=&#34;https://twitter.com/StephSpiel/status/663771499589861376&#34;&gt;November 9, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-cards=&#34;hidden&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Can’t wait to try. MT &lt;a href=&#34;https://twitter.com/genetics_blog&#34;&gt;@genetics_blog&lt;/a&gt;: ggtree extends ggplot2 for phylogenetic trees: &lt;a href=&#34;https://t.co/JuThXlHUjz&#34;&gt;https://t.co/JuThXlHUjz&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; &lt;a href=&#34;https://t.co/OmAzGghvqB&#34;&gt;pic.twitter.com/OmAzGghvqB&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kent Holsinger (@keholsinger) &lt;a href=&#34;https://twitter.com/keholsinger/status/667433534756397057&#34;&gt;November 19, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Excited to discover &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;; fills a lot of holes in my workflow but not seeing how to add bootstrap from ape?&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/640573716733169664&#34;&gt;September 6, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree added cool features, My favorite is the one from BEAST output &lt;a href=&#34;https://t.co/3WOLxfTzRp&#34;&gt;https://t.co/3WOLxfTzRp&lt;/a&gt;&lt;/p&gt;&amp;mdash; Manvendra Singh (@manvendr7) &lt;a href=&#34;https://twitter.com/manvendr7/status/664407764001779712&#34;&gt;November 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree looks useful: nice viz and annotations of phylogenetic trees with ggplot  &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;http://t.co/lbNKw3qIDI&#34;&gt;http://t.co/lbNKw3qIDI&lt;/a&gt;  thanks &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;&lt;/p&gt;&amp;mdash; Julia Gustavsen (@JuliaGustavsen) &lt;a href=&#34;https://twitter.com/JuliaGustavsen/status/630500659960254464&#34;&gt;August 9, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree - looks like a very useful phylogenetic tree plotting package for R based on ggplot2 (&lt;a href=&#34;https://t.co/UCXVVmG5W7&#34;&gt;https://t.co/UCXVVmG5W7&lt;/a&gt;)&lt;/p&gt;&amp;mdash; Simon J Greenhill (@SimonJGreenhill) &lt;a href=&#34;https://twitter.com/SimonJGreenhill/status/547497335412899840&#34;&gt;December 23, 2014&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Plot trees &amp;amp; annotation (incl BEAST, time axis) with ggtree for R!&amp;#10;&lt;a href=&#34;http://t.co/9ahqKQLTaI&#34;&gt;http://t.co/9ahqKQLTaI&lt;/a&gt;&amp;#10;Well spotted &lt;a href=&#34;https://twitter.com/mackas21&#34;&gt;@mackas21&lt;/a&gt; &lt;a href=&#34;http://t.co/2ldvAiH2fj&#34;&gt;pic.twitter.com/2ldvAiH2fj&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/610364467939913728&#34;&gt;June 15, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;geom_label can be used to add label and also additional information coded in background color. &lt;a href=&#34;https://twitter.com/hashtag/ggplot?src=hash&#34;&gt;#ggplot&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;http://t.co/pGvrsmsOc1&#34;&gt;pic.twitter.com/pGvrsmsOc1&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/642152010771398656&#34;&gt;September 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;view 100 boostrap trees in 2 lines. &lt;a href=&#34;http://t.co/FKNyP5dZsb&#34;&gt;pic.twitter.com/FKNyP5dZsb&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/638628150650368000&#34;&gt;September 1, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;multiple sequence alignment with &lt;a href=&#34;https://twitter.com/hashtag/phylogenetic?src=hash&#34;&gt;#phylogenetic&lt;/a&gt; tree via &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; pkg &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;. &lt;a href=&#34;http://t.co/6CY57dLdeb&#34;&gt;pic.twitter.com/6CY57dLdeb&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/601676060254605312&#34;&gt;May 22, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization</title>
      <link>http://guangchuangyu.github.io/2016/02/reactomepa-an-r/bioconductor-package-for-reactome-pathway-analysis-and-visualization</link>
      <pubDate>Tue, 16 Feb 2016 13:10:21 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/02/reactomepa-an-r/bioconductor-package-for-reactome-pathway-analysis-and-visualization</guid>
      <description>&lt;p&gt;My R/Bioconductor package,
&lt;a href=&#34;https://github.com/GuangchuangYu/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;, published in
&lt;a href=&#34;http://pubs.rsc.org/en/content/articlelanding/2016/mb/c5mb00663e&#34;&gt;Molecular BioSystems&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ReactomePA: an R/Bioconductor package for reactome pathway analysis and visualization&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;G Yu&lt;/strong&gt;, QY He. &lt;strong&gt;&lt;em&gt;Molecular BioSystems&lt;/em&gt;&lt;/strong&gt; 2016, 12:477-479&lt;/p&gt;

&lt;p&gt;Received: 05 Oct 2015 Accepted: 20 Nov 2015 Online: 23 Nov 2015&lt;/p&gt;

&lt;p&gt;DOI: &lt;a href=&#34;http://dx.doi.org/10.1039/C5MB00663E&#34;&gt;10.1039/C5MB00663E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Reactome is a manually curated pathway annotation database for unveiling high-order biological pathways from high-throughput data. ReactomePA is an R/Bioconductor package providing enrichment analyses, including hypergeometric test and gene set enrichment analyses. A functional analysis can be applied to the genomic coordination obtained from a sequencing experiment to analyze the functional significance of genomic loci including cis-regulatory elements and non-coding regions. Comparison among different experiments is also supported. Moreover, ReactomePA provides several visualization functions to produce highly customizable, publication-quality figures. The source code and documents of ReactomePA are freely available through Bioconductor (&lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;http://www.bioconductor.org/packages/ReactomePA&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ReactomePA/c5mb00663e-f1_hi-res.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree supports phylip tree format</title>
      <link>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format</link>
      <pubDate>Fri, 15 Jan 2016 13:19:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format</guid>
      <description>&lt;p&gt;Phylip is also a widely used tree format, which contains taxa sequences with Newick tree text.&lt;/p&gt;

&lt;p&gt;In &lt;code&gt;ggtree&lt;/code&gt;, we can use &lt;code&gt;read.phylip()&lt;/code&gt; function to parse the file and use &lt;code&gt;ggtree()&lt;/code&gt; to visualize the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
phyfile &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.phy&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
phylip &amp;lt;- read.phylip(phyfile)
phylip

## &#39;phylip&#39; S4 object that stored information of
##   &#39;/Users/guangchuangyu/Library/R/3.2/library/ggtree/extdata/sample.phy&#39;.
## 
## ...@ tree: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
##  K, N, D, L, J, G, ...
## 
## Unrooted; no branch lengths.
## 
## with sequence alignment available (15 sequences of length 2148)

ggtree(phylip) + geom_tiplab()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;User can view the sequence alignment with the tree via &lt;code&gt;msaplot()&lt;/code&gt;
function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msaplot(phylip, offset=1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>label edge number in ggtree</title>
      <link>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree</link>
      <pubDate>Wed, 13 Jan 2016 11:00:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree</guid>
      <description>&lt;p&gt;This is a question from &lt;code&gt;ggtree&lt;/code&gt; user. In &lt;code&gt;ape&lt;/code&gt; and &lt;code&gt;phytools&lt;/code&gt;, it&amp;rsquo;s easy to label edge using the &lt;code&gt;edgelabels&lt;/code&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(1)
tr = rtree(30)
library(ape)
plot(tr, main=&amp;quot;ape&amp;quot;)
edgelabels()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I don&amp;rsquo;t see any necessity to label edge numbers, as they are meaningless. The number is labeled as the row index of &lt;code&gt;tr$edge&lt;/code&gt;, and edge can be uniquely mapped to child node. If we need to relate something to edge, we can relate them to corresponding child node. Node is a central hub in tree annotation in &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To label edge number, we can also attach the edge number to node and then label them as a node attribute.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
p = ggtree(tr, ladderize=F) + geom_tiplab() + ggtitle(&amp;quot;ggtree&amp;quot;)
edge=data.frame(tr$edge, edge_num=1:nrow(tr$edge))
colnames(edge)=c(&amp;quot;parent&amp;quot;, &amp;quot;node&amp;quot;, &amp;quot;edge_num&amp;quot;)
p %&amp;lt;+% edge + geom_label(aes(x=branch, label=edge_num))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Annotate a phylogenetic tree with insets</title>
      <link>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets</link>
      <pubDate>Mon, 11 Jan 2016 19:36:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets</guid>
      <description>

&lt;p&gt;&lt;code&gt;Ggtree&lt;/code&gt; implemented a function, &lt;code&gt;subview&lt;/code&gt;, that can add subplots on a
ggplot2 object. It had successful applied to &lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;plot pie graphs on map&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2016-01-04)
tr &amp;lt;- rtree(30)
tr &amp;lt;- groupClade(tr, node=45)
p &amp;lt;- ggtree(tr, aes(color=group)) + geom_tippoint()
cpos &amp;lt;- get_clade_position(p, node=45)
p1 &amp;lt;- p + geom_hilight(node=45)
p2 &amp;lt;- with(cpos, p+xlim(xmin, xmax*1.01)+ylim(ymin, ymax))
with(cpos, subview(p2+geom_tiplab(), p1+theme_transparent(), x=xmin+(xmax-xmin)*.15, y=ymin+(ymax-ymin)*.85))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;To make it more easy to use subview function for annotating taxa with
subplots, &lt;em&gt;ggtree&lt;/em&gt; provides a function, &lt;code&gt;inset&lt;/code&gt;, for adding subplots to
a phylogenetic tree. The input is a tree graphic object and a named list
of ggplot graphic objects (can be any kind of charts), these objects
should named by node numbers. To facilitate adding bar and pie charts
(e.g. summarized stats of results from ancestral reconstruction) to
phylogenetic tree, &lt;em&gt;ggtree&lt;/em&gt; provides &lt;code&gt;nodepie&lt;/code&gt; and &lt;code&gt;nodebar&lt;/code&gt; functions
to create a list of pie or bar charts.&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-bar-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with bar charts&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

a &amp;lt;- runif(14, 0, 0.33)
b &amp;lt;- runif(14, 0, 0.33)
c &amp;lt;- runif(14, 0, 0.33)
d &amp;lt;- 1 - a - b - c
dat &amp;lt;- data.frame(a=a, b=b, c=c, d=d)
## input data should have a column of `node` that store the node number
dat$node &amp;lt;- 15+1:14

## cols parameter indicate which columns store stats (a, b, c and d in this example)
bars &amp;lt;- nodebar(dat, cols=1:4)

inset(p, bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 The sizes of the insets can be ajusted by the paramter &lt;em&gt;width&lt;/em&gt; and
&lt;em&gt;height&lt;/em&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, bars, width=.03, height=.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 Users can set the color via the parameter &lt;em&gt;color&lt;/em&gt;. The &lt;em&gt;x&lt;/em&gt; position can
be one of &amp;lsquo;node&amp;rsquo; or &amp;lsquo;branch&amp;rsquo; and can be adjusted by the parameter
&lt;em&gt;hjust&lt;/em&gt; and &lt;em&gt;vjust&lt;/em&gt; for horizontal and vertical adjustment respecitvely.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bars2 &amp;lt;- nodebar(dat, cols=1:4, position=&#39;dodge&#39;,
                 color=c(a=&#39;blue&#39;, b=&#39;red&#39;, c=&#39;green&#39;, d=&#39;cyan&#39;))
p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.3)
print(p2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-pie-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with pie charts&lt;/h2&gt;

&lt;p&gt;Similarly, users can use &lt;code&gt;nodepie&lt;/code&gt; function to generate a list of pie
charts and place these charts to annotate corresponding nodes. Both
&lt;code&gt;nodebar&lt;/code&gt; and &lt;code&gt;nodepie&lt;/code&gt; accepts parameter &lt;em&gt;alpha&lt;/em&gt; to allow transparency.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies &amp;lt;- nodepie(dat, cols=1:4, alpha=.6)
inset(p, pies)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, pies, hjust=-.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-other-types-of-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with other types of charts&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;inset&lt;/code&gt; function accepts a list of ggplot graphic objects and these
input objects are not restricted to pie or bar charts. They can be any
kinds of charts and hybrid of these charts.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies_and_bars &amp;lt;- bars2
pies_and_bars[9:14] &amp;lt;- pies[9:14]
inset(p, pies_and_bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- lapply(1:15, rnorm, n=100)
ylim &amp;lt;- range(unlist(d))
bx &amp;lt;- lapply(d, function(y) {
    dd &amp;lt;- data.frame(y=y)
    ggplot(dd, aes(x=1, y=y))+geom_boxplot() + ylim(ylim) + theme_inset()
})
names(bx) &amp;lt;- 1:15
inset(p, bx, width=.03, height=.1, hjust=-.05)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-9-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After annotating with insets, users can further annotate the tree with
another layer of insets.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.4)
p2 &amp;lt;- inset(p2, pies, x=&#39;branch&#39;, vjust=.4)
bx2 &amp;lt;- lapply(bx, function(g) g+coord_flip())
inset(p2, bx2, width=.2, height=.03, vjust=.04, hjust=p2$data$x[1:15]-4) + xlim(NA, 4.5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-10-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>GO analysis using clusterProfiler</title>
      <link>http://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler</link>
      <pubDate>Mon, 04 Jan 2016 11:58:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler</guid>
      <description>

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; supports over-representation test and gene set
enrichment analysis of Gene Ontology. It supports GO annotation from
OrgDb object, GMT file and user&amp;rsquo;s own data.&lt;/p&gt;

&lt;h2 id=&#34;support-many-species:bdc631894cab1e81ad84e5406d79b479&#34;&gt;support many species&lt;/h2&gt;

&lt;p&gt;In github version of clusterProfiler, &lt;code&gt;enrichGO&lt;/code&gt; and &lt;code&gt;gseGO&lt;/code&gt; functions
removed the parameter &lt;em&gt;organism&lt;/em&gt; and add another parameter &lt;em&gt;OrgDb&lt;/em&gt;, so
that any species that have &lt;code&gt;OrgDb&lt;/code&gt; object available can be analyzed in
&lt;strong&gt;clusterProfiler&lt;/strong&gt;. Bioconductor have already provide OrgDb for about
20 species, see
&lt;a href=&#34;http://bioconductor.org/packages/release/BiocViews.html#___OrgDb&#34;&gt;http://bioconductor.org/packages/release/BiocViews.html#___OrgDb&lt;/a&gt;, and
users can build &lt;code&gt;OrgDb&lt;/code&gt; via &lt;code&gt;AnnotationHub&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(AnnotationHub)
hub &amp;lt;- AnnotationHub()

## snapshotDate(): 2015-12-29

query(hub, &amp;quot;Cricetulus&amp;quot;)

## AnnotationHub with 4 records
## # snapshotDate(): 2015-12-29 
## # $dataprovider: UCSC, Inparanoid8, ftp://ftp.ncbi.nlm.nih.gov/gene/DATA/
## # $species: Cricetulus griseus
## # $rdataclass: ChainFile, Inparanoid8Db, OrgDb, TwoBitFile
## # additional mcols(): taxonomyid, genome, description, tags,
## #   sourceurl, sourcetype 
## # retrieve records with, e.g., &#39;object[[&amp;quot;AH10393&amp;quot;]]&#39; 
## 
##             title                             
##   AH10393 | hom.Cricetulus_griseus.inp8.sqlite
##   AH13980 | criGri1.2bit                      
##   AH14346 | criGri1ToHg19.over.chain.gz       
##   AH48061 | org.Cricetulus_griseus.eg.sqlite

Cgriseus &amp;lt;- hub[[&amp;quot;AH48061&amp;quot;]]

## loading from cache &#39;/Users/guangchuangyu/.AnnotationHub/54367&#39;

Cgriseus

## OrgDb object:
## | DBSCHEMAVERSION: 2.1
## | DBSCHEMA: NOSCHEMA_DB
## | ORGANISM: Cricetulus griseus
## | SPECIES: Cricetulus griseus
## | CENTRALID: GID
## | Taxonomy ID: 10029
## | Db type: OrgDb
## | Supporting package: AnnotationDbi

## 
## Please see: help(&#39;select&#39;) for usage information

sample_gene &amp;lt;- sample(keys(Cgriseus), 100)
str(sample_gene)

##  chr [1:100] &amp;quot;100762355&amp;quot; &amp;quot;100757285&amp;quot; &amp;quot;100773870&amp;quot; &amp;quot;100766902&amp;quot; ...

library(clusterProfiler)

sample_test &amp;lt;- enrichGO(sample_gene, OrgDb=Cgriseus, pvalueCutoff=1, qvalueCutoff=1)
head(summary(sample_test))

##                    ID                                 Description
## GO:0004983 GO:0004983            neuropeptide Y receptor activity
## GO:0005254 GO:0005254                   chloride channel activity
## GO:0005496 GO:0005496                             steroid binding
## GO:0005253 GO:0005253                      anion channel activity
## GO:0015108 GO:0015108 chloride transmembrane transporter activity
## GO:0019887 GO:0019887           protein kinase regulator activity
##            GeneRatio BgRatio     pvalue  p.adjust    qvalue    geneID
## GO:0004983      1/20  6/3946 0.03004660 0.6187407 0.6138746 100773047
## GO:0005254      1/20  6/3946 0.03004660 0.6187407 0.6138746 100773701
## GO:0005496      1/20  6/3946 0.03004660 0.6187407 0.6138746 100689048
## GO:0005253      1/20  8/3946 0.03987010 0.6187407 0.6138746 100773701
## GO:0015108      1/20  8/3946 0.03987010 0.6187407 0.6138746 100773701
## GO:0019887      1/20 12/3946 0.05923425 0.6187407 0.6138746 100763034
##            Count
## GO:0004983     1
## GO:0005254     1
## GO:0005496     1
## GO:0005253     1
## GO:0015108     1
## GO:0019887     1
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;support-many-id-types:bdc631894cab1e81ad84e5406d79b479&#34;&gt;support many ID types&lt;/h2&gt;

&lt;p&gt;The input ID type can be any type that was supported in &lt;code&gt;OrgDb&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(org.Hs.eg.db)
data(geneList)
gene &amp;lt;- names(geneList)[abs(geneList) &amp;gt; 2]
gene.df &amp;lt;- bitr(gene, fromType = &amp;quot;ENTREZID&amp;quot;, 
        toType = c(&amp;quot;ENSEMBL&amp;quot;, &amp;quot;SYMBOL&amp;quot;),
        OrgDb = org.Hs.eg.db)

## &#39;select()&#39; returned 1:many mapping between keys and columns

## Warning in bitr(gene, fromType = &amp;quot;ENTREZID&amp;quot;, toType = c(&amp;quot;ENSEMBL&amp;quot;,
## &amp;quot;SYMBOL&amp;quot;), : 0.48% of input gene IDs are fail to map...

head(gene.df)

##   ENTREZID         ENSEMBL SYMBOL
## 1     4312 ENSG00000196611   MMP1
## 2     8318 ENSG00000093009  CDC45
## 3    10874 ENSG00000109255    NMU
## 4    55143 ENSG00000134690  CDCA8
## 5    55388 ENSG00000065328  MCM10
## 6      991 ENSG00000117399  CDC20

ego &amp;lt;- enrichGO(gene          = gene,
                universe      = names(geneList),
                OrgDb         = org.Hs.eg.db,
                ont           = &amp;quot;CC&amp;quot;,
                pAdjustMethod = &amp;quot;BH&amp;quot;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05)
head(summary(ego))

##                    ID                              Description GeneRatio
## GO:0005819 GO:0005819                                  spindle    24/197
## GO:0005876 GO:0005876                      spindle microtubule    11/197
## GO:0000793 GO:0000793                     condensed chromosome    17/197
## GO:0000779 GO:0000779 condensed chromosome, centromeric region    13/197
## GO:0005875 GO:0005875           microtubule associated complex    14/197
## GO:0015630 GO:0015630                 microtubule cytoskeleton    36/197
##              BgRatio       pvalue     p.adjust       qvalue
## GO:0005819 222/11632 3.810608e-13 1.276554e-10 1.139171e-10
## GO:0005876  45/11632 1.527089e-10 2.557874e-08 2.282596e-08
## GO:0000793 150/11632 5.838332e-10 6.519471e-08 5.817847e-08
## GO:0000779  81/11632 8.684319e-10 7.273117e-08 6.490386e-08
## GO:0005875 109/11632 3.936298e-09 2.637319e-07 2.353492e-07
## GO:0015630 765/11632 1.719925e-08 9.602916e-07 8.569452e-07
##                                                                                                                                                                                                       geneID
## GO:0005819                                                                   55143/991/9493/1062/259266/9787/220134/51203/22974/4751/983/4085/81930/332/3832/7272/9212/9055/3833/146909/10112/6790/891/24137
## GO:0005876                                                                                                                                       220134/51203/983/81930/332/3832/9212/9055/146909/6790/24137
## GO:0000793                                                                                                       1062/10403/7153/23397/55355/220134/4751/79019/55839/54821/4085/332/64151/9212/1111/6790/891
## GO:0000779                                                                                                                             1062/10403/55355/220134/4751/79019/55839/54821/4085/332/9212/6790/891
## GO:0005875                                                                                                                        55143/9493/1062/81930/332/3832/9212/3833/146909/10112/6790/24137/4137/7802
## GO:0015630 8318/55143/991/9493/1062/9133/7153/259266/55165/9787/220134/51203/22974/10460/4751/983/54821/4085/81930/332/3832/7272/64151/9212/1111/9055/3833/146909/10112/51514/6790/891/24137/26289/4137/7802
##            Count
## GO:0005819    24
## GO:0005876    11
## GO:0000793    17
## GO:0000779    13
## GO:0005875    14
## GO:0015630    36

ego2 &amp;lt;- enrichGO(gene         = gene.df$ENSEMBL,
                OrgDb         = org.Hs.eg.db,
                keytype       = &#39;ENSEMBL&#39;,
                ont           = &amp;quot;CC&amp;quot;,
                pAdjustMethod = &amp;quot;BH&amp;quot;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05)
head(summary(ego2))

##                    ID                              Description GeneRatio
## GO:0005819 GO:0005819                                  spindle    28/220
## GO:0005875 GO:0005875           microtubule associated complex    19/220
## GO:0005876 GO:0005876                      spindle microtubule    12/220
## GO:0015630 GO:0015630                 microtubule cytoskeleton    43/220
## GO:0005874 GO:0005874                              microtubule    26/220
## GO:0000779 GO:0000779 condensed chromosome, centromeric region    14/220
##               BgRatio       pvalue     p.adjust       qvalue
## GO:0005819  298/19428 6.831911e-18 2.336514e-15 1.812254e-15
## GO:0005875  157/19428 1.710039e-14 2.924167e-12 2.268052e-12
## GO:0005876   54/19428 7.427958e-13 8.467872e-11 6.567879e-11
## GO:0015630 1118/19428 1.228816e-12 1.050638e-10 8.148992e-11
## GO:0005874  421/19428 2.266638e-12 1.550381e-10 1.202511e-10
## GO:0000779  110/19428 2.652610e-11 1.444006e-09 1.120005e-09
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     geneID
## GO:0005819                                                                                                                                                                                                                                                 ENSG00000134690/ENSG00000117399/ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000117650/ENSG00000170312/ENSG00000164109/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000112742/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000056678/ENSG00000233450/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000134057/ENSG00000090889
## GO:0005875                                                                                                                                                                                                                                                                                                                                                                                                 ENSG00000134690/ENSG00000137807/ENSG00000138778/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000178999/ENSG00000237649/ENSG00000056678/ENSG00000233450/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000090889/ENSG00000186868/ENSG00000276155/ENSG00000277956/ENSG00000163879
## GO:0005876                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000170312/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000178999/ENSG00000198901/ENSG00000186185/ENSG00000087586/ENSG00000090889
## GO:0015630 ENSG00000093009/ENSG00000134690/ENSG00000117399/ENSG00000137807/ENSG00000138778/ENSG00000157456/ENSG00000131747/ENSG00000066279/ENSG00000138180/ENSG00000126787/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000013810/ENSG00000117650/ENSG00000170312/ENSG00000186871/ENSG00000164109/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000112742/ENSG00000109805/ENSG00000178999/ENSG00000149554/ENSG00000198901/ENSG00000237649/ENSG00000056678/ENSG00000233450/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000143476/ENSG00000087586/ENSG00000134057/ENSG00000090889/ENSG00000127603/ENSG00000154027/ENSG00000186868/ENSG00000276155/ENSG00000277956/ENSG00000163879
## GO:0005874                                                                                                                                                                                                                                                                                 ENSG00000137807/ENSG00000138778/ENSG00000066279/ENSG00000154839/ENSG00000262634/ENSG00000137804/ENSG00000088325/ENSG00000117650/ENSG00000170312/ENSG00000121621/ENSG00000089685/ENSG00000138160/ENSG00000178999/ENSG00000198901/ENSG00000237649/ENSG00000056678/ENSG00000233450/ENSG00000204197/ENSG00000186185/ENSG00000112984/ENSG00000087586/ENSG00000090889/ENSG00000127603/ENSG00000186868/ENSG00000276155/ENSG00000277956
## GO:0000779                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ENSG00000138778/ENSG00000080986/ENSG00000123485/ENSG00000154839/ENSG00000262634/ENSG00000117650/ENSG00000100162/ENSG00000166451/ENSG00000186871/ENSG00000164109/ENSG00000089685/ENSG00000178999/ENSG00000087586/ENSG00000134057
##            Count
## GO:0005819    28
## GO:0005875    19
## GO:0005876    12
## GO:0015630    43
## GO:0005874    26
## GO:0000779    14

ego3 &amp;lt;- enrichGO(gene         = gene.df$SYMBOL,
                OrgDb         = org.Hs.eg.db,
                keytype       = &#39;SYMBOL&#39;,
                ont           = &amp;quot;CC&amp;quot;,
                pAdjustMethod = &amp;quot;BH&amp;quot;,
                pvalueCutoff  = 0.01,
                qvalueCutoff  = 0.05)
head(summary(ego3))

##                    ID                              Description GeneRatio
## GO:0005819 GO:0005819                                  spindle    24/196
## GO:0005876 GO:0005876                      spindle microtubule    11/196
## GO:0000793 GO:0000793                     condensed chromosome    17/196
## GO:0000779 GO:0000779 condensed chromosome, centromeric region    13/196
## GO:0015630 GO:0015630                 microtubule cytoskeleton    36/196
## GO:0005875 GO:0005875           microtubule associated complex    14/196
##               BgRatio       pvalue     p.adjust       qvalue
## GO:0005819  278/17761 6.023611e-15 2.042004e-12 1.769039e-12
## GO:0005876   52/17761 9.080301e-12 1.539111e-09 1.333370e-09
## GO:0000793  192/17761 4.363319e-11 4.930551e-09 4.271460e-09
## GO:0000779  103/17761 1.083989e-10 9.186804e-09 7.958759e-09
## GO:0015630 1034/17761 6.842818e-10 3.952252e-08 3.423935e-08
## GO:0005875  144/17761 6.995136e-10 3.952252e-08 3.423935e-08
##                                                                                                                                                                                                                        geneID
## GO:0005819                                                                      CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A
## GO:0005876                                                                                                                                                  SKA1/NUSAP1/CDK1/KIF18A/BIRC5/KIF11/AURKB/PRC1/KIF18B/AURKA/KIF4A
## GO:0000793                                                                                                              CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/BIRC5/NCAPG/AURKB/CHEK1/AURKA/CCNB1
## GO:0000779                                                                                                                                      CENPE/NDC80/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/BIRC5/AURKB/AURKA/CCNB1
## GO:0015630 CDC45/CDCA8/CDC20/KIF23/CENPE/CCNB2/TOP2A/ASPM/CEP55/DLGAP5/SKA1/NUSAP1/TPX2/TACC3/NEK2/CDK1/ERCC6L/MAD2L1/KIF18A/BIRC5/KIF11/TTK/NCAPG/AURKB/CHEK1/PRC1/KIFC1/KIF18B/KIF20A/DTL/AURKA/CCNB1/KIF4A/AK5/MAPT/DNALI1
## GO:0005875                                                                                                                             CDCA8/KIF23/CENPE/KIF18A/BIRC5/KIF11/AURKB/KIFC1/KIF18B/KIF20A/AURKA/KIF4A/MAPT/DNALI1
##            Count
## GO:0005819    24
## GO:0005876    11
## GO:0000793    17
## GO:0000779    13
## GO:0015630    36
## GO:0005875    14
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Using &lt;code&gt;SYMBOL&lt;/code&gt; directly is not recommended. User can use &lt;code&gt;setReadable&lt;/code&gt;
function to translate &lt;code&gt;geneID&lt;/code&gt; to gene symbol.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ego &amp;lt;- setReadable(ego, OrgDb = org.Hs.eg.db)
ego2 &amp;lt;- setReadable(ego2, OrgDb = org.Hs.eg.db)
head(summary(ego), n=3)

##                    ID          Description GeneRatio   BgRatio
## GO:0005819 GO:0005819              spindle    24/197 222/11632
## GO:0005876 GO:0005876  spindle microtubule    11/197  45/11632
## GO:0000793 GO:0000793 condensed chromosome    17/197 150/11632
##                  pvalue     p.adjust       qvalue
## GO:0005819 3.810608e-13 1.276554e-10 1.139171e-10
## GO:0005876 1.527089e-10 2.557874e-08 2.282596e-08
## GO:0000793 5.838332e-10 6.519471e-08 5.817847e-08
##                                                                                                                                                   geneID
## GO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A
## GO:0005876                                                                             SKA1/NUSAP1/CDK1/KIF18A/BIRC5/KIF11/AURKB/PRC1/KIF18B/AURKA/KIF4A
## GO:0000793                                         CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/BIRC5/NCAPG/AURKB/CHEK1/AURKA/CCNB1
##            Count
## GO:0005819    24
## GO:0005876    11
## GO:0000793    17

head(summary(ego2), n=3)

##                    ID          Description GeneRatio   BgRatio
## GO:0005819 GO:0005819              spindle    24/197 222/11632
## GO:0005876 GO:0005876  spindle microtubule    11/197  45/11632
## GO:0000793 GO:0000793 condensed chromosome    17/197 150/11632
##                  pvalue     p.adjust       qvalue
## GO:0005819 3.810608e-13 1.276554e-10 1.139171e-10
## GO:0005876 1.527089e-10 2.557874e-08 2.282596e-08
## GO:0000793 5.838332e-10 6.519471e-08 5.817847e-08
##                                                                                                                                                   geneID
## GO:0005819 CDCA8/CDC20/KIF23/CENPE/ASPM/DLGAP5/SKA1/NUSAP1/TPX2/NEK2/CDK1/MAD2L1/KIF18A/BIRC5/KIF11/TTK/AURKB/PRC1/KIFC1/KIF18B/KIF20A/AURKA/CCNB1/KIF4A
## GO:0005876                                                                             SKA1/NUSAP1/CDK1/KIF18A/BIRC5/KIF11/AURKB/PRC1/KIF18B/AURKA/KIF4A
## GO:0000793                                         CENPE/NDC80/TOP2A/NCAPH/HJURP/SKA1/NEK2/CENPM/CENPN/ERCC6L/MAD2L1/BIRC5/NCAPG/AURKB/CHEK1/AURKA/CCNB1
##            Count
## GO:0005819    24
## GO:0005876    11
## GO:0000793    17
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;enrichGO&lt;/code&gt; test the whole GO corpus and enriched result may contains
very general terms. User can use &lt;code&gt;dropGO&lt;/code&gt; function to remove specific GO
terms or GO level. If user want to restrict the result at sepcific GO
level, they can use &lt;code&gt;gofilter&lt;/code&gt; function. We also provide a &lt;code&gt;simplify&lt;/code&gt;
method to reduce redundancy of enriched GO terms, see &lt;a href=&#34;http://guangchuangyu.github.io/2015/10/use-simplify-to-remove-redundancy-of-enriched-go-terms/&#34;&gt;the
post&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;visualization-functions:bdc631894cab1e81ad84e5406d79b479&#34;&gt;Visualization functions&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;dotplot(ego, showCategory=30)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/2016_GO_analysis_using_clusterProfiler_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;enrichMap(ego, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/2016_GO_analysis_using_clusterProfiler_files/figure-markdown_strict/unnamed-chunk-7-2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cnetplot(ego, foldChange=geneList)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/2016_GO_analysis_using_clusterProfiler_files/figure-markdown_strict/unnamed-chunk-7-3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;plotGOgraph(ego)

## 
## groupGOTerms:    GOBPTerm, GOMFTerm, GOCCTerm environments built.
## 
## Building most specific GOs ..... ( 335 GO terms found. )
## 
## Build GO DAG topology .......... ( 335 GO terms and 667 relations. )
## 
## Annotating nodes ............... ( 11632 genes annotated to the GO terms. )
## $dag
## A graphNEL graph with directed edges
## Number of Nodes = 29 
## Number of Edges = 50 
## 
## $complete.dag
## [1] &amp;quot;A graph with 29 nodes.&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/2016_GO_analysis_using_clusterProfiler_files/figure-markdown_strict/unnamed-chunk-7-4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;gene-set-enrichment-analysis:bdc631894cab1e81ad84e5406d79b479&#34;&gt;Gene Set Enrichment Analysis&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;gsecc &amp;lt;- gseGO(geneList=geneList, ont=&amp;quot;CC&amp;quot;, OrgDb=org.Hs.eg.db, verbose=F)
head(summary(gsecc))

##                    ID                              Description setSize
## GO:0031982 GO:0031982                                  vesicle    2880
## GO:0031988 GO:0031988                 membrane-bounded vesicle    2791
## GO:0005576 GO:0005576                     extracellular region    3296
## GO:0065010 GO:0065010 extracellular membrane-bounded organelle    2220
## GO:0070062 GO:0070062                    extracellular exosome    2220
## GO:0044421 GO:0044421                extracellular region part    2941
##            enrichmentScore       NES      pvalue   p.adjust    qvalues
## GO:0031982      -0.2561837 -1.222689 0.001002004 0.03721229 0.02816364
## GO:0031988      -0.2572169 -1.226003 0.001007049 0.03721229 0.02816364
## GO:0005576      -0.2746489 -1.312485 0.001009082 0.03721229 0.02816364
## GO:0065010      -0.2570342 -1.222048 0.001013171 0.03721229 0.02816364
## GO:0070062      -0.2570342 -1.222048 0.001013171 0.03721229 0.02816364
## GO:0044421      -0.2744658 -1.310299 0.001014199 0.03721229 0.02816364

gseaplot(gsecc, geneSetID=&amp;quot;GO:0000779&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/clusterProfiler/2016_GO_analysis_using_clusterProfiler_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;go-analysis-using-user-s-own-data:bdc631894cab1e81ad84e5406d79b479&#34;&gt;GO analysis using user&amp;rsquo;s own data&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;clusterProfiler&lt;/code&gt; provides enricher function for hypergeometric test and
GSEA function for gene set enrichment analysis that are designed to
accept user defined annotation. They accept two additional parameters
TERM2GENE and TERM2NAME. As indicated in the parameter names, TERM2GENE
is a data.frame with first column of term ID and second column of
corresponding mapped gene and TERM2NAME is a data.frame with first
column of term ID and second column of corresponding term name.
TERM2NAME is optional.&lt;/p&gt;

&lt;p&gt;An example of using enricher and GSEA to analyze DisGeNet annotation is
presented in the post, &lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;use clusterProfiler as an universal enrichment analysis tool&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;gmt-files:bdc631894cab1e81ad84e5406d79b479&#34;&gt;GMT files&lt;/h3&gt;

&lt;p&gt;We provides a function, &lt;code&gt;read.gmt&lt;/code&gt;, that can parse GMT file into a
TERM2GENE data.frame that is ready for both &lt;code&gt;enricher&lt;/code&gt; and &lt;code&gt;GSEA&lt;/code&gt;
functions.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gmtfile &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;c5.cc.v5.0.entrez.gmt&amp;quot;, package=&amp;quot;clusterProfiler&amp;quot;)
c5 &amp;lt;- read.gmt(gmtfile)
egmt &amp;lt;- enricher(gene, TERM2GENE=c5)
head(summary(egmt))

##                                                ID              Description
## SPINDLE                                   SPINDLE                  SPINDLE
## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON
## CYTOSKELETAL_PART               CYTOSKELETAL_PART        CYTOSKELETAL_PART
## SPINDLE_MICROTUBULE           SPINDLE_MICROTUBULE      SPINDLE_MICROTUBULE
## MICROTUBULE                           MICROTUBULE              MICROTUBULE
## CYTOSKELETON                         CYTOSKELETON             CYTOSKELETON
##                          GeneRatio  BgRatio       pvalue     p.adjust
## SPINDLE                      11/82  39/5270 7.667674e-12 6.594200e-10
## MICROTUBULE_CYTOSKELETON     16/82 152/5270 8.449298e-10 3.633198e-08
## CYTOSKELETAL_PART            15/82 235/5270 2.414879e-06 6.623386e-05
## SPINDLE_MICROTUBULE           5/82  16/5270 3.080645e-06 6.623386e-05
## MICROTUBULE                   6/82  32/5270 7.740446e-06 1.331357e-04
## CYTOSKELETON                 16/82 367/5270 1.308357e-04 1.826293e-03
##                                qvalue
## SPINDLE                  5.327016e-10
## MICROTUBULE_CYTOSKELETON 2.935019e-08
## CYTOSKELETAL_PART        5.350593e-05
## SPINDLE_MICROTUBULE      5.350593e-05
## MICROTUBULE              1.075515e-04
## CYTOSKELETON             1.475340e-03
##                                                                                                  geneID
## SPINDLE                                           991/9493/9787/22974/983/332/3832/7272/9055/6790/24137
## MICROTUBULE_CYTOSKELETON 991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802
## CYTOSKELETAL_PART             991/9493/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802
## SPINDLE_MICROTUBULE                                                             983/332/3832/9055/24137
## MICROTUBULE                                                                983/332/3832/9055/24137/4137
## CYTOSKELETON             991/9493/9133/7153/9787/22974/4751/983/332/3832/7272/9055/6790/24137/4137/7802
##                          Count
## SPINDLE                     11
## MICROTUBULE_CYTOSKELETON    16
## CYTOSKELETAL_PART           15
## SPINDLE_MICROTUBULE          5
## MICROTUBULE                  6
## CYTOSKELETON                16

egmt &amp;lt;- setReadable(egmt, OrgDb=org.Hs.eg.db, keytype=&amp;quot;ENTREZID&amp;quot;)
head(summary(egmt))

##                                                ID              Description
## SPINDLE                                   SPINDLE                  SPINDLE
## MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON MICROTUBULE_CYTOSKELETON
## CYTOSKELETAL_PART               CYTOSKELETAL_PART        CYTOSKELETAL_PART
## SPINDLE_MICROTUBULE           SPINDLE_MICROTUBULE      SPINDLE_MICROTUBULE
## MICROTUBULE                           MICROTUBULE              MICROTUBULE
## CYTOSKELETON                         CYTOSKELETON             CYTOSKELETON
##                          GeneRatio  BgRatio       pvalue     p.adjust
## SPINDLE                      11/82  39/5270 7.667674e-12 6.594200e-10
## MICROTUBULE_CYTOSKELETON     16/82 152/5270 8.449298e-10 3.633198e-08
## CYTOSKELETAL_PART            15/82 235/5270 2.414879e-06 6.623386e-05
## SPINDLE_MICROTUBULE           5/82  16/5270 3.080645e-06 6.623386e-05
## MICROTUBULE                   6/82  32/5270 7.740446e-06 1.331357e-04
## CYTOSKELETON                 16/82 367/5270 1.308357e-04 1.826293e-03
##                                qvalue
## SPINDLE                  5.327016e-10
## MICROTUBULE_CYTOSKELETON 2.935019e-08
## CYTOSKELETAL_PART        5.350593e-05
## SPINDLE_MICROTUBULE      5.350593e-05
## MICROTUBULE              1.075515e-04
## CYTOSKELETON             1.475340e-03
##                                                                                                              geneID
## SPINDLE                                               CDC20/KIF23/DLGAP5/TPX2/CDK1/BIRC5/KIF11/TTK/PRC1/AURKA/KIF4A
## MICROTUBULE_CYTOSKELETON CDC20/KIF23/CCNB2/TOP2A/DLGAP5/TPX2/NEK2/CDK1/BIRC5/KIF11/TTK/PRC1/AURKA/KIF4A/MAPT/DNALI1
## CYTOSKELETAL_PART              CDC20/KIF23/TOP2A/DLGAP5/TPX2/NEK2/CDK1/BIRC5/KIF11/TTK/PRC1/AURKA/KIF4A/MAPT/DNALI1
## SPINDLE_MICROTUBULE                                                                     CDK1/BIRC5/KIF11/PRC1/KIF4A
## MICROTUBULE                                                                        CDK1/BIRC5/KIF11/PRC1/KIF4A/MAPT
## CYTOSKELETON             CDC20/KIF23/CCNB2/TOP2A/DLGAP5/TPX2/NEK2/CDK1/BIRC5/KIF11/TTK/PRC1/AURKA/KIF4A/MAPT/DNALI1
##                          Count
## SPINDLE                     11
## MICROTUBULE_CYTOSKELETON    16
## CYTOSKELETAL_PART           15
## SPINDLE_MICROTUBULE          5
## MICROTUBULE                  6
## CYTOSKELETON                16

gsegmt &amp;lt;- GSEA(geneList, TERM2GENE=c5, verbose=F)
head(summary(gsegmt))

##                                                                    ID
## EXTRACELLULAR_REGION                             EXTRACELLULAR_REGION
## EXTRACELLULAR_REGION_PART                   EXTRACELLULAR_REGION_PART
## CELL_PROJECTION                                       CELL_PROJECTION
## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX
## EXTRACELLULAR_MATRIX                             EXTRACELLULAR_MATRIX
## EXTRACELLULAR_MATRIX_PART                   EXTRACELLULAR_MATRIX_PART
##                                                           Description
## EXTRACELLULAR_REGION                             EXTRACELLULAR_REGION
## EXTRACELLULAR_REGION_PART                   EXTRACELLULAR_REGION_PART
## CELL_PROJECTION                                       CELL_PROJECTION
## PROTEINACEOUS_EXTRACELLULAR_MATRIX PROTEINACEOUS_EXTRACELLULAR_MATRIX
## EXTRACELLULAR_MATRIX                             EXTRACELLULAR_MATRIX
## EXTRACELLULAR_MATRIX_PART                   EXTRACELLULAR_MATRIX_PART
##                                    setSize enrichmentScore       NES
## EXTRACELLULAR_REGION                   401      -0.3860230 -1.694496
## EXTRACELLULAR_REGION_PART              310      -0.4101043 -1.761338
## CELL_PROJECTION                         87      -0.4729701 -1.739867
## PROTEINACEOUS_EXTRACELLULAR_MATRIX      93      -0.6355317 -2.365007
## EXTRACELLULAR_MATRIX                    95      -0.6229461 -2.318356
## EXTRACELLULAR_MATRIX_PART               54      -0.5908035 -2.002728
##                                         pvalue   p.adjust    qvalues
## EXTRACELLULAR_REGION               0.001310616 0.03192152 0.02442263
## EXTRACELLULAR_REGION_PART          0.001375516 0.03192152 0.02442263
## CELL_PROJECTION                    0.001503759 0.03192152 0.02442263
## PROTEINACEOUS_EXTRACELLULAR_MATRIX 0.001555210 0.03192152 0.02442263
## EXTRACELLULAR_MATRIX               0.001557632 0.03192152 0.02442263
## EXTRACELLULAR_MATRIX_PART          0.001631321 0.03192152 0.02442263
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>News of ggtree</title>
      <link>http://guangchuangyu.github.io/2015/12/news-of-ggtree</link>
      <pubDate>Wed, 30 Dec 2015 14:11:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/news-of-ggtree</guid>
      <description>

&lt;p&gt;A new version of &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt; that works with ggplot2 (version &amp;gt;= 2.0.0) is now availabel.&lt;/p&gt;

&lt;h2 id=&#34;new-layers:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;new layers&lt;/h2&gt;

&lt;p&gt;Some functions, &lt;em&gt;add_legend&lt;/em&gt;, &lt;em&gt;hilight&lt;/em&gt;, &lt;em&gt;annotation_clade&lt;/em&gt; and &lt;em&gt;annotation_clade2&lt;/em&gt; were removed. Instead we provide layer functions, &lt;code&gt;geom_treescale&lt;/code&gt;, &lt;code&gt;geom_hilight&lt;/code&gt; and &lt;code&gt;geom_cladelabel&lt;/code&gt;. You can use &lt;code&gt;+&lt;/code&gt; operator to add layers using these layer functions.&lt;/p&gt;

&lt;p&gt;In addtion, we provide &lt;code&gt;geom_point2&lt;/code&gt;, &lt;code&gt;geom_text2&lt;/code&gt; and &lt;code&gt;geom_segment2&lt;/code&gt; which works exactly as &lt;code&gt;geom_point&lt;/code&gt;, &lt;code&gt;geom_text&lt;/code&gt; and &lt;code&gt;geom_segment&lt;/code&gt; except they allow ggtree users to do &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;subsetting&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;rescale-tree:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;rescale tree&lt;/h2&gt;

&lt;p&gt;Most of the phylogenetic trees are scaled by evolutionary distance (substitution/site), in &lt;code&gt;ggtree&lt;/code&gt; we can re-scale a phylogenetic tree by any numerical variable inferred by evolutionary analysis. For example using substitution rate to scale a time-scaled tree inferred by BEAST, or using &lt;em&gt;dN/dS&lt;/em&gt; to re-scale a tree analyzed by CodeML.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screenshot%202015-12-30%2014.17.34.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;new-hampshire-extended-format-nhx-supported:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;New Hampshire eXtended format (NHX) supported&lt;/h2&gt;

&lt;p&gt;This is a &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/27&#34;&gt;feature request&lt;/a&gt; from &lt;code&gt;ggtree&lt;/code&gt; user. The NHX format is also commonly used in phylogenetic software (e.g. PHYLODOG, RevBayes, &lt;em&gt;etc&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screenshot 2015-12-30 14.25.45.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The original vignette was too long and I split them into several short ones. These vignettes should be more easy to follow. You can access the vignette via &lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;. More examples and detail explanation were provided. If there are something that I didn&amp;rsquo;t explain well or if you have suggestions for changes or improvements, &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues&#34;&gt;submit an issue&lt;/a&gt;, or (even better) fork &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt;, make modifications and submit a pull request.
I appreciate your help in improving &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Repo: &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;https://github.com/GuangchuangYu/ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;vignettes

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>use emoji font in R</title>
      <link>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r</link>
      <pubDate>Wed, 16 Dec 2015 11:11:11 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2015/Screenshot 2015-12-16 10.55.49.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I have played with emoji in &lt;code&gt;R&lt;/code&gt; for a while. My solution of using it is different from what implemented in &lt;a href=&#34;https://github.com/dill/emoGG/&#34;&gt;emoGG&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;emoGG&lt;/code&gt; is a good attemp to add &lt;code&gt;emoji&lt;/code&gt; in &lt;code&gt;ggplot2&lt;/code&gt;. It render &lt;code&gt;emoji&lt;/code&gt; picture (png) and creat a layer, &lt;code&gt;geom_emoji&lt;/code&gt;, to add emoji.&lt;/p&gt;

&lt;p&gt;In my opinion, &lt;code&gt;emoji&lt;/code&gt; should be treated as ordinary font in user interface, albeit it maynot be true internally.&lt;/p&gt;

&lt;p&gt;It would be more flexible if we can use emoji as ordinary font and in this way user don&amp;rsquo;t need to learn extra stuff.&lt;/p&gt;

&lt;p&gt;I implemented my solution of using &lt;code&gt;emoji&lt;/code&gt; in the R package &lt;a href=&#34;https://github.com/GuangchuangYu/emojifont&#34;&gt;emojifont&lt;/a&gt;. The package is very simple, pack some emoji fonts (currently only &lt;a href=&#34;https://github.com/MorbZ/OpenSansEmoji&#34;&gt;OpenSansEmoji.ttf&lt;/a&gt;) and use &lt;a href=&#34;https://github.com/yixuan/showtext&#34;&gt;showtext&lt;/a&gt; to render the fonts, then we can use the font in either base plot or ggplot2.&lt;/p&gt;

&lt;h1 id=&#34;emojifont:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;emojifont&lt;/h1&gt;

&lt;h2 id=&#34;installation:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Installation&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;devtools::install_github(&amp;quot;GuangchuangYu/emojifont&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;load-emoji-font:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;load Emoji font&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;library(emojifont)
## list available emoji fonts
list.emojifonts()

## [1] &amp;quot;OpenSansEmoji.ttf&amp;quot;

## load selected emoji font
load.emojifont(&#39;OpenSansEmoji.ttf&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;emoji-characters:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji characters&lt;/h1&gt;

&lt;p&gt;To use &lt;code&gt;emoji&lt;/code&gt;, we need to use their corresponding unicode. Emoji unicode can be found in &lt;a href=&#34;http://apps.timwhitlock.info/emoji/tables/unicode&#34;&gt;http://apps.timwhitlock.info/emoji/tables/unicode&lt;/a&gt;, or searched using &lt;a href=&#34;https://github.com/richfitz/remoji&#34;&gt;remoji&lt;/a&gt; package.&lt;/p&gt;

&lt;h1 id=&#34;emoji-in-r-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji in R plot&lt;/h1&gt;

&lt;h2 id=&#34;base-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;base plot&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;require(remoji)
set.seed(123)
x &amp;lt;- rnorm(10)
set.seed(321)
y &amp;lt;- rnorm(10)
plot(x, y, cex=0)
text(x, y, labels=emoji(&#39;cow&#39;), cex=1.5, col=&#39;steelblue&#39;, family=&#39;OpenSansEmoji&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/base_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggplot2:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggplot2&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- data.frame(x=x, y=y,
     label = sample(c(emoji(&#39;cow&#39;), emoji(&#39;camel&#39;)), 10, replace=TRUE),
     type = sample(LETTERS[1:3], 10, replace=TRUE))
require(ggplot2)
ggplot(d, aes(x, y, color=type, label=label)) + 
    geom_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/ggplot_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can also use &lt;code&gt;emoji&lt;/code&gt; in title, legend or axis label.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dd=data.frame(x=emoji(c(&amp;quot;satisfied&amp;quot;, &amp;quot;disapointed&amp;quot;)), y=c(50, 10))
emoji_text=element_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=20)
ggplot(dd, aes(x, y)) + geom_bar(stat=&#39;identity&#39;, aes(fill=x)) + 
     ggtitle(paste(emoji(c(&amp;quot;+1&amp;quot;, &amp;quot;-1&amp;quot;)), collapse=&amp;quot; &amp;quot;))+ 
        theme(axis.text.x = emoji_text, legend.text=emoji_text, title=emoji_text) + 
            xlab(NULL)+ylab(NULL)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2015/Screenshot 2015-12-16 11.10.51.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggtree:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggtree&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;require(ggtree)
require(colorspace)

tree_text=paste0(
    &amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,
       &amp;quot;(&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&amp;quot;cow&amp;quot;), &amp;quot;,&amp;quot;,
               &amp;quot;(&amp;quot;,
                  emoji(&amp;quot;whale&amp;quot;),&amp;quot;,&amp;quot;,
                  emoji(&amp;quot;dolphin&amp;quot;),
               &amp;quot;)&amp;quot;,
            &amp;quot;),&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&#39;pig2&#39;),&amp;quot;,&amp;quot;,
               emoji(&#39;boar&#39;),
            &amp;quot;)&amp;quot;,
       &amp;quot;),&amp;quot;,
       emoji(&amp;quot;camel&amp;quot;),
    &amp;quot;),&amp;quot;, emoji(&amp;quot;fish&amp;quot;), &amp;quot;),&amp;quot;, 
emoji(&amp;quot;seedling&amp;quot;), &amp;quot;);&amp;quot;)

ggtree(read.tree(text=tree_text)) + xlim(NA, 7) +
   geom_tiplab(family=&amp;quot;OpenSansEmoji&amp;quot;, size=10,
               color=rainbow_hcl(8))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/ggtree_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h1 id=&#34;apple-color-emoji:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Apple Color Emoji&lt;/h1&gt;

&lt;p&gt;Although &lt;code&gt;R&lt;/code&gt;&amp;rsquo;s graphical devices don&amp;rsquo;t support &lt;code&gt;AppleColorEmoji&lt;/code&gt; font, it&amp;rsquo;s still possible to use it. We can export the &lt;code&gt;plot&lt;/code&gt; to &lt;code&gt;svg&lt;/code&gt; file and render it in &lt;code&gt;Safari&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(gridSVG)
p &amp;lt;-  ggtree(read.tree(text=tree_text), size=2) + geom_tiplab(size=20)
p &amp;lt;- p %&amp;gt;% phylopic(&amp;quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&amp;quot;, color=&amp;quot;firebrick&amp;quot;, alpha = .3)
p &amp;lt;- p + xlim(NA, 7) + ylim(NA, 8.5)
p
ps = grid.export(&amp;quot;emoji.svg&amp;quot;, addClass=T)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/apple_emoji.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>