<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ggtree on Guangchuang Yu</title>
    <link>http://guangchuangyu.github.io/tags/ggtree/</link>
    <description>Recent content in Ggtree on Guangchuang Yu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 05 May 2016 20:13:57 +0800</lastBuildDate>
    <atom:link href="http://guangchuangyu.github.io/tags/ggtree/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>BioC 3.3: NEWS of my packages</title>
      <link>http://guangchuangyu.github.io/2016/05/bioc-3.3-news-of-my-packages/</link>
      <pubDate>Thu, 05 May 2016 20:13:57 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/05/bioc-3.3-news-of-my-packages/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/MISC/ke.jpg&#34; width=600&gt;&lt;/p&gt;

&lt;p&gt;Today is my birthday and it happened to be the release day of Bioconductor 3.3. It&amp;rsquo;s again the time to reflect what I&amp;rsquo;ve done in the past year.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/DOSE&#34;&gt;DOSE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;(http://guangchuangyu.github.io/ggtree&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;chipseeker:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ChIPseeker&lt;/h2&gt;

&lt;p&gt;Although ChIPseeker was designed for ChIP-seq annotation, I am very glad to find that someone else use it to annotate other data including &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/32&#34;&gt;copy number variants&lt;/a&gt; and &lt;a href=&#34;https://github.com/GuangchuangYu/ChIPseeker/issues/17&#34;&gt;DNA breakpoints&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;annotatepeak:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;annotatePeak&lt;/h3&gt;

&lt;p&gt;Several parameters including &lt;code&gt;sameStrand&lt;/code&gt;,&lt;code&gt;ignoreOverlap&lt;/code&gt;, &lt;code&gt;ignoreUpstream&lt;/code&gt; and &lt;code&gt;ignoreDownstream&lt;/code&gt; were added in &lt;code&gt;annotatePeak&lt;/code&gt; requested by &lt;a href=&#34;https://github.com/crazyhottommy&#34;&gt;@crazyhottommy&lt;/a&gt; for using ChIPseeker to annotate breakpoints from whole genome sequencing data.&lt;/p&gt;

&lt;p&gt;Another parameter &lt;code&gt;overlap&lt;/code&gt; was also introduced. By default &lt;code&gt;overlap=&amp;quot;TSS&amp;quot;&lt;/code&gt; and only overlap with TSS will be reported as the nearest gene. If &lt;code&gt;overlap=&amp;quot;all&amp;quot;&lt;/code&gt;, then gene overlap with peak will be reported as nearest gene, no matter the overlap is at TSS region or not.&lt;/p&gt;

&lt;p&gt;Now &lt;code&gt;annotatePeak&lt;/code&gt; also support using user&amp;rsquo;s customize regions to annotate their data by passing &lt;code&gt;TxDb=user_defined_GRanges&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;getbioregion:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;getBioRegion&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;getPromoters()&lt;/code&gt; function prepare a &lt;code&gt;GRanges&lt;/code&gt; object of promoter regions by user specific upstream and downstream distance from Transcript Start Site (TSS). Then we can align the peaks that are mapping to these regions and visualize the profile or heatmap of ChIP binding to the TSS regions.&lt;/p&gt;

&lt;p&gt;Users (&lt;a href=&#34;https://support.bioconductor.org/p/73069/#73157&#34;&gt;1&lt;/a&gt; and &lt;a href=&#34;https://support.bioconductor.org/p/73377/&#34;&gt;2&lt;/a&gt;) are interesting in the intensity of peaks binding to the start of intron/exon, and ChIPseeker provides a new function &lt;code&gt;getBioRegion&lt;/code&gt; to output &lt;code&gt;GRanges&lt;/code&gt; object of Intron/Exon start regions.&lt;/p&gt;

&lt;h3 id=&#34;visualization:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;visualization&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize &lt;a href=&#34;http://guangchuangyu.github.io/2015/07/upsetplot-in-chipseeker/&#34;&gt;ChIP annotation overlap&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;covplot&lt;/code&gt; now support &lt;a href=&#34;http://guangchuangyu.github.io/2016/02/covplot-supports-grangeslist/&#34;&gt;GRangesList&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;geo-data-mining:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GEO data mining&lt;/h3&gt;

&lt;p&gt;ChIPseeker incorporates GEO database and supports data mining to infer cooperative regulation. The data was updated and now ChIPseeker contains 19348 bed file information.&lt;/p&gt;

&lt;h2 id=&#34;clusterprofiler:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;clusterProfiler&lt;/h2&gt;

&lt;p&gt;We compare clusterProfiler with GSEA-P (which released by broad institute), the p-values calculated by these two software is &lt;a href=&#34;http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;almost identical&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For comparing biological themes, &lt;code&gt;clusterProfiler&lt;/code&gt; supports formula to express complex conditions and facet is supported to &lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/32&#34;&gt;visualize complex result&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;read.gmt&lt;/code&gt; function for parsing GMT file format from &lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;, so that gene set collections in this database can be used in &lt;code&gt;clusterProfiler&lt;/code&gt; for both hypergeometric test and GSEA.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis/&#34;&gt;KEGG Module&lt;/a&gt; was supported just like the KEGG Pathway, &lt;code&gt;clusterProfiler&lt;/code&gt; will query the online annotation data which keep the annotation data alwasy updated.&lt;/p&gt;

&lt;p&gt;The KEGG database was updated quite frequently. The &lt;code&gt;KEGG.db&lt;/code&gt; which was not updated since 2012, it contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2014/08/why-clusterprofiler-fails/&#34;&gt;5894 human genes&lt;/a&gt;. In Feb. 2015, when &lt;code&gt;clusterProfiler&lt;/code&gt; first supports querying online KEGG data, KEGG contains annotation of &lt;a href=&#34;http://guangchuangyu.github.io/2015/02/kegg-enrichment-analysis-with-latest-online-data-using-clusterprofiler/&#34;&gt;6861 human genes&lt;/a&gt; and today it has &lt;strong&gt;7018&lt;/strong&gt; human genes annotated. Most of the tools/webservers used out-dated data (e.g. DAVID not updated since 2010), the analyzed result may totally changed if we use a recently updated data. Indeed &lt;code&gt;clusterProfiler&lt;/code&gt; is more reliable as we always use the latest data.&lt;/p&gt;

&lt;p&gt;In addition to &lt;code&gt;bitr&lt;/code&gt; function that can translate biological ID using &lt;code&gt;OrgDb&lt;/code&gt; object, we provides &lt;a href=&#34;http://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler/&#34;&gt;bitr_kegg&lt;/a&gt; that uses KEGG API for translating biological ID. It supports more than 4000 species (can be search via the &lt;code&gt;search_kegg_species&lt;/code&gt; function) as in KEGG Pathway and Module analysis.&lt;/p&gt;

&lt;p&gt;The function called of &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler/&#34;&gt;enrichGO and gseGO&lt;/a&gt; was changed. Now not only species that have OrgDb available in Bioconductor can be analyzed but also all species that have an OrgDb can be analyzed which can be query online via &lt;code&gt;AnnotationHub&lt;/code&gt; or build with user&amp;rsquo;s own data. With this update, &lt;code&gt;enrichGO&lt;/code&gt; and &lt;code&gt;gseGO&lt;/code&gt; can input any gene ID type if only the ID type was supported in the &lt;code&gt;OrgDb&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;GO enrichment analysis alwasy output redundant terms, we implemented a &lt;code&gt;simplify&lt;/code&gt; function to remove redundant terms by calculating GO semantic similarity using &lt;code&gt;GOSemSim&lt;/code&gt;. Several useful utilities include &lt;code&gt;dropGO&lt;/code&gt;, &lt;code&gt;go2ont&lt;/code&gt;, &lt;code&gt;go2term&lt;/code&gt;, &lt;code&gt;gofilter&lt;/code&gt; and &lt;code&gt;gsfilter&lt;/code&gt; are also provided.&lt;/p&gt;

&lt;p&gt;I bump the version to 3.0.0 the following three reasons:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the changes of function calls&lt;/li&gt;
&lt;li&gt;can analyze any ontology/pathway annotation&lt;/li&gt;
&lt;li&gt;can analyze all speices&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Although the package is very simple when I published it, I keep update and add new features from my own idea or user&amp;rsquo;s request. Now this package is indeed in good shape. Here is the summary.&lt;/p&gt;

&lt;p&gt;This package implements methods to analyze and visualize functional profiles of genomic coordinates (supported by &lt;a href=&#34;http://www.bioconductor.org/packages/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt;), gene and gene clusters.&lt;/p&gt;

&lt;p&gt;clusterProfiler supports both &lt;em&gt;hypergeometric test&lt;/em&gt; and &lt;em&gt;Gene Set Enrichment Analysis&lt;/em&gt; for many ontologies/pathways, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Disease Ontology (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://ncg.kcl.ac.uk/&#34;&gt;Network of Cancer Gene&lt;/a&gt; (via &lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Gene Ontology (supports many species with GO annotation query online via &lt;a href=&#34;https://bioconductor.org/packages/AnnotationHub/&#34;&gt;AnnotationHub&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;KEGG Pathway and Module with latest online data (supports more than 2000 species listed in &lt;a href=&#34;http://www.genome.jp/kegg/catalog/org_list.html&#34;&gt;http://www.genome.jp/kegg/catalog/org_list.html&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Reactome Pathway (via &lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;DAVID (via &lt;a href=&#34;http://www.bioconductor.org/packages/RDAVIDWebService&#34;&gt;RDAVIDWebService&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://software.broadinstitute.org/gsea/msigdb&#34;&gt;Molecular Signatures Database&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;hallmark gene sets&lt;/li&gt;
&lt;li&gt;positional gene sets&lt;/li&gt;
&lt;li&gt;curated gene sets&lt;/li&gt;
&lt;li&gt;motif gene sets&lt;/li&gt;
&lt;li&gt;computational gene sets&lt;/li&gt;
&lt;li&gt;GO gene sets&lt;/li&gt;
&lt;li&gt;oncogenic signatures&lt;/li&gt;
&lt;li&gt;immunologic signatures&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Other Annotations

&lt;ul&gt;
&lt;li&gt;from other sources (e.g. &lt;a href=&#34;http://www.disgenet.org/web/DisGeNET/menu/home&#34;&gt;DisGeNET&lt;/a&gt; as &lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;an example&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;user&amp;rsquo;s annotation&lt;/li&gt;
&lt;li&gt;customized ontology&lt;/li&gt;
&lt;li&gt;and many others&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;clusterProfiler&lt;/em&gt; also provides several visualization methods to help interpreting enriched results, including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;barplot&lt;/li&gt;
&lt;li&gt;cnetplot&lt;/li&gt;
&lt;li&gt;dotplot&lt;/li&gt;
&lt;li&gt;enrichMap&lt;/li&gt;
&lt;li&gt;gseaplot&lt;/li&gt;
&lt;li&gt;plotGOgraph (via &lt;a href=&#34;http://www.bioconductor.org/packages/topGO&#34;&gt;topGO&lt;/a&gt; package)&lt;/li&gt;
&lt;li&gt;upsetplot&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and several useful utilities:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;bitr (Biological Id TranslatoR)&lt;/li&gt;
&lt;li&gt;bitr_kegg (bitr using KEGG source)&lt;/li&gt;
&lt;li&gt;compareCluster (biological theme comparison)&lt;/li&gt;
&lt;li&gt;dropGO (screen out GO term of specific level or specific term)&lt;/li&gt;
&lt;li&gt;go2ont (convert GO ID to Ontology)&lt;/li&gt;
&lt;li&gt;go2term (convert GO ID to descriptive term)&lt;/li&gt;
&lt;li&gt;gofilter (restrict result at specific GO level)&lt;/li&gt;
&lt;li&gt;gsfilter (restrict result by gene set size)&lt;/li&gt;
&lt;li&gt;search_kegg_organism (search kegg supported organism)&lt;/li&gt;
&lt;li&gt;setReadable (convert IDs stored &lt;code&gt;enrichResult&lt;/code&gt; object to gene symbol)&lt;/li&gt;
&lt;li&gt;simplify (remove redundant GO terms, supported via &lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;dose:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;DOSE&lt;/h2&gt;

&lt;p&gt;DOSE now test bimodal separately in GSEA and the output pvalues are &lt;a href=&#34;(http://guangchuangyu.github.io/2015/11/comparison-of-clusterprofiler-and-gsea-p/&#34;&gt;more conserved&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;maxGSSize&lt;/code&gt; parameter was added, with default value of &lt;code&gt;500&lt;/code&gt;. Usually if the geneset &amp;gt; 500, its probability of being called significant by GSEA rises quite dramatically.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;gsfilter&lt;/code&gt; function for restricting enriched results with minimal and maximal gene set sizes.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;upsetplot&lt;/code&gt; was implemented to visualize overlap of enriched gene sets.&lt;/p&gt;

&lt;p&gt;The dot sizes in &lt;code&gt;enrichMap&lt;/code&gt; now scaled by category sizes&lt;/p&gt;

&lt;h2 id=&#34;ggtree:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ggtree&lt;/h2&gt;

&lt;p&gt;I put more efforts to extend &lt;code&gt;ggtree&lt;/code&gt; than the sum of all other packages. Here listed the major new features while small improvement and bug fixed can be found in the NEWS file.&lt;/p&gt;

&lt;h3 id=&#34;io:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;IO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;support &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;NHX&lt;/a&gt; file format via &lt;code&gt;read.nhx&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;support &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/&#34;&gt;phylip&lt;/a&gt; tree format via &lt;code&gt;read.phylip&lt;/code&gt; function&lt;/li&gt;
&lt;li&gt;raxml2nwk for converting raxml bootstrap tree to newick text&lt;/li&gt;
&lt;li&gt;all parser functions support passing &lt;code&gt;textConnection(text_string)&lt;/code&gt; as a file&lt;/li&gt;
&lt;li&gt;support &lt;code&gt;ape&lt;/code&gt; bootstrap analysis&lt;/li&gt;
&lt;li&gt;support annotating tree with ancestral sequences inferred by &lt;code&gt;phangorn&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;support obkData object defined by OutbreakTools package&lt;/li&gt;
&lt;li&gt;support phyloseq object defined by phyloseq package&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;layers:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;layers&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;geom_point2,geom_text2, geom_segment2 and geom_label2 to &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;support subsetting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;geom_treescale for adding scale of branch length&lt;/li&gt;
&lt;li&gt;geom_cladelabel for labeling selected clade&lt;/li&gt;
&lt;li&gt;geom_tiplab2 for adding tiplab of circular tree&lt;/li&gt;
&lt;li&gt;geom_taxalink for connecting related taxa&lt;/li&gt;
&lt;li&gt;geom_range for adding range to present uncertainty of branch lengths&lt;/li&gt;
&lt;li&gt;subview and inset now support annotating with &lt;a href=&#34;http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function/&#34;&gt;image files&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;utilities:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;utilities&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/12/news-of-ggtree/&#34;&gt;rescale_tree&lt;/a&gt; function to rescale branch lengths using numerical variable&lt;/li&gt;
&lt;li&gt;MRCA for finding Most Recent Common Ancestor among a vector of tips&lt;/li&gt;
&lt;li&gt;viewClade to zoom in a selected clade&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;vignettes:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;vignettes&lt;/h3&gt;

&lt;p&gt;Split the long vignette to several small ones and add more examples.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/ggtree.html&#34;&gt;ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bioconductor.org/packages/devel/bioc/vignettes/ggtree/inst/doc/advanceTreeAnnotation.html&#34;&gt;Advance Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Here is the NEWS record:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CHANGES IN VERSION 1.3.16
------------------------
 o geom_treescale() supports family argument &amp;lt;2016-04-27, Wed&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/56
 o update fortify.phylo to work with phylo that has missing value of edge length &amp;lt;2016-04-21, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/54
 o support passing textConnection(text_string) as a file &amp;lt;2016-04-21, Thu&amp;gt;
   + contributed by Casey Dunn &amp;lt;casey_dunn@brown.edu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/pull/55#issuecomment-212859693
 
CHANGES IN VERSION 1.3.15
------------------------
 o geom_tiplab2 supports parameter hjust &amp;lt;2016-04-18, Mon&amp;gt;
 o geom_tiplab and geom_tiplab2 support using geom_label2 by passing geom=&amp;quot;label&amp;quot; &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_label2 that support subsetting &amp;lt;2016-04-07, Thu&amp;gt;
 o geom_tiplab2 for adding tip label of circular layout &amp;lt;2016-04-06, Wed&amp;gt;
 o use plot$plot_env to access ggplot2 parameter &amp;lt;2016-04-06, Wed&amp;gt;
 o geom_taxalink for connecting related taxa &amp;lt;2016-04-01, Fri&amp;gt; 
 o geom_range for adding range of HPD to present uncertainty of evolutionary inference &amp;lt;2016-04-01, Fri&amp;gt;
 
CHANGES IN VERSION 1.3.14
------------------------
 o geom_tiplab works with NA values, compatible with collapse &amp;lt;2016-03-05, Sat&amp;gt;
 o update theme_tree2 due to the issue of https://github.com/hadley/ggplot2/issues/1567 &amp;lt;2016-03-05, Sat&amp;gt;
 o offset works in `align=FFALSE` with `annotation_image` function &amp;lt;2016-02-23, Tue&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/46
 o subview and inset now supports annotating with img files &amp;lt;2016-02-23, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.13
------------------------
 o add example of rescale_tree function in treeAnnotation.Rmd &amp;lt;2016-02-07, Sun&amp;gt;
 o geom_cladelabel works with collapse &amp;lt;2016-02-07, Sun&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/38 

CHANGES IN VERSION 1.3.12
------------------------
 o exchange function name of geom_tree and geom_tree2  &amp;lt;2016-01-25, Mon&amp;gt;
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/hadley/ggplot2/issues/1512
 o colnames_level parameter in gheatmap &amp;lt;2016-01-25, Mon&amp;gt;
 o raxml2nwk function for converting raxml bootstrap tree to newick format &amp;lt;2016-01-25, Mon&amp;gt; 
 
CHANGES IN VERSION 1.3.11
------------------------
 o solved issues of geom_tree2 &amp;lt;2016-01-25, Mon&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/36
 o change compute_group() to compute_panel in geom_tree2() &amp;lt;2016-01-21, Thu&amp;gt;
   + fixed issue, https://github.com/GuangchuangYu/ggtree/issues/36
 o support phyloseq object &amp;lt;2016-01-21, Thu&amp;gt;
 o update geom_point2, geom_text2 and geom_segment2 to support setup_tree_data &amp;lt;2016-01-21, Thu&amp;gt;
 o implement geom_tree2 layer that support duplicated node records via the setup_tree_data function &amp;lt;2016-01-21, Thu&amp;gt;
 o rescale_tree function for rescaling branch length of tree object &amp;lt;2016-01-20, Wed&amp;gt;
 o upgrade set_branch_length, now branch can be rescaled using feature in extraInfo slot &amp;lt;2016-01-20, Wed&amp;gt;
 
CHANGES IN VERSION 1.3.10
------------------------
 o remove dependency of gridExtra by implementing multiplot function instead of using grid.arrange &amp;lt;2016-01-20, Wed&amp;gt;
 o remove dependency of colorspace &amp;lt;2016-01-20, Wed&amp;gt;
 o support phylip tree format and update vignette of phylip example &amp;lt;2016-01-15, Fri&amp;gt;

CHANGES IN VERSION 1.3.9
------------------------
 o optimize getYcoord &amp;lt;2016-01-14, Thu&amp;gt;
 o add &#39;multiPhylo&#39; example in &#39;Tree Visualization&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o viewClade, scaleClade, collapse, expand, rotate, flip, get_taxa_name and scale_x_ggtree accepts input tree_view=NULL.
   these function will access the last plot if tree_view=NULL. &amp;lt;2016-01-13, Wed&amp;gt;
   + &amp;gt; ggtree(rtree(30)); viewClade(node=35) works. no need to pipe.
 
CHANGES IN VERSION 1.3.8
------------------------
 o add example of viewClade in &#39;Tree Manipulation&#39; vignette &amp;lt;2016-01-13, Wed&amp;gt;
 o add viewClade function &amp;lt;2016-01-12, Tue&amp;gt;
 o support obkData object defined by OutbreakTools &amp;lt;2016-01-12, Tue&amp;gt;
 o update vignettes &amp;lt;2016-01-07, Thu&amp;gt;
 o 05 advance tree annotation vignette &amp;lt;2016-01-04, Mon&amp;gt;
 o export theme_inset &amp;lt;2016-01-04, Mon&amp;gt;
 o inset, nodebar, nodepie functions &amp;lt;2015-12-31, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.7
------------------------
 o split the long vignette to several vignettes
   + 00 ggtree &amp;lt;2015-12-29, Tue&amp;gt;
   + 01 tree data import &amp;lt;2015-12-28, Mon&amp;gt;
   + 02 tree visualization &amp;lt;2015-12-28, Mon&amp;gt;
   + 03 tree manipulation &amp;lt;2015-12-28, Mon&amp;gt;
   + 04 tree annotation &amp;lt;2015-12-29, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.6
------------------------
 o MRCA function for finding Most Recent Common Ancestor among a vector of tips &amp;lt;2015-12-22, Tue&amp;gt;
 o geom_cladelabel: add bar and label to annotate a clade &amp;lt;2015-12-21, Mon&amp;gt;
   - remove annotation_clade and annotation_clade2 functions.
 o geom_treescale: tree scale layer. (add_legend was removed) &amp;lt;2015-12-21, Mon&amp;gt;
 
CHANGES IN VERSION 1.3.5
------------------------
 o bug fixed, read.nhx now works with scientific notation &amp;lt;2015-11-30, Mon&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/30

CHANGES IN VERSION 1.3.4
------------------------
 o rename beast feature when name conflict with reserve keywords (label, branch, etc) &amp;lt;2015-11-27, Fri&amp;gt;
 o get_clade_position function &amp;lt;2015-11-26, Thu&amp;gt;
   + https://github.com/GuangchuangYu/ggtree/issues/28
 o get_heatmap_column_position function &amp;lt;2015-11-25, Wed&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/26
 o support NHX (New Hampshire X) format via read.nhx function &amp;lt;2015-11-17, Tue&amp;gt;
 o bug fixed in extract.treeinfo.jplace &amp;lt;2015-11-17, Thu&amp;gt;
 
CHANGES IN VERSION 1.3.3
------------------------
 o support color=NULL in gheatmap, then no colored line will draw within the heatmap &amp;lt;2015-10-30, Fri&amp;gt;
 o add `angle` for also rectangular, so that it will be available for layout=&#39;rectangular&#39; following by coord_polar() &amp;lt;2015-10-27, Tue&amp;gt;
 
CHANGES IN VERSION 1.3.2
------------------------
 o update vignette, add example of ape bootstrap and phangorn ancestral sequences &amp;lt;2015-10-26, Mon&amp;gt;
 o add support of ape bootstrap analysis &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/20
 o add support of ancestral sequences inferred by phangorn &amp;lt;2015-10-26, Mon&amp;gt;
   see https://github.com/GuangchuangYu/ggtree/issues/21
 
CHANGES IN VERSION 1.3.1
------------------------
 o change angle to angle + 90, so that label will in radial direction &amp;lt;2015-10-22, Thu&amp;gt;
   + see https://github.com/GuangchuangYu/ggtree/issues/17
 o na.rm should be always passed to layer(), fixed it in geom_hilight and geom_text2 &amp;lt;2015-10-21, Wed&amp;gt;
   + see https://github.com/hadley/ggplot2/issues/1380
 o matching beast stats with tree using internal node number instead of label &amp;lt;2015-10-20, Tue&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;gosemsim:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;GOSemSim&lt;/h2&gt;

&lt;p&gt;update IC data using update OrgDb packages.&lt;/p&gt;

&lt;h2 id=&#34;reactomepa:de4254a6abb9a1c947b7d959d55455bd&#34;&gt;ReactomePA&lt;/h2&gt;

&lt;p&gt;Internal implementation was updated according to the change of &lt;code&gt;DOSE&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;We published ReactomePA in &lt;a href=&#34;http://pubs.rsc.org/en/Content/ArticleLanding/2016/MB/C5MB00663E&#34;&gt;Molecular BioSystems&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>embed images in ggplot2 via subview and annotate a phylogenetic tree with images using inset function</title>
      <link>http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function/</link>
      <pubDate>Sun, 20 Mar 2016 10:50:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/03/embed-images-in-ggplot2-via-subview-and-annotate-a-phylogenetic-tree-with-images-using-inset-function/</guid>
      <description>&lt;p&gt;I extended the &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt; function to support embed image file in a &lt;code&gt;ggplot&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(123)
d = data.frame(x=rnorm(10), y=rnorm(10))

imgfile &amp;lt;- tempfile(, fileext=&amp;quot;.png&amp;quot;)
download.file(&amp;quot;https://avatars1.githubusercontent.com/u/626539?v=3&amp;amp;u=e731426406dd3f45a73d96dd604bc45ae2e7c36f&amp;amp;s=140&amp;quot;,
              destfile=imgfile, mode=&#39;wb&#39;)

p = ggplot(d, aes(x, y))
subview(p, imgfile, x=d$x[1], y=d$y[1]) + geom_point(size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/subview_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/&#34;&gt;previous post&lt;/a&gt;, I have introduced using &lt;code&gt;annotation_image&lt;/code&gt; function for annotating tips with local images.&lt;/p&gt;

&lt;p&gt;Now with the updated &lt;code&gt;subview&lt;/code&gt; function, we can use &lt;a href=&#34;http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/&#34;&gt;inset&lt;/a&gt; function to annotate nodes/tips with image files and/or subplots.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

img &amp;lt;- list(imgfile, imgfile)
names(img) &amp;lt;- c(&amp;quot;18&amp;quot;, &amp;quot;22&amp;quot;)
inset(p, img)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/inset_with_img.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;PS: As I got more and more emails from ggtree users, I created a forum, &lt;a href=&#34;https://groups.google.com/forum/#!forum/bioc-ggtree&#34;&gt;https://groups.google.com/forum/#!forum/bioc-ggtree&lt;/a&gt;. With this forum, &lt;code&gt;ggtree&lt;/code&gt; users can help each others and also solutions posted in the forum can help other peoples when they google search their questions. Please join the forum and post your questions if you have any.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>使用ggtree实现进化树的可视化和注释</title>
      <link>http://guangchuangyu.github.io/2016/03/%E4%BD%BF%E7%94%A8ggtree%E5%AE%9E%E7%8E%B0%E8%BF%9B%E5%8C%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%92%8C%E6%B3%A8%E9%87%8A/</link>
      <pubDate>Wed, 09 Mar 2016 13:17:48 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/03/%E4%BD%BF%E7%94%A8ggtree%E5%AE%9E%E7%8E%B0%E8%BF%9B%E5%8C%96%E6%A0%91%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%92%8C%E6%B3%A8%E9%87%8A/</guid>
      <description>

&lt;blockquote&gt;
&lt;p&gt;本文受魏太云（&lt;a href=&#34;http://www.weibo.com/taiyun&#34;&gt;@cloud_wei&lt;/a&gt;)的邀请，最初发表于&lt;a href=&#34;http://cos.name/2015/11/to-achieve-the-visualization-and-annotation-of-evolutionary-tree-using-ggtree/&#34;&gt;统计之都&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;文章最后提到的可以在图上嵌入小图，比如饼图，柱状图等，&lt;a href=&#34;http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/&#34;&gt;已经实现&lt;/a&gt;, 也可以使用用户自己图片来嵌入注释。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;进化树看起来和层次聚类很像。有必要解释一下两者的一些区别。&lt;/p&gt;

&lt;p&gt;层次聚类的侧重点在于分类，把距离近的聚在一起。而进化树的构建可以说也是一个聚类过程，但侧重点在于推测进化关系和进化距离(evolutionary
distance)。&lt;/p&gt;

&lt;p&gt;层次聚类的输入是距离，比如euclidean或manhattan距离。把距离近的聚在一起。而进化树推断是从生物序列（DNA或氨基酸）的比对开始。最简单的方法是计算一下序列中不匹配的数目，称之为hamming
distance（通常用序列长度做归一化），使用距离当然也可以应用层次聚类的方法。进化树的构建最简单的方法是非加权配对平均法（Unweighted
Pair Group Method with Arithmetic Mean, UPGMA），这其实是使用average
linkage的层次聚类。这种方法在进化树推断上现在基本没人用。更为常用的是邻接法（neighbor
joining），两个节点距离其它节点都比较远，而这两个节点又比较近，它们就是neighbor，可以看出neighbor不一定是距离最近的两个节点。真正做进化的人，这个方法也基本不用。现在主流的方法是最大似然法(Maximum
likelihood, ML)，通过进化模型（evolutionary
model)估计拓朴结构和分支长度，估计的结果具有最高的概率能够产生观测数据（多序列比对）。另外还有最大简约法和贝叶斯推断等方法用于构建进化树。&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://evolution.genetics.washington.edu/phylip/newicktree.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://evolution.genetics.washington.edu/phylip/newicktree.html&#34;&gt;Newick&lt;/a&gt;是最常用的存储进化树的文件格式，如上面这个树，拓朴结构用newick格式可以表示为：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(B,(A,C,E),D);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;括号最外层是根节点，它有三个子节点，&lt;code&gt;B&lt;/code&gt;,
&lt;code&gt;(A,C,E)&lt;/code&gt;和&lt;code&gt;D&lt;/code&gt;，而节点&lt;code&gt;(A,C,E)&lt;/code&gt;也有三个子节点&lt;code&gt;A&lt;/code&gt;，&lt;code&gt;C&lt;/code&gt;和&lt;code&gt;E&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;加上分支长度，使用&lt;code&gt;:&lt;/code&gt;来分隔：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(B:6.0,(A:5.0,C:3.0,E:4.0):5.0,D:11.0);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;比如&lt;code&gt;A:5.0&lt;/code&gt;代表的是&lt;code&gt;A&lt;/code&gt;与其父节点的距离是&lt;code&gt;5.0&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;内部节点也可以有label，写在相应的括号外面，如下所示：&lt;/p&gt;

&lt;p&gt;&lt;code&gt;(B:6.0,(A:5.0,C:3.0,E:4.0)Ancestor1:5.0,D:11.0);&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;这是最为广泛支持的文件格式，很多进化树可视软件只支持newick格式。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;的开发源自于我需要在树上做注释，发现并没有软件可以很容易地实现，通常情况下我们把统计信息加到节点的label上来展示，比如CodeML的dN/dS分析，输出文件里就给用户准备了newick树文本，把dN/dS
( &lt;em&gt;ω&lt;/em&gt; ) 加于节点label之上:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;codeml_file &amp;lt;- system.file(&amp;quot;extdata/PAML_Codeml/mlc&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree_text &amp;lt;- readLines(codeml_file)[375:376]
tree_text

## [1] &amp;quot;w ratios as labels for TreeView:&amp;quot;                                                                                                                                                                                                                                                                                         
## [2] &amp;quot;(K #0.0224 , N #0.0095 , (D #0.0385 , (L #0.0001 , (J #0.0457 , (G #0.1621 , ((C #0.0461 , (E #0.0641 , O #0.0538 ) #0.0001 ) #0.0395 , (H #0.1028 , (I #0.0001 , (B #0.0001 , (A #0.0646 , (F #0.2980 , M #0.0738 ) #0.0453 ) #0.0863 ) #1.5591 ) #0.0001 ) #0.0001 ) #0.0549 ) #0.0419 ) #0.0001 ) #0.0964 ) #0.0129 );&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这种做法只能展示一元信息，而且修改节点label真心是个脏活，满满的都是不爽，我心中理想的方式是树与注释信息分开，注释信息可以方便地通过图层加上去，而且可以自由组合。于是着手开发&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;。&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;是个简单易用的R包，一行代码&lt;code&gt;ggtree(read.tree(file))&lt;/code&gt;即可实现树的可视化。而注释通过图层来实现，多个图层可以完成复杂的注释，这得力于&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;的设计。其中最重要的一点是如何来解析进化树。&lt;/p&gt;

&lt;h2 id=&#34;ggtree的设计:d1d9992be5d6848a0489ec268963cadb&#34;&gt;ggtree的设计&lt;/h2&gt;

&lt;h3 id=&#34;进化树的解析:d1d9992be5d6848a0489ec268963cadb&#34;&gt;进化树的解析&lt;/h3&gt;

&lt;p&gt;除了&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;之外，我所了解到的其它画树软件在画树的时候都把树当成是线条的集合。很明显画出来的进化树就是在画一堆线条，但是线条表示的是父节点和子节点的关系，除此之外没有任何意义，而节点在进化树上代表物种，叶子节点是我们构建进化树的物种，内部节点是根据叶子节点推断的共同祖先。我们所有的进化分析、推断、实验都是针对节点，节点才是进化树上有意义的实体。这是&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;设计的基础，&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;只映射节点到坐标系统中，而线条在&lt;code&gt;geom_tree&lt;/code&gt;图层中计算并画出来。这是与其它软件最根本的不同，也是ggtree能够简单地用图层加注释信息的基础。&lt;/p&gt;

&lt;h3 id=&#34;扩展ggplot2:d1d9992be5d6848a0489ec268963cadb&#34;&gt;扩展ggplot2&lt;/h3&gt;

&lt;p&gt;有很多可视化包基于ggplot2实现，包括各种&lt;code&gt;gg&lt;/code&gt;打头的，号称扩展了ggplot2，支持图形语法(grammar
of
graphics)，我并不认同。虽然基于&lt;code&gt;ggplot2&lt;/code&gt;产生的图，我们可以用&lt;code&gt;theme&lt;/code&gt;来进一步调整细节，用&lt;code&gt;scale_&lt;/code&gt;系列函数来调整颜色和标尺的映射，但这些不足以称之为&amp;rsquo;支持图形语法&amp;rsquo;，图形语法最关键核心的部分我认为是图层和映射。&lt;/p&gt;

&lt;p&gt;像&lt;code&gt;ggphylo&lt;/code&gt;,
&lt;code&gt;OutbreakTools&lt;/code&gt;和&lt;code&gt;phyloseq&lt;/code&gt;这几个包都有基于ggplot2的画树函数，但其实都不支持图形语法，它们所实现的是复杂的函数，画完就完事了，用户并不能使用图层来添加相关的信息。&lt;/p&gt;

&lt;p&gt;如果在&lt;code&gt;OutbreakTools&lt;/code&gt;这个包中：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;if (show.tip.label) {
    p &amp;lt;- p + geom_text(data = df.tip, aes(x = x, y = y, label = label),
                       hjust = 0, size = tip.label.size)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;如果&lt;code&gt;show.tip.label=FALSE&lt;/code&gt;，当函数返回&lt;code&gt;p&lt;/code&gt;时&lt;code&gt;df.tip&lt;/code&gt;就被扔掉，用户想要再加&lt;code&gt;tip.label&lt;/code&gt;就不可能了。&lt;code&gt;ggphylo&lt;/code&gt;和&lt;code&gt;phyloseq&lt;/code&gt;都是类似的实现，这些包把树解析为线条，所以节点相关的信息需要额外的&lt;code&gt;data.frame&lt;/code&gt;来存储，并且只有极少数的预设参数，比如上面例子中的&lt;code&gt;tip.label&lt;/code&gt;。在上面的例子中，用户连更改&lt;code&gt;tip.label&lt;/code&gt;的颜色都不可能，更别说使用额外的注释信息了。&lt;/p&gt;

&lt;p&gt;这几个包所实现的画图函数，都可以很容易地用&lt;code&gt;ggtree&lt;/code&gt;实现，并用经过测试，ggtree运行速度比这几个包都要快。更多信息请参考&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/wiki/Why-ggtree-is-special%3F&#34;&gt;ggtree的wiki页面&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggtree&lt;/code&gt;是真正扩展&lt;code&gt;ggplot2&lt;/code&gt;，支持图形语法的包。我们首先扩展ggplot支持tree
object做为输入，并实现&lt;code&gt;geom_tree&lt;/code&gt;图层来画线条。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
library(ggtree)
set.seed(2015-11-26)
tree &amp;lt;- rtree(30)
ggplot(tree, aes(x, y)) + geom_tree()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;ggtree函数是&lt;code&gt;ggplot() + geom_tree() + xlab(NA) + ylab(NA) + theme_tree()&lt;/code&gt;的简单组合。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggtree(tree)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;想要加&lt;code&gt;tip.label&lt;/code&gt;，用&lt;code&gt;geom_tiplab&lt;/code&gt;图层，并且ggplot2的图层都可以直接应用于&lt;code&gt;ggtree&lt;/code&gt;。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggtree(tree) + geom_tiplab() + geom_point(color=&#39;firebrick&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;树的操作与注释:d1d9992be5d6848a0489ec268963cadb&#34;&gt;树的操作与注释&lt;/h2&gt;

&lt;p&gt;ggtree提供了多个函数可以把clade放大缩小(scaleClade)，折叠(collapse)和展开(expand)，位置调换和旋转，以及分类(groupOTU,
groupClade)。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nwk &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.nwk&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree &amp;lt;- read.tree(nwk)
p &amp;lt;- ggtree(tree)
cp &amp;lt;- ggtree(tree) %&amp;gt;% collapse(node=21) + ggtitle(&#39;collapse&#39;)
ep &amp;lt;- cp %&amp;gt;% expand(node=21) + ggtitle(&#39;expand&#39;)
hp &amp;lt;- p + geom_hilight(node=21) + ggtitle(&#39;hilight&#39;)
rp &amp;lt;- hp %&amp;gt;% rotate(node=21) + ggtitle(&#39;rotate&#39;)
library(gridExtra)
grid.arrange(cp, ep, hp, rp, ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;支持多种文件格式:d1d9992be5d6848a0489ec268963cadb&#34;&gt;支持多种文件格式&lt;/h2&gt;

&lt;p&gt;ggtree支持的文件格式包括Newick, Nexus, NHX和jplace。&lt;/p&gt;

&lt;p&gt;上面已经展示了Newick格式，下面的例子是NHX格式：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nhxfile = system.file(&amp;quot;extdata&amp;quot;, &amp;quot;ADH.nhx&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
nhx &amp;lt;- read.nhx(nhxfile)
ggtree(nhx, ladderize=F) + geom_tiplab() + geom_point(aes(color=S), size=8, alpha=.3) + 
    theme(legend.position=&amp;quot;right&amp;quot;) + 
        geom_text(aes(label=branch.length, x=branch), vjust=-.5) + 
           xlim(NA, 0.3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h2 id=&#34;支持解析多种软件的输出文件:d1d9992be5d6848a0489ec268963cadb&#34;&gt;支持解析多种软件的输出文件&lt;/h2&gt;

&lt;p&gt;我们知道FigTree是针对&lt;a href=&#34;http://guangchuangyu.github.io/2015/04/an-example-of-drawing-beast-tree-using-ggtree/&#34;&gt;BEAST&lt;/a&gt;的输出设计的，可以把BEAST的统计推断拿来给树做注释，但很多的进化分析软件并没有相应的画树软件支持，用户很难把信息展示出来。&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ggtree&lt;/code&gt;支持&lt;code&gt;ape&lt;/code&gt;, &lt;code&gt;phangorn&lt;/code&gt;, &lt;code&gt;r8s&lt;/code&gt;, &lt;code&gt;RAxML&lt;/code&gt;, &lt;code&gt;PAML&lt;/code&gt;, &lt;code&gt;HYPHY&lt;/code&gt;, &lt;code&gt;EPA&lt;/code&gt;,
&lt;code&gt;pplacer&lt;/code&gt;和&lt;code&gt;BEAST&lt;/code&gt;的输出。相应的统计分析结果可以应用于树的注释。可以说&lt;code&gt;ggtree&lt;/code&gt;把这些软件分析的结果带给了R用户，通过ggtree的解析，
这些进化分析结果可以进一点在R里进行处理和统计分析，并不单单是在ggtree中展示而已。&lt;/p&gt;

&lt;h3 id=&#34;raxml-bootstrap分析:d1d9992be5d6848a0489ec268963cadb&#34;&gt;RAxML bootstrap分析&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;raxml_file &amp;lt;- system.file(&amp;quot;extdata/RAxML&amp;quot;, &amp;quot;RAxML_bipartitionsBranchLabels.H3&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
raxml &amp;lt;- read.raxml(raxml_file)
ggtree(raxml) + geom_text(aes(label=bootstrap, color=bootstrap)) + 
    scale_color_gradient(high=&#39;red&#39;, low=&#39;darkgreen&#39;) + 
       theme(legend.position=&#39;right&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;multiPhylo&lt;/code&gt;也是支持的，所以100颗bootstrap树可以同时用一行代码展示出来。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;btree_file &amp;lt;- system.file(&amp;quot;extdata/RAxML&amp;quot;, &amp;quot;RAxML_bootstrap.H3&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
btree = read.tree(btree_file)
ggtree(btree) + facet_wrap(~.id, ncol=10)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;如果不分面，这100颗树会重叠画在一起，这也能很好地展示bootstrap分析的结果，bootstrap值低的clade，线条会比较乱，而bootstrap值高的地方，线条一致性比较好。&lt;/p&gt;

&lt;h3 id=&#34;paml:d1d9992be5d6848a0489ec268963cadb&#34;&gt;PAML&lt;/h3&gt;

&lt;p&gt;使用BaseML预测的祖先序列，ggtree解析结果的同时会把父节点到子节点的subsitution给统计出来，可以直接在树上注释：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Baseml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
rst &amp;lt;- read.paml_rst(rstfile)
p &amp;lt;- ggtree(rst) + geom_text(aes(label=marginal_AA_subs, x=branch), vjust=-.5)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-9-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;不同于BaseML以碱基为单位，CodeML预测祖先序列，以密码子为单位。&lt;code&gt;ggtree&lt;/code&gt;定义了一个操作符&lt;a href=&#34;http://guangchuangyu.github.io/2015/02/ggtree-updating-a-tree-view-using--operator/&#34;&gt;%&amp;lt;%&lt;/a&gt;，如果有相同的注释信息要展示，可以用tree
object来更新tree view。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rstfile &amp;lt;- system.file(&amp;quot;extdata/PAML_Codeml&amp;quot;, &amp;quot;rst&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
crst &amp;lt;- read.paml_rst(rstfile)
p %&amp;lt;% crst
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-10-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;
像上面的例子，用&lt;code&gt;crst&lt;/code&gt;来更新&lt;code&gt;p&lt;/code&gt;，就是用&lt;code&gt;crst&lt;/code&gt;画出来的树+注释。对比两图，可以发现BaseML和CodeML推测的祖先序列是稍有不同的。&lt;/p&gt;

&lt;p&gt;CodeML的dN/dS分析，我们可以直接把数据拿来给树上色。同样道理分类数据也可以拿来上色。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mlc_file &amp;lt;- system.file(&amp;quot;examples/mlc&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
mlc &amp;lt;- read.codeml_mlc(mlc_file) 
ggtree(mlc, aes(color=dN_vs_dS)) + 
   scale_color_continuous(limits=c(0, 1.5), high=&#39;red&#39;, low=&#39;green&#39;, oob=scales::squish, name=&#39;dN/dS&#39;) + 
      theme(legend.position=&#39;right&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-11-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;h3 id=&#34;使用用户定义数据:d1d9992be5d6848a0489ec268963cadb&#34;&gt;使用用户定义数据&lt;/h3&gt;

&lt;p&gt;进化树已经被广泛应用于各种跨学科的研究中，随着实验技术的发展，各种数据也更易于获得，使用用户数据注释进化树，也是ggtree所支持的。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;nwk &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.nwk&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
tree &amp;lt;- read.tree(nwk)
p &amp;lt;- ggtree(tree)

dd &amp;lt;- data.frame(taxa  = LETTERS[1:13], 
             place = c(rep(&amp;quot;GZ&amp;quot;, 5), rep(&amp;quot;HK&amp;quot;, 3), rep(&amp;quot;CZ&amp;quot;, 4), NA),
                 value = round(abs(rnorm(13, mean=70, sd=10)), digits=1))
## you don&#39;t need to order the data
## data was reshuffled just for demonstration
dd &amp;lt;- dd[sample(1:13, 13), ]
row.names(dd) &amp;lt;- NULL
print(dd)

##    taxa place value
## 1     A    GZ  68.8
## 2     J    CZ  56.8
## 3     L    CZ  74.7
## 4     C    GZ  53.3
## 5     F    HK  62.8
## 6     B    GZ  60.8
## 7     E    GZ  87.1
## 8     M  &amp;lt;NA&amp;gt;  70.9
## 9     H    HK  67.0
## 10    G    HK  59.8
## 11    I    CZ  77.7
## 12    K    CZ  69.8
## 13    D    GZ  66.3
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;在上面的例子中，使用一个分类数据和一个连续型数据，输入的唯一要求是第一列是taxon
label。ggtree中定义了操作符&lt;code&gt;%&amp;lt;+%&lt;/code&gt;，来添加数据。添加之后，用户的数据对ggplot是可见的。可以用于树的注释。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- p %&amp;lt;+% dd + geom_text(aes(color=place, label=label), hjust=-0.5) + 
       geom_tippoint(aes(size=value, shape=place, color=place), alpha=0.25)
p+theme(legend.position=&amp;quot;right&amp;quot;)       
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-13-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;ggtree还支持用户把自己的数据和树保存为jplace格式。&lt;/p&gt;

&lt;p&gt;更多的实例请参考&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/vignettes/ggtree/inst/doc/ggtree.html#tree-annotation-with-output-from-evolution-software&#34;&gt;vignette&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;ggtree允许把不同软件的分析结果整合在一起，同时在树上展示或者比较结果。在我们提交的论文中，使用了整合BEAST和CodeML的例子，在树上展示dN/dS、时间轴、氨基酸替换、clade
support values、物种和基因型
(genotype）等多维信息，6种不同的信息同时展示在一颗进化树上，这是个复杂的例子，我们在附件1中展示了可重复的代码。如果有兴趣，可以留意一下我们的文章。
:)&lt;/p&gt;

&lt;h2 id=&#34;其它好玩的功能:d1d9992be5d6848a0489ec268963cadb&#34;&gt;其它好玩的功能&lt;/h2&gt;

&lt;p&gt;我们把树当成节点的集合，而不是线条的集合，这一点回归到了进化树的本质意义上，使这一实现成为可能。而支持图形语法，与ggplot2的无缝衔接又让注释变得更加容易。&lt;code&gt;ggtree&lt;/code&gt;为我们打开了各种注释和操作的可能性。甚至于可以创造出好玩的图，比如使用showtext来&lt;a href=&#34;http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/&#34;&gt;加载图形化的字体&lt;/a&gt;、&lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;用emoji来画树&lt;/a&gt;、&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/&#34;&gt;使用图片来注释树&lt;/a&gt;等等。&lt;/p&gt;

&lt;p&gt;一个比较正经又好玩的是使用PhyloPic数据库上的图形。&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pp &amp;lt;- ggtree(tree) %&amp;gt;% phylopic(&amp;quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&amp;quot;, color=&amp;quot;steelblue&amp;quot;, alpha = .3)
pp + geom_tiplab(align=T, linetype=&#39;dashed&#39;, linesize=.5) + geom_tippoint(color=&#39;firebrick&#39;, size=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/ggtree_cos_files/figure-markdown_strict/unnamed-chunk-14-1.png&#34; alt=&#34;&#34; /&gt;&lt;!-- --&gt;&lt;/p&gt;

&lt;p&gt;另一个好玩又为我们展现各种可能性的是&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt;函数，它使得图上加小图变得特别容易。并且已经被应用于&lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;地图上加饼图&lt;/a&gt;。解决这个问题的初衷在于，想要给节点加饼图注释。有了subview函数之后，这会变得很容易，当然我还没有写出给节点加饼图的函数，因为我还没有这个需求，得有一些实际的数据做参考，这样才能够设计出更易用的函数呈现给用户。&lt;/p&gt;

&lt;p&gt;很多的功能还在开发之中，有问题/建议请及时在&lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues&#34;&gt;Github&lt;/a&gt;上报告(中英文都可以)。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>tweets of ggtree</title>
      <link>http://guangchuangyu.github.io/2016/02/tweets-of-ggtree/</link>
      <pubDate>Tue, 23 Feb 2016 11:10:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/02/tweets-of-ggtree/</guid>
      <description>&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Treespace visualization of a heuristic best tree search in &lt;a href=&#34;https://twitter.com/hashtag/R?src=hash&#34;&gt;#R&lt;/a&gt; package &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/phylogenetics?src=hash&#34;&gt;#phylogenetics&lt;/a&gt; &lt;a href=&#34;https://t.co/hnSJpIABql&#34;&gt;pic.twitter.com/hnSJpIABql&lt;/a&gt;&lt;/p&gt;&amp;mdash; Alex Damián (@antropoteuthis) &lt;a href=&#34;https://twitter.com/antropoteuthis/status/693123105707986944&#34;&gt;January 29, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Updated to latest &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; and very impressed! Any ideas on using geom_label with tip labels to add box/fill?&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/691762302492790788&#34;&gt;January 25, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree looks really good! &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt;&lt;a href=&#34;https://t.co/7rtexYV3I5&#34;&gt;https://t.co/7rtexYV3I5&lt;/a&gt;&lt;/p&gt;&amp;mdash; Paul Staab (@paulstaab) &lt;a href=&#34;https://twitter.com/paulstaab/status/687933344219312128&#34;&gt;January 15, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;If you’re not using ggtree by &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; for your trees in R then you should be! &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/bioinformatics?src=hash&#34;&gt;#bioinformatics&lt;/a&gt;&lt;a href=&#34;https://t.co/Z8HdLeyiIg&#34;&gt;https://t.co/Z8HdLeyiIg&lt;/a&gt;&lt;/p&gt;&amp;mdash; Matt Workentine (@mworkentine) &lt;a href=&#34;https://twitter.com/mworkentine/status/684411780412526592&#34;&gt;January 5, 2016&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; has actually changed my life! it is &lt;a href=&#34;https://twitter.com/hashtag/awesome?src=hash&#34;&gt;#awesome&lt;/a&gt;! &lt;a href=&#34;https://twitter.com/hashtag/RePlottingEveryTreeFigureEver?src=hash&#34;&gt;#RePlottingEveryTreeFigureEver&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt;&lt;/p&gt;&amp;mdash; Peter Cowman (@pete_cowman) &lt;a href=&#34;https://twitter.com/pete_cowman/status/665188011047563268&#34;&gt;November 13, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;I continue to be amazed by the speed and quality of support &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; provides for &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/664040586001915904&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/tylerrinker&#34;&gt;@tylerrinker&lt;/a&gt; really appreciate all of &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; efforts with &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;; extends well beyond its original intent; love it&lt;/p&gt;&amp;mdash; klr (@timelyportfolio) &lt;a href=&#34;https://twitter.com/timelyportfolio/status/639507420054749184&#34;&gt;September 3, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; I even used &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;!&lt;/p&gt;&amp;mdash; Simon Frost (@sdwfrost) &lt;a href=&#34;https://twitter.com/sdwfrost/status/671673570259509248&#34;&gt;December 1, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/minisciencegirl&#34;&gt;@minisciencegirl&lt;/a&gt; Yep we use it mainly for that... there&amp;#39;s a more featured version in &lt;a href=&#34;https://t.co/5oOeLwx2Hg&#34;&gt;https://t.co/5oOeLwx2Hg&lt;/a&gt; but I need to switch to ggtree!&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/667490462693912576&#34;&gt;November 19, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Sent my first &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/shiny?src=hash&#34;&gt;#shiny&lt;/a&gt; app off to be alpha tested by a colleague today. Wouldn&amp;#39;t be possible without &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;.&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/660278158663401473&#34;&gt;October 31, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/genetics_blog&#34;&gt;@genetics_blog&lt;/a&gt; Thanks. We have turned this into a shiny app too, but need to iron out some bugs... Also, try the new ggtree library!&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/641251456595685376&#34;&gt;September 8, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; My bad :( It&amp;#39;s working perfectly fine. Thanks so much for an awesome &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; package ggtree! &lt;a href=&#34;http://t.co/ofmzyOWe9C&#34;&gt;pic.twitter.com/ofmzyOWe9C&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/559734740488818688&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; A bit improved version :) &lt;a href=&#34;http://t.co/TZTSBK5aSm&#34;&gt;pic.twitter.com/TZTSBK5aSm&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/559762891478667264&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;I wish this guy was my student! &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Sure, it won&amp;#39;t get a Nature or Science paper, but who cares? &lt;a href=&#34;http://t.co/XnA7uaFVms&#34;&gt;http://t.co/XnA7uaFVms&lt;/a&gt;&lt;/p&gt;&amp;mdash; Simon Frost (@sdwfrost) &lt;a href=&#34;https://twitter.com/sdwfrost/status/561514846291001344&#34;&gt;January 31, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/CieraReports&#34;&gt;@CieraReports&lt;/a&gt; ggtree is a cool package that is based on the drawing of ggplot2 &lt;a href=&#34;https://t.co/gFPHSdGAj1&#34;&gt;https://t.co/gFPHSdGAj1&lt;/a&gt;&lt;/p&gt;&amp;mdash; ホクソうり (@u_ribo) &lt;a href=&#34;https://twitter.com/u_ribo/status/559542705663905793&#34;&gt;January 26, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;https://t.co/VFrKCcz0DI&#34;&gt;https://t.co/VFrKCcz0DI&lt;/a&gt; is a pretty powerful &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggplot2?src=hash&#34;&gt;#ggplot2&lt;/a&gt; &lt;a href=&#34;https://twitter.com/Bioconductor&#34;&gt;@Bioconductor&lt;/a&gt; pkg for neat &lt;a href=&#34;https://twitter.com/hashtag/phylogenetic?src=hash&#34;&gt;#phylogenetic&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/dataviz?src=hash&#34;&gt;#dataviz&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;&lt;/p&gt;&amp;mdash; Ahmed Moustafa (@AhmedMoustafa) &lt;a href=&#34;https://twitter.com/AhmedMoustafa/status/561056244782227456&#34;&gt;January 30, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree extends ggplot2 for phylogenetic trees. tons of documentation+examples: &lt;a href=&#34;https://t.co/y9V52s2yWd&#34;&gt;https://t.co/y9V52s2yWd&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; &lt;a href=&#34;https://t.co/Z9SDcueR2c&#34;&gt;pic.twitter.com/Z9SDcueR2c&lt;/a&gt;&lt;/p&gt;&amp;mdash; Stephen Turner (@genetics_blog) &lt;a href=&#34;https://twitter.com/genetics_blog/status/664085841766195200&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Need to visualize some trees? Recent  &lt;a href=&#34;https://twitter.com/hashtag/R?src=hash&#34;&gt;#R&lt;/a&gt; package &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; looks quite interesting. &amp;#10;&lt;a href=&#34;https://t.co/EPaXIqmvDZ&#34;&gt;https://t.co/EPaXIqmvDZ&lt;/a&gt;&lt;/p&gt;&amp;mdash; Sebastian Schmidt (@TSBSchm) &lt;a href=&#34;https://twitter.com/TSBSchm/status/664431087683260416&#34;&gt;November 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-conversation=&#34;none&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/flashton2003&#34;&gt;@flashton2003&lt;/a&gt; world of possibilities now! Also looking at ggtree (ggplot2 expansion) for future stuff - that looks really cool too&lt;/p&gt;&amp;mdash; David W. Cleary (@Bacterioskeptic) &lt;a href=&#34;https://twitter.com/Bacterioskeptic/status/667706456045694976&#34;&gt;November 20, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;time for you to learn &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/LAevolving&#34;&gt;@LAevolving&lt;/a&gt; &amp;lt;- &lt;a href=&#34;https://twitter.com/StephSpiel&#34;&gt;@StephSpiel&lt;/a&gt; new &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; package ggtree &lt;a href=&#34;https://twitter.com/ggplot2&#34;&gt;@ggplot2&lt;/a&gt; &lt;a href=&#34;https://t.co/DFmKGyTVwE&#34;&gt;https://t.co/DFmKGyTVwE&lt;/a&gt; &lt;a href=&#34;https://t.co/WRBZHlRsIa&#34;&gt;pic.twitter.com/WRBZHlRsIa&lt;/a&gt;&lt;/p&gt;&amp;mdash; Salamanda (@ajzellmer) &lt;a href=&#34;https://twitter.com/ajzellmer/status/663937183791759360&#34;&gt;November 10, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-cards=&#34;hidden&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;V. cool new &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; package ggtree, addon 2 &lt;a href=&#34;https://twitter.com/ggplot2&#34;&gt;@ggplot2&lt;/a&gt;, for automating tree drawing/annotating &lt;a href=&#34;https://t.co/k3eSdVKp9C&#34;&gt;https://t.co/k3eSdVKp9C&lt;/a&gt; &lt;a href=&#34;https://t.co/nH8SKSaXaN&#34;&gt;pic.twitter.com/nH8SKSaXaN&lt;/a&gt;&lt;/p&gt;&amp;mdash; Stephanie Spielman (@StephSpiel) &lt;a href=&#34;https://twitter.com/StephSpiel/status/663771499589861376&#34;&gt;November 9, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; data-cards=&#34;hidden&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Can’t wait to try. MT &lt;a href=&#34;https://twitter.com/genetics_blog&#34;&gt;@genetics_blog&lt;/a&gt;: ggtree extends ggplot2 for phylogenetic trees: &lt;a href=&#34;https://t.co/JuThXlHUjz&#34;&gt;https://t.co/JuThXlHUjz&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Rstats?src=hash&#34;&gt;#Rstats&lt;/a&gt; &lt;a href=&#34;https://t.co/OmAzGghvqB&#34;&gt;pic.twitter.com/OmAzGghvqB&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kent Holsinger (@keholsinger) &lt;a href=&#34;https://twitter.com/keholsinger/status/667433534756397057&#34;&gt;November 19, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;&lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt; Excited to discover &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;; fills a lot of holes in my workflow but not seeing how to add bootstrap from ape?&lt;/p&gt;&amp;mdash; Jo Williams-Newkirk (@ajwnewkirk) &lt;a href=&#34;https://twitter.com/ajwnewkirk/status/640573716733169664&#34;&gt;September 6, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree added cool features, My favorite is the one from BEAST output &lt;a href=&#34;https://t.co/3WOLxfTzRp&#34;&gt;https://t.co/3WOLxfTzRp&lt;/a&gt;&lt;/p&gt;&amp;mdash; Manvendra Singh (@manvendr7) &lt;a href=&#34;https://twitter.com/manvendr7/status/664407764001779712&#34;&gt;November 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree looks useful: nice viz and annotations of phylogenetic trees with ggplot  &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;http://t.co/lbNKw3qIDI&#34;&gt;http://t.co/lbNKw3qIDI&lt;/a&gt;  thanks &lt;a href=&#34;https://twitter.com/guangchuangyu&#34;&gt;@guangchuangyu&lt;/a&gt;&lt;/p&gt;&amp;mdash; Julia Gustavsen (@JuliaGustavsen) &lt;a href=&#34;https://twitter.com/JuliaGustavsen/status/630500659960254464&#34;&gt;August 9, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;ggtree - looks like a very useful phylogenetic tree plotting package for R based on ggplot2 (&lt;a href=&#34;https://t.co/UCXVVmG5W7&#34;&gt;https://t.co/UCXVVmG5W7&lt;/a&gt;)&lt;/p&gt;&amp;mdash; Simon J Greenhill (@SimonJGreenhill) &lt;a href=&#34;https://twitter.com/SimonJGreenhill/status/547497335412899840&#34;&gt;December 23, 2014&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Plot trees &amp;amp; annotation (incl BEAST, time axis) with ggtree for R!&amp;#10;&lt;a href=&#34;http://t.co/9ahqKQLTaI&#34;&gt;http://t.co/9ahqKQLTaI&lt;/a&gt;&amp;#10;Well spotted &lt;a href=&#34;https://twitter.com/mackas21&#34;&gt;@mackas21&lt;/a&gt; &lt;a href=&#34;http://t.co/2ldvAiH2fj&#34;&gt;pic.twitter.com/2ldvAiH2fj&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kat Holt (@DrKatHolt) &lt;a href=&#34;https://twitter.com/DrKatHolt/status/610364467939913728&#34;&gt;June 15, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;geom_label can be used to add label and also additional information coded in background color. &lt;a href=&#34;https://twitter.com/hashtag/ggplot?src=hash&#34;&gt;#ggplot&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt; &lt;a href=&#34;http://t.co/pGvrsmsOc1&#34;&gt;pic.twitter.com/pGvrsmsOc1&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/642152010771398656&#34;&gt;September 11, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;view 100 boostrap trees in 2 lines. &lt;a href=&#34;http://t.co/FKNyP5dZsb&#34;&gt;pic.twitter.com/FKNyP5dZsb&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/638628150650368000&#34;&gt;September 1, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;en&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;multiple sequence alignment with &lt;a href=&#34;https://twitter.com/hashtag/phylogenetic?src=hash&#34;&gt;#phylogenetic&lt;/a&gt; tree via &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&#34;&gt;#rstats&lt;/a&gt; pkg &lt;a href=&#34;https://twitter.com/hashtag/ggtree?src=hash&#34;&gt;#ggtree&lt;/a&gt;. &lt;a href=&#34;http://t.co/6CY57dLdeb&#34;&gt;pic.twitter.com/6CY57dLdeb&lt;/a&gt;&lt;/p&gt;&amp;mdash; Guangchuang Yu (@guangchuangyu) &lt;a href=&#34;https://twitter.com/guangchuangyu/status/601676060254605312&#34;&gt;May 22, 2015&lt;/a&gt;&lt;/blockquote&gt;

&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>ggtree supports phylip tree format</title>
      <link>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/</link>
      <pubDate>Fri, 15 Jan 2016 13:19:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/ggtree-supports-phylip-tree-format/</guid>
      <description>&lt;p&gt;Phylip is also a widely used tree format, which contains taxa sequences with Newick tree text.&lt;/p&gt;

&lt;p&gt;In &lt;code&gt;ggtree&lt;/code&gt;, we can use &lt;code&gt;read.phylip()&lt;/code&gt; function to parse the file and use &lt;code&gt;ggtree()&lt;/code&gt; to visualize the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
phyfile &amp;lt;- system.file(&amp;quot;extdata&amp;quot;, &amp;quot;sample.phy&amp;quot;, package=&amp;quot;ggtree&amp;quot;)
phylip &amp;lt;- read.phylip(phyfile)
phylip

## &#39;phylip&#39; S4 object that stored information of
##   &#39;/Users/guangchuangyu/Library/R/3.2/library/ggtree/extdata/sample.phy&#39;.
## 
## ...@ tree: 
## Phylogenetic tree with 15 tips and 13 internal nodes.
## 
## Tip labels:
##  K, N, D, L, J, G, ...
## 
## Unrooted; no branch lengths.
## 
## with sequence alignment available (15 sequences of length 2148)

ggtree(phylip) + geom_tiplab()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;User can view the sequence alignment with the tree via &lt;code&gt;msaplot()&lt;/code&gt;
function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msaplot(phylip, offset=1)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-phylip_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>label edge number in ggtree</title>
      <link>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree/</link>
      <pubDate>Wed, 13 Jan 2016 11:00:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/label-edge-number-in-ggtree/</guid>
      <description>&lt;p&gt;This is a question from &lt;code&gt;ggtree&lt;/code&gt; user. In &lt;code&gt;ape&lt;/code&gt; and &lt;code&gt;phytools&lt;/code&gt;, it&amp;rsquo;s easy to label edge using the &lt;code&gt;edgelabels&lt;/code&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(1)
tr = rtree(30)
library(ape)
plot(tr, main=&amp;quot;ape&amp;quot;)
edgelabels()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I don&amp;rsquo;t see any necessity to label edge numbers, as they are meaningless. The number is labeled as the row index of &lt;code&gt;tr$edge&lt;/code&gt;, and edge can be uniquely mapped to child node. If we need to relate something to edge, we can relate them to corresponding child node. Node is a central hub in tree annotation in &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;To label edge number, we can also attach the edge number to node and then label them as a node attribute.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggtree)
p = ggtree(tr, ladderize=F) + geom_tiplab() + ggtitle(&amp;quot;ggtree&amp;quot;)
edge=data.frame(tr$edge, edge_num=1:nrow(tr$edge))
colnames(edge)=c(&amp;quot;parent&amp;quot;, &amp;quot;node&amp;quot;, &amp;quot;edge_num&amp;quot;)
p %&amp;lt;+% edge + geom_label(aes(x=branch, label=edge_num))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/2016-ggtree-edgelabel_files/figure-markdown_strict/unnamed-chunk-1-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Annotate a phylogenetic tree with insets</title>
      <link>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/</link>
      <pubDate>Mon, 11 Jan 2016 19:36:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2016/01/annotate-a-phylogenetic-tree-with-insets/</guid>
      <description>

&lt;p&gt;&lt;code&gt;Ggtree&lt;/code&gt; implemented a function, &lt;code&gt;subview&lt;/code&gt;, that can add subplots on a
ggplot2 object. It had successful applied to &lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;plot pie graphs on map&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2016-01-04)
tr &amp;lt;- rtree(30)
tr &amp;lt;- groupClade(tr, node=45)
p &amp;lt;- ggtree(tr, aes(color=group)) + geom_tippoint()
cpos &amp;lt;- get_clade_position(p, node=45)
p1 &amp;lt;- p + geom_hilight(node=45)
p2 &amp;lt;- with(cpos, p+xlim(xmin, xmax*1.01)+ylim(ymin, ymax))
with(cpos, subview(p2+geom_tiplab(), p1+theme_transparent(), x=xmin+(xmax-xmin)*.15, y=ymin+(ymax-ymin)*.85))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;To make it more easy to use subview function for annotating taxa with
subplots, &lt;em&gt;ggtree&lt;/em&gt; provides a function, &lt;code&gt;inset&lt;/code&gt;, for adding subplots to
a phylogenetic tree. The input is a tree graphic object and a named list
of ggplot graphic objects (can be any kind of charts), these objects
should named by node numbers. To facilitate adding bar and pie charts
(e.g. summarized stats of results from ancestral reconstruction) to
phylogenetic tree, &lt;em&gt;ggtree&lt;/em&gt; provides &lt;code&gt;nodepie&lt;/code&gt; and &lt;code&gt;nodebar&lt;/code&gt; functions
to create a list of pie or bar charts.&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-bar-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with bar charts&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-12-31)
tr &amp;lt;- rtree(15)
p &amp;lt;- ggtree(tr)

a &amp;lt;- runif(14, 0, 0.33)
b &amp;lt;- runif(14, 0, 0.33)
c &amp;lt;- runif(14, 0, 0.33)
d &amp;lt;- 1 - a - b - c
dat &amp;lt;- data.frame(a=a, b=b, c=c, d=d)
## input data should have a column of `node` that store the node number
dat$node &amp;lt;- 15+1:14

## cols parameter indicate which columns store stats (a, b, c and d in this example)
bars &amp;lt;- nodebar(dat, cols=1:4)

inset(p, bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 The sizes of the insets can be ajusted by the paramter &lt;em&gt;width&lt;/em&gt; and
&lt;em&gt;height&lt;/em&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, bars, width=.03, height=.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;br /&gt;
 Users can set the color via the parameter &lt;em&gt;color&lt;/em&gt;. The &lt;em&gt;x&lt;/em&gt; position can
be one of &amp;lsquo;node&amp;rsquo; or &amp;lsquo;branch&amp;rsquo; and can be adjusted by the parameter
&lt;em&gt;hjust&lt;/em&gt; and &lt;em&gt;vjust&lt;/em&gt; for horizontal and vertical adjustment respecitvely.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;bars2 &amp;lt;- nodebar(dat, cols=1:4, position=&#39;dodge&#39;,
                 color=c(a=&#39;blue&#39;, b=&#39;red&#39;, c=&#39;green&#39;, d=&#39;cyan&#39;))
p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.3)
print(p2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-pie-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with pie charts&lt;/h2&gt;

&lt;p&gt;Similarly, users can use &lt;code&gt;nodepie&lt;/code&gt; function to generate a list of pie
charts and place these charts to annotate corresponding nodes. Both
&lt;code&gt;nodebar&lt;/code&gt; and &lt;code&gt;nodepie&lt;/code&gt; accepts parameter &lt;em&gt;alpha&lt;/em&gt; to allow transparency.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies &amp;lt;- nodepie(dat, cols=1:4, alpha=.6)
inset(p, pies)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;inset(p, pies, hjust=-.06)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;annotate-with-other-types-of-charts:94c165ad3f1a57afa6b70fe6932c98e6&#34;&gt;Annotate with other types of charts&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;inset&lt;/code&gt; function accepts a list of ggplot graphic objects and these
input objects are not restricted to pie or bar charts. They can be any
kinds of charts and hybrid of these charts.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pies_and_bars &amp;lt;- bars2
pies_and_bars[9:14] &amp;lt;- pies[9:14]
inset(p, pies_and_bars)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-8-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- lapply(1:15, rnorm, n=100)
ylim &amp;lt;- range(unlist(d))
bx &amp;lt;- lapply(d, function(y) {
    dd &amp;lt;- data.frame(y=y)
    ggplot(dd, aes(x=1, y=y))+geom_boxplot() + ylim(ylim) + theme_inset()
})
names(bx) &amp;lt;- 1:15
inset(p, bx, width=.03, height=.1, hjust=-.05)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-9-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After annotating with insets, users can further annotate the tree with
another layer of insets.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p2 &amp;lt;- inset(p, bars2, x=&#39;branch&#39;, width=.03, vjust=-.4)
p2 &amp;lt;- inset(p2, pies, x=&#39;branch&#39;, vjust=.4)
bx2 &amp;lt;- lapply(bx, function(g) g+coord_flip())
inset(p2, bx2, width=.2, height=.03, vjust=.04, hjust=p2$data$x[1:15]-4) + xlim(NA, 4.5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/advanceTreeAnnotation_files/figure-markdown_strict/unnamed-chunk-10-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>News of ggtree</title>
      <link>http://guangchuangyu.github.io/2015/12/news-of-ggtree/</link>
      <pubDate>Wed, 30 Dec 2015 14:11:00 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/news-of-ggtree/</guid>
      <description>

&lt;p&gt;A new version of &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt; that works with ggplot2 (version &amp;gt;= 2.0.0) is now availabel.&lt;/p&gt;

&lt;h2 id=&#34;new-layers:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;new layers&lt;/h2&gt;

&lt;p&gt;Some functions, &lt;em&gt;add_legend&lt;/em&gt;, &lt;em&gt;hilight&lt;/em&gt;, &lt;em&gt;annotation_clade&lt;/em&gt; and &lt;em&gt;annotation_clade2&lt;/em&gt; were removed. Instead we provide layer functions, &lt;code&gt;geom_treescale&lt;/code&gt;, &lt;code&gt;geom_hilight&lt;/code&gt; and &lt;code&gt;geom_cladelabel&lt;/code&gt;. You can use &lt;code&gt;+&lt;/code&gt; operator to add layers using these layer functions.&lt;/p&gt;

&lt;p&gt;In addtion, we provide &lt;code&gt;geom_point2&lt;/code&gt;, &lt;code&gt;geom_text2&lt;/code&gt; and &lt;code&gt;geom_segment2&lt;/code&gt; which works exactly as &lt;code&gt;geom_point&lt;/code&gt;, &lt;code&gt;geom_text&lt;/code&gt; and &lt;code&gt;geom_segment&lt;/code&gt; except they allow ggtree users to do &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/&#34;&gt;subsetting&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;rescale-tree:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;rescale tree&lt;/h2&gt;

&lt;p&gt;Most of the phylogenetic trees are scaled by evolutionary distance (substitution/site), in &lt;code&gt;ggtree&lt;/code&gt; we can re-scale a phylogenetic tree by any numerical variable inferred by evolutionary analysis. For example using substitution rate to scale a time-scaled tree inferred by BEAST, or using &lt;em&gt;dN/dS&lt;/em&gt; to re-scale a tree analyzed by CodeML.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screenshot%202015-12-30%2014.17.34.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;new-hampshire-extended-format-nhx-supported:04f7c01ab00975376c8371fb68bcfbb4&#34;&gt;New Hampshire eXtended format (NHX) supported&lt;/h2&gt;

&lt;p&gt;This is a &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/27&#34;&gt;feature request&lt;/a&gt; from &lt;code&gt;ggtree&lt;/code&gt; user. The NHX format is also commonly used in phylogenetic software (e.g. PHYLODOG, RevBayes, &lt;em&gt;etc&lt;/em&gt;).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screenshot 2015-12-30 14.25.45.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The original vignette was too long and I split them into several short ones. These vignettes should be more easy to follow. You can access the vignette via &lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;. More examples and detail explanation were provided. If there are something that I didn&amp;rsquo;t explain well or if you have suggestions for changes or improvements, &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues&#34;&gt;submit an issue&lt;/a&gt;, or (even better) fork &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;ggtree&lt;/a&gt;, make modifications and submit a pull request.
I appreciate your help in improving &lt;code&gt;ggtree&lt;/code&gt;.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Repo: &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree&#34;&gt;https://github.com/GuangchuangYu/ggtree&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;vignettes

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/&#34;&gt;http://guangchuangyu.github.io/ggtree/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeImport.html&#34;&gt;Tree Data Import&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeVisualization.html&#34;&gt;Tree Visualization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeManipulation.html&#34;&gt;Tree Manipulation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://guangchuangyu.github.io/ggtree/treeAnnotation.html&#34;&gt;Tree Annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>use emoji font in R</title>
      <link>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/</link>
      <pubDate>Wed, 16 Dec 2015 11:11:11 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2015/Screenshot 2015-12-16 10.55.49.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I have played with emoji in &lt;code&gt;R&lt;/code&gt; for a while. My solution of using it is different from what implemented in &lt;a href=&#34;https://github.com/dill/emoGG/&#34;&gt;emoGG&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;emoGG&lt;/code&gt; is a good attemp to add &lt;code&gt;emoji&lt;/code&gt; in &lt;code&gt;ggplot2&lt;/code&gt;. It render &lt;code&gt;emoji&lt;/code&gt; picture (png) and creat a layer, &lt;code&gt;geom_emoji&lt;/code&gt;, to add emoji.&lt;/p&gt;

&lt;p&gt;In my opinion, &lt;code&gt;emoji&lt;/code&gt; should be treated as ordinary font in user interface, albeit it maynot be true internally.&lt;/p&gt;

&lt;p&gt;It would be more flexible if we can use emoji as ordinary font and in this way user don&amp;rsquo;t need to learn extra stuff.&lt;/p&gt;

&lt;p&gt;I implemented my solution of using &lt;code&gt;emoji&lt;/code&gt; in the R package &lt;a href=&#34;https://github.com/GuangchuangYu/emojifont&#34;&gt;emojifont&lt;/a&gt;. The package is very simple, pack some emoji fonts (currently only &lt;a href=&#34;https://github.com/MorbZ/OpenSansEmoji&#34;&gt;OpenSansEmoji.ttf&lt;/a&gt;) and use &lt;a href=&#34;https://github.com/yixuan/showtext&#34;&gt;showtext&lt;/a&gt; to render the fonts, then we can use the font in either base plot or ggplot2.&lt;/p&gt;

&lt;h1 id=&#34;emojifont:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;emojifont&lt;/h1&gt;

&lt;h2 id=&#34;installation:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Installation&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;devtools::install_github(&amp;quot;GuangchuangYu/emojifont&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;load-emoji-font:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;load Emoji font&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;library(emojifont)
## list available emoji fonts
list.emojifonts()

## [1] &amp;quot;OpenSansEmoji.ttf&amp;quot;

## load selected emoji font
load.emojifont(&#39;OpenSansEmoji.ttf&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;emoji-characters:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji characters&lt;/h1&gt;

&lt;p&gt;To use &lt;code&gt;emoji&lt;/code&gt;, we need to use their corresponding unicode. Emoji unicode can be found in &lt;a href=&#34;http://apps.timwhitlock.info/emoji/tables/unicode&#34;&gt;http://apps.timwhitlock.info/emoji/tables/unicode&lt;/a&gt;, or searched using &lt;a href=&#34;https://github.com/richfitz/remoji&#34;&gt;remoji&lt;/a&gt; package.&lt;/p&gt;

&lt;h1 id=&#34;emoji-in-r-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Emoji in R plot&lt;/h1&gt;

&lt;h2 id=&#34;base-plot:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;base plot&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;require(remoji)
set.seed(123)
x &amp;lt;- rnorm(10)
set.seed(321)
y &amp;lt;- rnorm(10)
plot(x, y, cex=0)
text(x, y, labels=emoji(&#39;cow&#39;), cex=1.5, col=&#39;steelblue&#39;, family=&#39;OpenSansEmoji&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/base_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggplot2:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggplot2&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;d &amp;lt;- data.frame(x=x, y=y,
     label = sample(c(emoji(&#39;cow&#39;), emoji(&#39;camel&#39;)), 10, replace=TRUE),
     type = sample(LETTERS[1:3], 10, replace=TRUE))
require(ggplot2)
ggplot(d, aes(x, y, color=type, label=label)) + 
    geom_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=5)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/ggplot_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can also use &lt;code&gt;emoji&lt;/code&gt; in title, legend or axis label.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dd=data.frame(x=emoji(c(&amp;quot;satisfied&amp;quot;, &amp;quot;disapointed&amp;quot;)), y=c(50, 10))
emoji_text=element_text(family=&amp;quot;OpenSansEmoji&amp;quot;, size=20)
ggplot(dd, aes(x, y)) + geom_bar(stat=&#39;identity&#39;, aes(fill=x)) + 
     ggtitle(paste(emoji(c(&amp;quot;+1&amp;quot;, &amp;quot;-1&amp;quot;)), collapse=&amp;quot; &amp;quot;))+ 
        theme(axis.text.x = emoji_text, legend.text=emoji_text, title=emoji_text) + 
            xlab(NULL)+ylab(NULL)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/2015/Screenshot 2015-12-16 11.10.51.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;ggtree:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;ggtree&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;require(ggtree)
require(colorspace)

tree_text=paste0(
    &amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,&amp;quot;(&amp;quot;,
       &amp;quot;(&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&amp;quot;cow&amp;quot;), &amp;quot;,&amp;quot;,
               &amp;quot;(&amp;quot;,
                  emoji(&amp;quot;whale&amp;quot;),&amp;quot;,&amp;quot;,
                  emoji(&amp;quot;dolphin&amp;quot;),
               &amp;quot;)&amp;quot;,
            &amp;quot;),&amp;quot;,
            &amp;quot;(&amp;quot;,
               emoji(&#39;pig2&#39;),&amp;quot;,&amp;quot;,
               emoji(&#39;boar&#39;),
            &amp;quot;)&amp;quot;,
       &amp;quot;),&amp;quot;,
       emoji(&amp;quot;camel&amp;quot;),
    &amp;quot;),&amp;quot;, emoji(&amp;quot;fish&amp;quot;), &amp;quot;),&amp;quot;, 
emoji(&amp;quot;seedling&amp;quot;), &amp;quot;);&amp;quot;)

ggtree(read.tree(text=tree_text)) + xlim(NA, 7) +
   geom_tiplab(family=&amp;quot;OpenSansEmoji&amp;quot;, size=10,
               color=rainbow_hcl(8))
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/ggtree_emoji-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h1 id=&#34;apple-color-emoji:eff1c6109e2664cf9357286de69e0f0b&#34;&gt;Apple Color Emoji&lt;/h1&gt;

&lt;p&gt;Although &lt;code&gt;R&lt;/code&gt;&amp;rsquo;s graphical devices don&amp;rsquo;t support &lt;code&gt;AppleColorEmoji&lt;/code&gt; font, it&amp;rsquo;s still possible to use it. We can export the &lt;code&gt;plot&lt;/code&gt; to &lt;code&gt;svg&lt;/code&gt; file and render it in &lt;code&gt;Safari&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(gridSVG)
p &amp;lt;-  ggtree(read.tree(text=tree_text), size=2) + geom_tiplab(size=20)
p &amp;lt;- p %&amp;gt;% phylopic(&amp;quot;79ad5f09-cf21-4c89-8e7d-0c82a00ce728&amp;quot;, color=&amp;quot;firebrick&amp;quot;, alpha = .3)
p &amp;lt;- p + xlim(NA, 7) + ylim(NA, 8.5)
p
ps = grid.export(&amp;quot;emoji.svg&amp;quot;, addClass=T)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/emojifont/master/vignettes/figures/apple_emoji.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>BioC 3.2: NEWS of my BioC packages</title>
      <link>http://guangchuangyu.github.io/2015/10/bioc-3.2-news-of-my-bioc-packages/</link>
      <pubDate>Thu, 15 Oct 2015 16:13:57 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/10/bioc-3.2-news-of-my-bioc-packages/</guid>
      <description>

&lt;p&gt;In BioC 3.2 release, all my packages including
&lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/DOSE.html&#34;&gt;DOSE&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ReactomePA.html&#34;&gt;ReactomePA&lt;/a&gt;,
and &lt;a href=&#34;http://www.bioconductor.org/packages/ChIPseeker&#34;&gt;ChIPseeker&lt;/a&gt; switch
from Sweave to R Markdown for package vignettes.&lt;/p&gt;

&lt;h3 id=&#34;gosemsim:35c90aeebec9a933fea1dafd42584f96&#34;&gt;GOSemSim&lt;/h3&gt;

&lt;p&gt;To make it consistent between
&lt;a href=&#34;http://www.bioconductor.org/packages/GOSemSim&#34;&gt;GOSemSim&lt;/a&gt; and
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&amp;lsquo;worm&amp;rsquo; was deprecated and instead we should use &amp;lsquo;celegans&amp;rsquo;. As usual,
information content data was updated.&lt;/p&gt;

&lt;h3 id=&#34;clusterprofiler:35c90aeebec9a933fea1dafd42584f96&#34;&gt;clusterProfiler&lt;/h3&gt;

&lt;p&gt;Enrichment results may contains terms that are very general (less
informative) and we do not want to use them. In this release, we provide
&lt;em&gt;dropGO&lt;/em&gt; function that can be used to drop selected GO terms or specific
level of GO terms. It can be applied to output from both &lt;em&gt;enrichGO&lt;/em&gt; and
&lt;em&gt;compareCluster&lt;/em&gt;. This is a feature request from
&lt;a href=&#34;https://github.com/GuangchuangYu/clusterProfiler/issues/26&#34;&gt;@ahorvath&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Another feature request is to visualize GO enrichment result with GO
topology. I implement &lt;em&gt;plotGOgraph&lt;/em&gt; function by extending
&lt;a href=&#34;http://www.bioconductor.org/packages/topGO&#34;&gt;topGO&lt;/a&gt; to support output of
both &lt;em&gt;enrichGO&lt;/em&gt; or &lt;em&gt;gseGO&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/06/dotplot-for-enrichment-result/&#34;&gt;dotplot&lt;/a&gt;&lt;/em&gt;
is another feature request and was implemented in
&lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt; as a general function
for visualize enrichment result.
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
import this function.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;merge_result&lt;/em&gt; function was implemented for merging enrichment results
and then the results can be visualized simultaneously for comparison.
This function was developed for comparing &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-for-gtex-paper/&#34;&gt;functional enrichment of GTEx paper&lt;/a&gt;.
An example of comparing results from
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
and DAVID can be found in
&lt;a href=&#34;https://github.com/GuangchuangYu/enrichment4GTEx_clusterProfiler/blob/master/GO_BP.md&#34;&gt;github&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;A section &amp;lsquo;Functional analysis of NGS data&amp;rsquo; was added in the vignette.
&lt;a href=&#34;http://guangchuangyu.github.io/2015/05/use-clusterprofiler-as-an-universal-enrichment-analysis-tool/&#34;&gt;The blog post&lt;/a&gt;
illustrated using &lt;em&gt;enricher&lt;/em&gt; and &lt;em&gt;GSEA&lt;/em&gt; function to analyze user defined
annotation.&lt;/p&gt;

&lt;h3 id=&#34;dose:35c90aeebec9a933fea1dafd42584f96&#34;&gt;DOSE&lt;/h3&gt;

&lt;p&gt;Network of Cancer Genes data was updated to version 4.9.0, contributed
by &lt;a href=&#34;https://github.com/GuangchuangYu/DOSE/pull/8&#34;&gt;@dalloliogm&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;dotplot&lt;/em&gt; function was implemented for visualizing enrichment result and
was imported to
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;
and &lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;With new release of ChIPseeker, DOSE can be applied to &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-analysis-with-ngs-data/&#34;&gt;NGS data&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Several bugs were removed and small improvement were incorporated.&lt;/p&gt;

&lt;h3 id=&#34;reactomepa:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ReactomePA&lt;/h3&gt;

&lt;p&gt;Now fly (Drosophila melanogaster) is supported.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;viewPathway&lt;/em&gt; supports other organisms, which was contributed by
&lt;a href=&#34;https://github.com/GuangchuangYu/ReactomePA/pull/1&#34;&gt;@vladpetyuk&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Import &lt;em&gt;dotplot&lt;/em&gt; from DOSE and add &amp;lsquo;Pathway analysis of NGS data&amp;rsquo;
section in vignette.&lt;/p&gt;

&lt;h3 id=&#34;chipseeker:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ChIPseeker&lt;/h3&gt;

&lt;p&gt;Implement
&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/functional-enrichment-analysis-with-ngs-data/&#34;&gt;seq2gene&lt;/a&gt;&lt;/em&gt;
function for linking genomic regions to genes by many-to-many mapping.
With this function, enrichment analysis of
&lt;a href=&#34;http://www.bioconductor.org/packages/clusterProfiler&#34;&gt;clusterProfiler&lt;/a&gt;,
&lt;a href=&#34;http://www.bioconductor.org/packages/DOSE&#34;&gt;DOSE&lt;/a&gt; and
&lt;a href=&#34;http://www.bioconductor.org/packages/ReactomePA&#34;&gt;ReactomePA&lt;/a&gt; can be
applied to NGS data.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/07/upsetplot-in-chipseeker/&#34;&gt;upsetplot&lt;/a&gt;
function is implemented for viewing overlap of ChIP annotation.&lt;/p&gt;

&lt;p&gt;Better implementation of internal function &lt;em&gt;getFirstHitIndex&lt;/em&gt;
contributed by
&lt;a href=&#34;https://support.bioconductor.org/p/70432/#70545&#34;&gt;@hpages&lt;/a&gt;. Now
annotating a BED file of size about 1GB only take several minutes.&lt;/p&gt;

&lt;p&gt;An issue of BED file that using &lt;a href=&#34;http://guangchuangyu.github.io/2015/08/parsing-bed-coordinates/&#34;&gt;the 0-based coordinate system&lt;/a&gt; was fixed.&lt;/p&gt;

&lt;p&gt;GEO data information was updated, now ChIPseeker contains more than
18,000 BED file information. User can compare their own data with those
deposited in GEO to &lt;a href=&#34;http://guangchuangyu.github.io/2015/10/chipseq-data-mining-with-chipseeker/&#34;&gt;identify co-occurrence binding
proteins&lt;/a&gt;
that maybe cooperated with the one we are interested in.&lt;/p&gt;

&lt;h3 id=&#34;ggtree:35c90aeebec9a933fea1dafd42584f96&#34;&gt;ggtree&lt;/h3&gt;

&lt;p&gt;My major focus in the past half year is on developing
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt;.
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; has a lot of
changes. Some of the updates can be found in &lt;a href=&#34;http://bioconductor.org/help/newsletters/2015_October/&#34;&gt;Bioconductor Newsletter&lt;/a&gt;
(Oct. 2015). In addition, I would like to emphasize the
&lt;em&gt;&lt;a href=&#34;http://guangchuangyu.github.io/2015/08/subview/&#34;&gt;subview&lt;/a&gt;&lt;/em&gt; function which works
fine with all the ggplot objects and was applied to &lt;a href=&#34;http://stackoverflow.com/questions/10368180/plotting-pie-graphs-on-map-in-ggplot/32380396#32380396&#34;&gt;plot pie graph on a map&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; can be fun by using &lt;a href=&#34;http://guangchuangyu.github.io/2015/06/ggtree-with-funny-fonts/&#34;&gt;symbolic fonts&lt;/a&gt;, &lt;a href=&#34;http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/&#34;&gt;cartoonize the tree&lt;/a&gt;
or annotating the tree &lt;a href=&#34;http://guangchuangyu.github.io/2015/12/use-emoji-font-in-r/&#34;&gt;with emoji&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are many updates that based on the github version of ggplot2.
Since the new features of ggplot2 are currently not available in CRAN. I
do not commit the change to Bioconductor and will introduce these new
feature to ggtree user when new version of ggplot2 is available in CRAN.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>subsetting data in ggtree</title>
      <link>http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/</link>
      <pubDate>Thu, 24 Sep 2015 01:20:21 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/09/subsetting-data-in-ggtree/</guid>
      <description>&lt;p&gt;Subsetting is commonly used in ggtree as we would like to for example
separating internal nodes from tips. We may also want to display
annotation to specific node(s)/tip(s).&lt;/p&gt;

&lt;p&gt;Some software may stored clade information (e.g. bootstrap value) as
internal node labels. Indeed we want to manipulate such information and
taxa labels separately.&lt;/p&gt;

&lt;p&gt;In current ggplot2 (version=1.0.1, access date:2015-09-23), it support
&lt;em&gt;subset&lt;/em&gt;. For instance:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
library(ggtree)
tree=read.tree(text=&amp;quot;((A:2,B:2)95:2,(C:2,D:2)100:2);&amp;quot;)
ggtree(tree) + geom_text(aes(label=label), subset=.(!isTip), hjust=-.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But this feature was removed in github version of ggplot2 and will not
be available in next release.&lt;/p&gt;

&lt;p&gt;In github version of ggtree, we implemented geom_text2, geom_point2,
and geom_segment2, that works exactly like geom_text, geom_point and
geom_segment respectively with &lt;em&gt;subset&lt;/em&gt; supported. The syntax is
slightly different.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ggtree(tree) + geom_text2(aes(label=label, subset=!isTip), hjust=-.2) +
        geom_point2(aes(subset=!isTip), color=&amp;quot;red&amp;quot;, size=3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/subsetting.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Note: The example was from the discussion of &lt;a href=&#34;https://github.com/GuangchuangYu/ggtree/issues/13&#34;&gt;github issue&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>comic phylogenetic tree with ggtree and comicR</title>
      <link>http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/</link>
      <pubDate>Tue, 08 Sep 2015 01:15:26 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/09/comic-phylogenetic-tree-with-ggtree-and-comicr/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
applies the concepts of grammar of graphic in phylogenetic tree
presentation and make it easy to add multiple layers of text and even
figures above a 🌲.&lt;/p&gt;

&lt;p&gt;Here, I cartoonize a phylogenetic tree generated by
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
with &lt;a href=&#34;https://github.com/timelyportfolio/comicR&#34;&gt;comicR&lt;/a&gt;, which is a
funny package to generate comic (xkcd-like) graph in R. Have fun with
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
and &lt;a href=&#34;https://github.com/timelyportfolio/comicR&#34;&gt;comicR&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(htmltools)
library(XML)
library(gridSVG)
library(comicR)

library(ggplot2)
library(ggtree)

p &amp;lt;- ggtree(rtree(30), layout=&amp;quot;fan&amp;quot;)  + 
geom_text(aes(label=label, angle=angle), size=5, color=&amp;quot;purple&amp;quot;, vjust=-0.3)


p
svg &amp;lt;- grid.export(name=&amp;quot;&amp;quot;)$svg
tagList(
tags$div(
id = &amp;quot;ggtree_comic&amp;quot;,
tags$style(&amp;quot;#ggtree_comic text {font-family:Chalkduster;}&amp;quot;),
HTML(saveXML(svg)),
comicR(&amp;quot;#ggtree_comic&amp;quot;, ff=5)
)
) %&amp;gt;% html_print
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/comicTree.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>subview</title>
      <link>http://guangchuangyu.github.io/2015/08/subview/</link>
      <pubDate>Mon, 31 Aug 2015 03:17:48 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/08/subview/</guid>
      <description>&lt;p&gt;I implemented a function, &lt;em&gt;subview&lt;/em&gt;, in
&lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;
that make it easy to embed a subplot in ggplot.&lt;/p&gt;

&lt;p&gt;An example is shown below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;library(ggplot2)
library(ggtree)

dd &amp;lt;- data.frame(x=LETTERS[1:3], y=1:3)
pie &amp;lt;- ggplot(dd, aes(x=1, y, fill=x)) + 
geom_bar(stat=&amp;quot;identity&amp;quot;, width=1) + 
coord_polar(theta=&amp;quot;y&amp;quot;) + theme_tree() + 
xlab(NULL) + ylab(NULL) + 
theme_transparent()

x &amp;lt;- sample(2:9)
y &amp;lt;- sample(2:9)
width &amp;lt;- sample(seq(0.05, 0.15, length.out=length(x)))
height &amp;lt;- width

p &amp;lt;- ggplot(data=data.frame(x=c(0, 10), y=c(0, 10)), aes(x, y))+geom_blank()
print(p)
for (i in seq_along(x)) {
p %&amp;lt;&amp;gt;% subview(pie, x[i], y[i], width[i], height[i])
print(p)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/subview.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;With this function, we can plot a specific clade and add a subplot of
the whole topology; we can also add relative statistic graph above the
tree or to a specific node. It&amp;rsquo;s not specific to phylogenetic tree, it
works with all ggplot objects as demonstrated in the example.&lt;/p&gt;

&lt;p&gt;PS: &lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; is now
presented in &lt;a href=&#34;https://cran.r-project.org/web/views/Phylogenetics.html&#34;&gt;CRAN Task View:
Phylogenetics&lt;/a&gt;.
&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/taskview_cran.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;AND get its first citation.
&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/Screenshot%202015-08-04%2021.49.27.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ggtree annotate phylogenetic tree with local images</title>
      <link>http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/</link>
      <pubDate>Sat, 01 Aug 2015 12:52:34 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/08/ggtree-annotate-phylogenetic-tree-with-local-images/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/Screenshot%202015-08-01%2020.53.50.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In &lt;a href=&#34;http://www.bioconductor.org/packages/release/bioc/html/ggtree.html&#34;&gt;ggtree&lt;/a&gt;,
we provide a function &lt;em&gt;annotation_image&lt;/em&gt; for annotating phylogenetic
tree with images.&lt;/p&gt;

&lt;p&gt;To demonstrate the usage, I created a tree view from a random tree as
shown below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;set.seed(2015-08-01)
p &amp;lt;- ggtree(rtree(10)) + xlim(0, 5)+ ylim(0, 11)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We need a &lt;em&gt;data.frame&lt;/em&gt; that contains information of taxa labels and
image paths. Here I created such a &lt;em&gt;data.frame&lt;/em&gt; containing image files
downloaded from phylopic.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; img_info
  V1                                           V2
1 t1 25f165fa-f279-4f7c-9869-c55be251ffb8.512.png
2 t2 5d7ab302-960b-4db7-9dfd-215175a55906.512.png
3 t3 6fbe723c-3a6b-4d06-8680-bb2a52113df4.512.png
4 t4 d83c02ca-76ed-436b-83ae-7f98d7297be9.512.png
5 t5 ee764929-c865-44f6-b5db-b4e7d5693d1a.512.png
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Annotating tree with images is simple in
&lt;a href=&#34;http://www.bioconductor.org/packages/ggtree&#34;&gt;ggtree&lt;/a&gt; by using
&lt;em&gt;annotation_image&lt;/em&gt; function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;annotation_image(p, img_info)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-2-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;By default, all the images will align to the right hand side. We can use
&lt;em&gt;align=FALSE&lt;/em&gt;, to disable it.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;annotation_image(p, img_info, align=FALSE)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-3-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;We can change the type and size of lines, as demonstrated below:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;annotation_image(p, img_info, linetype=&amp;quot;dashed&amp;quot;, linesize=0.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-4-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The width of the images were controlled by width parameter, and the
height will automatically determined by image dimension.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;annotation_image(p, img_info, width = .2, linetype=&amp;quot;dashed&amp;quot;, linesize=0.2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-5-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In the following example, we add tip labels to the tree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p &amp;lt;- p+geom_tiplab(align=TRUE, linetype=&amp;quot;dashed&amp;quot;, linesize=.2)
print(p)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-6-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If we also want to add the image and align them, we don&amp;rsquo;t want to show
the line added by &lt;em&gt;annotation_image&lt;/em&gt; function. This can be achieved by
setting &lt;em&gt;linetype=NULL&lt;/em&gt;. By default the images and tip labels will be
overlapped, we can move the images by &lt;em&gt;offset&lt;/em&gt; parameter.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;p %&amp;gt;% annotation_image(img_info, width=.2, linetype=NULL, offset=.3)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/annotation_image/unnamed-chunk-7-1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>flip and rotate branches in ggtree</title>
      <link>http://guangchuangyu.github.io/2015/07/flip-and-rotate-branches-in-ggtree/</link>
      <pubDate>Wed, 01 Jul 2015 02:51:34 +0800</pubDate>
      
      <guid>http://guangchuangyu.github.io/2015/07/flip-and-rotate-branches-in-ggtree/</guid>
      <description>&lt;p&gt;&lt;strong&gt;&lt;em&gt;flip&lt;/em&gt;&lt;/strong&gt; function is a feature request from ggtree user. It accepts a
tree view and two node numbers and exchange the positions of the
selected clades.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;require(ggtree)
set.seed(2015-07-01)
tr &amp;lt;- rtree(30)
p &amp;lt;- ggtree(tr) + geom_text(aes(label=node))
gridExtra::grid.arrange(p, flip(p, 38, 33), ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/flip_1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s chainable and all possible position adjustment can be achieved via
multiple flip operations.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;flip(p, 38, 33) %&amp;gt;% flip(53, 58) %&amp;gt;% flip(32, 51)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://guangchuangyu.github.io/blog_images/Bioconductor/ggtree/flip_animation.gif&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s tedious to rotate a clade by 180 degree with several flip
operations, ggtree provides another function &lt;strong&gt;&lt;em&gt;rotate&lt;/em&gt;&lt;/strong&gt; that accepts a
selected node and rotate that branch by 180 degree.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;col = c(&amp;quot;black&amp;quot;, &amp;quot;firebrick&amp;quot;, &amp;quot;steelblue&amp;quot;)[groupClade(tr, c(33, 52))]
gridExtra::grid.arrange(ggtree(tr, color=col), 
                        ggtree(tr, color=col) %&amp;gt;% rotate(33) %&amp;gt;% rotate(52), 
                        ncol=2)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://raw.githubusercontent.com/GuangchuangYu/ygc_name/45fc101df9b7c711643fdb641d76f6822ad031a8/Bioconductor/ggtree/rotate.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>