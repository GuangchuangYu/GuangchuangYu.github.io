<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.30.2" />
  <meta name="author" content="Guangchuang YU">
  <meta name="description" content="Postdoc researcher">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://guangchuangyu.github.io/tags/clusterprofiler/index.xml" type="application/rss+xml" title="Guangchuang YU">
  <link rel="feed" href="https://guangchuangyu.github.io/tags/clusterprofiler/index.xml" type="application/rss+xml" title="Guangchuang YU">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://guangchuangyu.github.io/tags/clusterprofiler/">

  

  <title>Clusterprofiler | Guangchuang YU</title>


</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Guangchuang YU</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/resume">
            
            <span>Resume</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/cn">
            
            <span>中文入口</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>




<div class="universal-wrapper">

  <h1>Clusterprofiler</h1>

  

  
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2017/08/joyplot-for-gsea-result/">joyplot for GSEA result</a></h2>
    <div class="article-style">
      
      <p>I am very glad to find that someone figure out <a href="https://stackoverflow.com/questions/45384281/ggjoy-facet-with-ggtree" target="_blank">how to use ggjoy with ggtree</a>.</p>

<p><img src="https://i.stack.imgur.com/U7D3j.png" alt="" /></p>

<p>I really love ggjoy and believe it can be a good tool to visualize gene set enrichment (GSEA) result. DOSE/clusterProfiler support several visualization methods.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2017/05/bioc-3.5-news-of-my-bioc-packages/">[Bioc 3.5] NEWS of my BioC packages</a></h2>
    <div class="article-style">
      
      <p>I have 8 packages published within the <code>Bioconductor</code> project.</p>

<ul>
<li><a href="http://guangchuangyu.github.io/ChIPseeker" target="_blank">ChIPseeker</a></li>
<li><a href="http://guangchuangyu.github.io/clusterProfiler" target="_blank">clusterProfiler</a></li>
<li><a href="http://guangchuangyu.github.io/DOSE" target="_blank">DOSE</a></li>
<li><a href="http://guangchuangyu.github.io/ggtree" target="_blank">ggtree</a></li>
<li><a href="http://guangchuangyu.github.io/GOSemSim" target="_blank">GOSemSim</a></li>
<li><a href="http://guangchuangyu.github.io/meshes" target="_blank">meshes</a></li>
<li><a href="http://guangchuangyu.github.io/ReactomePA" target="_blank">ReactomePA</a></li>
<li><a href="http://guangchuangyu.github.io/treeio" target="_blank">treeio</a></li>
</ul>

<p>A new package <a href="http://guangchuangyu.github.io/treeio" target="_blank">treeio</a> was included in BioC 3.5 release.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/12/dotplot-for-gsea-result/">dotplot for GSEA result</a></h2>
    <div class="article-style">
      
      <p><img src="https://guangchuangyu.github.io/blog_images/Bioconductor/DOSE/gseaplot.png" alt="" /></p>

<p>For GSEA analysis, we are familar with the above figure which shows the running enrichment score. But for most of the software, it lack of visualization method to summarize the whole enrichment result.</p>

<p>In <a href="https://guangchuangyu.github.io/DOSE" target="_blank">DOSE</a> (and related tools including <a href="https://guangchuangyu.github.io/clusterProfiler" target="_blank">clusterProfiler</a>, <a href="https://guangchuangyu.github.io/ReactomePA" target="_blank">ReactomePA</a> and <a href="https://guangchuangyu.github.io/meshes" target="_blank">meshes</a>), we provide <code>enrichMap</code> and <code>cnetplot</code> to summarize GSEA result.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/11/showcategory-parameter-for-visualizing-comparecluster-output/">showCategory parameter for visualizing compareCluster output</a></h2>
    <div class="article-style">
      
      <blockquote>
<p>I am using dotplot() to visualize results from enrichGO(), enrichDO(), enricher() and compareCluster() in clusterProfiler R package. When specifying showCategory, I get the right number of categories except with the results of compareCluser().</p>

<p>In my case, I use compareCluster() on a list of 3 elements:</p>

<pre><code>str(ClusterList)
List of 3
 $ All : chr [1:1450] &quot;89886&quot; &quot;29923&quot; &quot;100132891&quot; &quot;101410536&quot; ...
 $ g1  : chr [1:858] &quot;89886&quot; &quot;29923&quot; &quot;100132891&quot; &quot;101410536&quot; ...
 $ g2: chr [1:592] &quot;5325&quot; &quot;170691&quot; &quot;29953&quot; &quot;283392&quot; ...
CompareGO_BP=compareCluster(ClusterList, fun=&quot;enrichGO&quot;, pvalueCutoff=0.01, pAdjustMethod=&quot;BH&quot;, OrgDb=org.Hs.eg.db,ont=&quot;BP&quot;,readable=T)

dotplot(CompareGO_BP, showCategory=10, title=&quot;GO - Biological Process&quot;)
</code></pre>

<p>I ask for 10 categories, but I get 15 categories in All, 8 categories in g1 and 12 categories in g2. None of the categories, neither the sum of the categories are 10&hellip;</p>

<p>Is the option showCategory working in the case of comparison? Am I missing something here?</p>

<p>And which categories precisely will it plot? the most significant whatever my 3 cases or the most significant of each case?</p>
</blockquote>

<p>The question was <a href="https://support.bioconductor.org/p/88965/" target="_blank">posted</a> in Bioconductor support site. It seems quite confusing and I think I need to write a post to clarify it.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/10/bioc-34-news-of-my-bioc-packages/">[Bioc 34] NEWS of my BioC packages</a></h2>
    <div class="article-style">
      
      <p>I have 7 packages published within the <code>Bioconductor</code> project.</p>

<ul>
<li><a href="http://guangchuangyu.github.io/ChIPseeker" target="_blank">ChIPseeker</a></li>
<li><a href="http://guangchuangyu.github.io/clusterProfiler" target="_blank">clusterProfiler</a></li>
<li><a href="http://guangchuangyu.github.io/DOSE" target="_blank">DOSE</a></li>
<li><a href="http://guangchuangyu.github.io/ggtree" target="_blank">ggtree</a></li>
<li><a href="http://guangchuangyu.github.io/GOSemSim" target="_blank">GOSemSim</a></li>
<li><a href="http://guangchuangyu.github.io/meshes" target="_blank">meshes</a></li>
<li><a href="http://guangchuangyu.github.io/ReactomePA" target="_blank">ReactomePA</a></li>
</ul>

<p>A new package <a href="http://guangchuangyu.github.io/meshes" target="_blank">meshes</a> was included in BioC 3.4 release.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/07/leading-edge-analysis/">leading edge analysis</a></h2>
    <div class="article-style">
      
      <h2 id="leading-edge-and-core-enrichment">leading edge and core enrichment</h2>

<p>Leading edge analysis reports <code>Tags</code> to indicate the percentage of genes contributing to the enrichment score, <code>List</code> to indicate where in the list the enrichment score is attained and <code>Signal</code> for enrichment signal strength.</p>

<p>It would also be very interesting to get the core enriched genes that contribute to the enrichment.</p>

<p>Now <a href="https://guangchuangyu.github.io/DOSE" target="_blank">DOSE</a>, <a href="https://guangchuangyu.github.io/clusterProfiler" target="_blank">clusterProfiler</a> and <a href="https://guangchuangyu.github.io/ReactomePA" target="_blank">ReactomePA</a> all support leading edge analysis and report core enriched genes.</p>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/05/bioc-33-news-of-my-bioc-packages/">[Bioc 33] NEWS of my BioC packages</a></h2>
    <div class="article-style">
      
      <p><img src="http://guangchuangyu.github.io/blog_images/MISC/ke.jpg" width=600></p>

<p>Today is my birthday and it happened to be the release day of Bioconductor 3.3. It&rsquo;s again the time to reflect what I&rsquo;ve done in the past year.</p>

<ul>
<li><a href="http://guangchuangyu.github.io/ChIPseeker" target="_blank">ChIPseeker</a></li>
<li><a href="http://guangchuangyu.github.io/clusterProfiler" target="_blank">clusterProfiler</a></li>
<li><a href="http://guangchuangyu.github.io/DOSE" target="_blank">DOSE</a></li>
<li><a href="http://guangchuangyu.github.io/ggtree" target="_blank">ggtree</a></li>
<li><a href="http://guangchuangyu.github.io/GOSemSim" target="_blank">GOSemSim</a></li>
<li><a href="http://guangchuangyu.github.io/ReactomePA" target="_blank">ReactomePA</a></li>
</ul>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/05/convert-biological-id-with-kegg-api-using-clusterprofiler/">convert biological ID with KEGG API using clusterProfiler</a></h2>
    <div class="article-style">
      
      <h2 id="bitr-kegg">bitr_kegg</h2>

<p><code>clusterProfiler</code> can convert biological IDs using <code>OrgDb</code> object via the <code>bitr</code> function. Now I implemented another function, <code>bitr_kegg</code> for converting IDs through KEGG API.</p>

<pre><code>library(clusterProfiler)
data(gcSample)
hg &lt;- gcSample[[1]]
head(hg)

## [1] &quot;4597&quot;  &quot;7111&quot;  &quot;5266&quot;  &quot;2175&quot;  &quot;755&quot;   &quot;23046&quot;

eg2np &lt;- bitr_kegg(hg, fromType='kegg', toType='ncbi-proteinid', organism='hsa')

## Warning in bitr_kegg(hg, fromType = &quot;kegg&quot;, toType = &quot;ncbi-proteinid&quot;,
## organism = &quot;hsa&quot;): 3.7% of input gene IDs are fail to map...

head(eg2np)

##     kegg ncbi-proteinid
## 1   8326      NP_003499
## 2  58487   NP_001034707
## 3 139081      NP_619647
## 4  59272      NP_068576
## 5    993      NP_001780
## 6   2676      NP_001487

np2up &lt;- bitr_kegg(eg2np[,2], fromType='ncbi-proteinid', toType='uniprot', organism='hsa')

head(np2up)

##   ncbi-proteinid uniprot
## 1      NP_005457  O75586
## 2      NP_005792  P41567
## 3      NP_005792  Q6IAV3
## 4      NP_037536  Q13421
## 5      NP_006054  O60662
## 6   NP_001092002  O95398
</code></pre>

<p>The ID type (both fromType &amp; toType) should be one of &lsquo;kegg&rsquo;, &lsquo;ncbi-geneid&rsquo;, &lsquo;ncbi-proteinid&rsquo; or &lsquo;uniprot&rsquo;. The &lsquo;kegg&rsquo; is the primary ID used in KEGG database. The data source of KEGG was from NCBI. A rule of thumb for the &lsquo;kegg&rsquo; ID is <code>entrezgene</code> ID for eukaryote species and <code>Locus</code> ID for prokaryotes.
</p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/04/kegg-module-enrichment-analysis/">KEGG Module Enrichment Analysis</a></h2>
    <div class="article-style">
      
      <blockquote>
<p>KEGG MODULE is a collection of manually defined functional units, called KEGG modules and identified by the M numbers, used for annotation and biological interpretation of sequenced genomes. There are four types of KEGG modules:</p>

<ul>
<li>pathway modules – representing tight functional units in KEGG metabolic pathway maps, such as M00002 (Glycolysis, core module involving three-carbon compounds)</li>
<li>structural complexes – often forming molecular machineries, such as M00072 (Oligosaccharyltransferase)</li>
<li>functional sets – for other types of essential sets, such as M00360 (Aminoacyl-tRNA synthases, prokaryotes)</li>
<li>signature modules – as markers of phenotypes, such as M00363 (EHEC pathogenicity signature, Shiga toxin)</li>
</ul>
</blockquote>

<p></p>

      
    </div>
  </div>
  
  <div>
    <h2><a href="https://guangchuangyu.github.io/2016/01/go-analysis-using-clusterprofiler/">GO analysis using clusterProfiler</a></h2>
    <div class="article-style">
      
      <p><code>clusterProfiler</code> supports over-representation test and gene set
enrichment analysis of Gene Ontology. It supports GO annotation from
OrgDb object, GMT file and user&rsquo;s own data.</p>

<h2 id="support-many-species">support many species</h2>

<p>In github version of clusterProfiler, <code>enrichGO</code> and <code>gseGO</code> functions
removed the parameter <em>organism</em> and add another parameter <em>OrgDb</em>, so
that any species that have <code>OrgDb</code> object available can be analyzed in
<strong>clusterProfiler</strong>. Bioconductor have already provide OrgDb for about
20 species, see
<a href="http://bioconductor.org/packages/release/BiocViews.html#___OrgDb" target="_blank">http://bioconductor.org/packages/release/BiocViews.html#___OrgDb</a>, and
users can build <code>OrgDb</code> via <code>AnnotationHub</code>.
</p>

      
    </div>
  </div>
  

  
<nav>
  <ul class="pager">
    
    
    <li><a href="/tags/clusterprofiler/page/2/">Next &raquo;</a></li>
    
  </ul>
</nav>



</div>
<footer class="site-footer">
  <div style="width:350px;margin:auto;">
<script type="text/javascript" src="//rf.revolvermaps.com/0/0/7.js?i=5qpvv5zz7fp&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;sx=0" async="async"></script>
</div>
  <div class="container">
    <p class="powered-by">

      &copy; 2016 Guangchuang YU &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-77901140-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

